{"ast":null,"code":"import _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport _objectWithoutProperties from '@babel/runtime/helpers/objectWithoutProperties';\nimport _toConsumableArray from '@babel/runtime/helpers/toConsumableArray';\nimport _slicedToArray from '@babel/runtime/helpers/slicedToArray';\nimport { newInstance as newInstance$1, obj, setGet, get, moveToProtected, event, proxy, proxyPropertyMapping, chain } from '../../macros.js';\nimport vtkAnnotatedCubeActor from '../../Rendering/Core/AnnotatedCubeActor.js';\nimport vtkAxesActor from '../../Rendering/Core/AxesActor.js';\nimport vtkCornerAnnotation from '../../Interaction/UI/CornerAnnotation.js';\nimport vtkInteractorStyleManipulator from '../../Interaction/Style/InteractorStyleManipulator.js';\nimport vtkMatrixBuilder from '../../Common/Core/MatrixBuilder.js';\nimport '../../Rendering/OpenGL/RenderWindow.js';\nimport '../../Rendering/WebGPU/RenderWindow.js';\nimport vtkOrientationMarkerWidget from '../../Interaction/Widgets/OrientationMarkerWidget.js';\nimport vtkRenderer from '../../Rendering/Core/Renderer.js';\nimport vtkRenderWindow from '../../Rendering/Core/RenderWindow.js';\nimport vtkRenderWindowInteractor from '../../Rendering/Core/RenderWindowInteractor.js';\nimport InteractionPresets from '../../Interaction/Style/InteractorStyleManipulator/Presets.js';\nimport AnnotatedCubePresets from '../../Rendering/Core/AnnotatedCubeActor/Presets.js';\nvar _excluded = [\"format\"];\nvar EPSILON = 0.000001; // ----------------------------------------------------------------------------\n// vtkViewProxy methods\n// ----------------------------------------------------------------------------\n\nfunction vtkViewProxy(publicAPI, model) {\n  // Set our className\n  model.classHierarchy.push('vtkViewProxy'); // Private --------------------------------------------------------------------\n\n  function updateAnnotationColor() {\n    var _model$renderer$getBa = model.renderer.getBackground(),\n      _model$renderer$getBa2 = _slicedToArray(_model$renderer$getBa, 3),\n      r = _model$renderer$getBa2[0],\n      g = _model$renderer$getBa2[1],\n      b = _model$renderer$getBa2[2];\n    model.cornerAnnotation.getAnnotationContainer().style.color = r + g + b > 1.5 ? 'black' : 'white';\n  } // Setup --------------------------------------------------------------------\n\n  model.renderWindow = vtkRenderWindow.newInstance();\n  model.renderer = vtkRenderer.newInstance({\n    background: [0, 0, 0]\n  });\n  model.renderWindow.addRenderer(model.renderer);\n  model._openGLRenderWindow = model.renderWindow.newAPISpecificView();\n  model.renderWindow.addView(model._openGLRenderWindow);\n  model.interactor = vtkRenderWindowInteractor.newInstance();\n  model.interactor.setView(model._openGLRenderWindow);\n  model.interactorStyle3D = vtkInteractorStyleManipulator.newInstance();\n  model.interactorStyle2D = vtkInteractorStyleManipulator.newInstance();\n  /**\n   * Internal function used by publicAPI.resetCamera()\n   */\n\n  model._resetCamera = function () {\n    var bounds = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    return model.renderer.resetCamera(bounds);\n  }; // Apply default interaction styles\n\n  InteractionPresets.applyPreset('3D', model.interactorStyle3D);\n  InteractionPresets.applyPreset('2D', model.interactorStyle2D);\n  model.cornerAnnotation = vtkCornerAnnotation.newInstance(); // Setup interaction\n\n  model.interactor.setInteractorStyle(model.useParallelRendering ? model.interactorStyle2D : model.interactorStyle3D);\n  model.camera = model.renderer.getActiveCamera();\n  model.camera.setParallelProjection(!!model.useParallelRendering); // Orientation axis setup -------------------------------------------------\n\n  model.orientationAxesArrow = vtkAxesActor.newInstance();\n  model.orientationAxesCube = vtkAnnotatedCubeActor.newInstance();\n  AnnotatedCubePresets.applyPreset('default', model.orientationAxesCube);\n  AnnotatedCubePresets.applyPreset('lps', model.orientationAxesCube);\n  model.orientationAxesMap = {\n    arrow: model.orientationAxesArrow,\n    cube: model.orientationAxesCube\n  };\n  model.orientationWidget = vtkOrientationMarkerWidget.newInstance({\n    actor: model.orientationAxesArrow,\n    interactor: model.renderWindow.getInteractor()\n  });\n  model.orientationWidget.setEnabled(true);\n  model.orientationWidget.setViewportCorner(vtkOrientationMarkerWidget.Corners.BOTTOM_LEFT);\n  model.orientationWidget.setViewportSize(0.1); // API ----------------------------------------------------------------------\n\n  publicAPI.setPresetToInteractor3D = function (nameOrDefinitions) {\n    if (Array.isArray(nameOrDefinitions)) {\n      return InteractionPresets.applyDefinitions(nameOrDefinitions, model.interactorStyle3D);\n    }\n    return InteractionPresets.applyPreset(nameOrDefinitions, model.interactorStyle3D);\n  }; // --------------------------------------------------------------------------\n\n  publicAPI.setPresetToInteractor2D = function (nameOrDefinitions) {\n    if (Array.isArray(nameOrDefinitions)) {\n      return InteractionPresets.applyDefinitions(nameOrDefinitions, model.interactorStyle2D);\n    }\n    return InteractionPresets.applyPreset(nameOrDefinitions, model.interactorStyle2D);\n  }; // --------------------------------------------------------------------------\n\n  publicAPI.setOrientationAxesType = function (type) {\n    var actor = model.orientationAxesMap[type];\n    if (actor) {\n      model.orientationAxesType = type;\n      model.orientationWidget.setActor(actor);\n      publicAPI.renderLater();\n    }\n  }; // --------------------------------------------------------------------------\n\n  publicAPI.registerOrientationAxis = function (name, actor) {\n    model.orientationAxesMap[name] = actor;\n  }; // --------------------------------------------------------------------------\n\n  publicAPI.unregisterOrientationAxis = function (name) {\n    delete model.orientationAxesMap[name];\n  }; // --------------------------------------------------------------------------\n\n  publicAPI.listOrientationAxis = function () {\n    return Object.keys(model.orientationAxesMap);\n  }; // --------------------------------------------------------------------------\n\n  publicAPI.setPresetToOrientationAxes = function (nameOrDefinitions) {\n    var changeDetected = false;\n    if (typeof nameOrDefinitions === 'string') {\n      if (model.presetToOrientationAxes !== nameOrDefinitions) {\n        model.presetToOrientationAxes = nameOrDefinitions;\n        changeDetected = AnnotatedCubePresets.applyPreset(nameOrDefinitions, model.orientationAxesCube);\n        publicAPI.modified();\n      }\n      return changeDetected;\n    }\n    model.presetToOrientationAxes = 'Custom';\n    changeDetected = AnnotatedCubePresets.applyDefinitions(nameOrDefinitions, model.orientationAxesCube);\n    publicAPI.modified();\n    return changeDetected;\n  }; // --------------------------------------------------------------------------\n\n  publicAPI.setContainer = function (container) {\n    var orientationWidgetEnabled = model.orientationWidget.getEnabled();\n    if (model.container) {\n      model.orientationWidget.setEnabled(false);\n      model.interactor.unbindEvents(model.container);\n      model._openGLRenderWindow.setContainer(null);\n      model.cornerAnnotation.setContainer(null);\n    }\n    model.container = container;\n    if (container) {\n      model._openGLRenderWindow.setContainer(container);\n      model.cornerAnnotation.setContainer(container);\n      model.interactor.initialize();\n      model.interactor.bindEvents(container);\n      model.orientationWidget.setEnabled(orientationWidgetEnabled);\n    }\n  }; // --------------------------------------------------------------------------\n\n  publicAPI.resize = function () {\n    if (model.container) {\n      var dims = model.container.getBoundingClientRect();\n      if (dims.width === dims.height && dims.width === 0) {\n        return;\n      }\n      var devicePixelRatio = window.devicePixelRatio || 1;\n      var width = Math.max(10, Math.floor(devicePixelRatio * dims.width));\n      var height = Math.max(10, Math.floor(devicePixelRatio * dims.height));\n      model._openGLRenderWindow.setSize(width, height);\n      publicAPI.invokeResize({\n        width: width,\n        height: height\n      });\n      publicAPI.renderLater();\n    }\n  }; // --------------------------------------------------------------------------\n\n  publicAPI.renderLater = function () {\n    publicAPI.render(false);\n  }; // --------------------------------------------------------------------------\n\n  publicAPI.render = function () {\n    var blocking = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n    if (model.representations.length > 0 && model.resetCameraOnFirstRender) {\n      model.resetCameraOnFirstRender = false;\n      publicAPI.resetCamera();\n    }\n    model.orientationWidget.updateMarkerOrientation();\n    model.renderer.resetCameraClippingRange();\n    if (blocking) {\n      model.renderWindow.render();\n    } else {\n      setTimeout(model.renderWindow.render, 0);\n    }\n  }; // --------------------------------------------------------------------------\n\n  publicAPI.addRepresentation = function (representation) {\n    if (!representation) {\n      return;\n    }\n    if (model.representations.indexOf(representation) === -1) {\n      model.representations.push(representation);\n      model.renderer.addViewProp(representation);\n    }\n  }; // --------------------------------------------------------------------------\n\n  publicAPI.removeRepresentation = function (representation) {\n    if (!representation) {\n      return;\n    }\n    if (model.representations.indexOf(representation) !== -1) {\n      model.representations = model.representations.filter(function (r) {\n        return r !== representation;\n      });\n      model.renderer.removeViewProp(representation);\n    }\n    if (model.representations.length === 0) {\n      model.resetCameraOnFirstRender = true;\n    }\n  }; // --------------------------------------------------------------------------\n\n  publicAPI.setCameraParameters = function (_ref) {\n    var position = _ref.position,\n      focalPoint = _ref.focalPoint,\n      bounds = _ref.bounds,\n      parallelScale = _ref.parallelScale,\n      viewAngle = _ref.viewAngle;\n    if (position != null) {\n      var _model$camera;\n      (_model$camera = model.camera).setPosition.apply(_model$camera, _toConsumableArray(position));\n    }\n    if (focalPoint != null) {\n      var _model$camera2;\n      (_model$camera2 = model.camera).setFocalPoint.apply(_model$camera2, _toConsumableArray(focalPoint));\n    }\n    if (bounds != null) {\n      model.renderer.resetCameraClippingRange(bounds);\n    } else {\n      model.renderer.resetCameraClippingRange();\n    }\n    if (parallelScale != null) {\n      model.camera.setParallelScale(parallelScale);\n    }\n    if (viewAngle != null) {\n      model.camera.setViewAngle(viewAngle);\n    }\n  }; // --------------------------------------------------------------------------\n\n  publicAPI.resetCamera = function () {\n    model._resetCamera();\n    model.interactorStyle2D.setCenterOfRotation(model.camera.getFocalPoint());\n    model.interactorStyle3D.setCenterOfRotation(model.camera.getFocalPoint());\n    publicAPI.renderLater();\n  }; // --------------------------------------------------------------------------\n\n  publicAPI.captureImage = function () {\n    var _ref2 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      _ref2$format = _ref2.format,\n      format = _ref2$format === void 0 ? 'image/png' : _ref2$format,\n      opts = _objectWithoutProperties(_ref2, _excluded);\n    return model.renderWindow.captureImages(format, opts)[0];\n  }; // --------------------------------------------------------------------------\n\n  publicAPI.openCaptureImage = function () {\n    var target = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '_blank';\n    var image = new Image();\n    return publicAPI.captureImage().then(function (imageURL) {\n      image.src = imageURL;\n      var w = window.open('', target);\n      w.document.write(image.outerHTML);\n      w.document.title = 'vtk.js Image Capture';\n      window.focus();\n    });\n  }; // --------------------------------------------------------------------------\n\n  publicAPI.setCornerAnnotation = function (corner, templateString) {\n    model.cornerAnnotation.updateTemplates(_defineProperty({}, corner, function (meta) {\n      return vtkCornerAnnotation.applyTemplate(templateString, meta);\n    }));\n  }; // --------------------------------------------------------------------------\n\n  publicAPI.setCornerAnnotations = function (annotations) {\n    var useTemplateString = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    if (useTemplateString) {\n      Object.keys(annotations).forEach(function (key) {\n        publicAPI.setCornerAnnotation(key, annotations[key]);\n      });\n    } else {\n      model.cornerAnnotation.updateTemplates(annotations);\n    }\n  }; // --------------------------------------------------------------------------\n\n  publicAPI.updateCornerAnnotation = function (meta) {\n    return model.cornerAnnotation.updateMetadata(meta);\n  }; // --------------------------------------------------------------------------\n\n  publicAPI.setAnnotationOpacity = function (opacity) {\n    if (model.annotationOpacity !== Number(opacity)) {\n      model.annotationOpacity = Number(opacity);\n      model.cornerAnnotation.getAnnotationContainer().style.opacity = opacity;\n      publicAPI.modified();\n    }\n  }; // --------------------------------------------------------------------------\n\n  publicAPI.setBackground = chain(model.renderer.setBackground, updateAnnotationColor); // --------------------------------------------------------------------------\n\n  publicAPI.getBackground = model.renderer.getBackground; // --------------------------------------------------------------------------\n\n  publicAPI.setAnimation = function (enable) {\n    var requester = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : publicAPI;\n    if (model.disableAnimation && enable) {\n      return;\n    }\n    if (enable) {\n      model.renderWindow.getInteractor().requestAnimation(requester);\n    } else {\n      var skipWarning = requester === publicAPI || \"\".concat(requester).indexOf('ViewProxy.moveCamera.') === 0;\n      model.renderWindow.getInteractor().cancelAnimation(requester, skipWarning);\n    }\n  }; // --------------------------------------------------------------------------\n\n  publicAPI.updateOrientation = function (axisIndex, orientation, viewUp) {\n    var _model$camera3, _model$camera4, _model$camera5, _model$camera6, _model$camera7;\n    var animateSteps = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n    if (axisIndex === undefined) {\n      return Promise.resolve();\n    }\n    var originalPosition = model.camera.getPosition();\n    var originalViewUp = model.camera.getViewUp();\n    var originalFocalPoint = model.camera.getFocalPoint();\n    model.axis = axisIndex;\n    model.orientation = orientation;\n    model.viewUp = viewUp;\n    var position = model.camera.getFocalPoint();\n    position[model.axis] += model.orientation;\n    (_model$camera3 = model.camera).setPosition.apply(_model$camera3, _toConsumableArray(position));\n    (_model$camera4 = model.camera).setViewUp.apply(_model$camera4, _toConsumableArray(viewUp));\n    model.renderer.resetCamera();\n    var destFocalPoint = model.camera.getFocalPoint();\n    var destPosition = model.camera.getPosition();\n    var destViewUp = model.camera.getViewUp(); // Reset to original to prevent initial render flash\n\n    (_model$camera5 = model.camera).setFocalPoint.apply(_model$camera5, _toConsumableArray(originalFocalPoint));\n    (_model$camera6 = model.camera).setPosition.apply(_model$camera6, _toConsumableArray(originalPosition));\n    (_model$camera7 = model.camera).setViewUp.apply(_model$camera7, _toConsumableArray(originalViewUp));\n    return publicAPI.moveCamera(destFocalPoint, destPosition, destViewUp, animateSteps);\n  }; // --------------------------------------------------------------------------\n\n  publicAPI.moveCamera = function (focalPoint, position, viewUp) {\n    var animateSteps = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n    var originalFocalPoint = model.camera.getFocalPoint();\n    var originalPosition = model.camera.getPosition();\n    var originalViewUp = model.camera.getViewUp();\n    var animationStack = [{\n      focalPoint: focalPoint,\n      position: position,\n      viewUp: viewUp\n    }];\n    if (animateSteps) {\n      var deltaFocalPoint = [(originalFocalPoint[0] - focalPoint[0]) / animateSteps, (originalFocalPoint[1] - focalPoint[1]) / animateSteps, (originalFocalPoint[2] - focalPoint[2]) / animateSteps];\n      var deltaPosition = [(originalPosition[0] - position[0]) / animateSteps, (originalPosition[1] - position[1]) / animateSteps, (originalPosition[2] - position[2]) / animateSteps];\n      var deltaViewUp = [(originalViewUp[0] - viewUp[0]) / animateSteps, (originalViewUp[1] - viewUp[1]) / animateSteps, (originalViewUp[2] - viewUp[2]) / animateSteps];\n      var needSteps = deltaFocalPoint[0] || deltaFocalPoint[1] || deltaFocalPoint[2] || deltaPosition[0] || deltaPosition[1] || deltaPosition[2] || deltaViewUp[0] || deltaViewUp[1] || deltaViewUp[2];\n      var focalPointDeltaAxisCount = deltaFocalPoint.map(function (i) {\n        return Math.abs(i) < EPSILON ? 0 : 1;\n      }).reduce(function (a, b) {\n        return a + b;\n      }, 0);\n      var positionDeltaAxisCount = deltaPosition.map(function (i) {\n        return Math.abs(i) < EPSILON ? 0 : 1;\n      }).reduce(function (a, b) {\n        return a + b;\n      }, 0);\n      var viewUpDeltaAxisCount = deltaViewUp.map(function (i) {\n        return Math.abs(i) < EPSILON ? 0 : 1;\n      }).reduce(function (a, b) {\n        return a + b;\n      }, 0);\n      var rotation180Only = viewUpDeltaAxisCount === 1 && positionDeltaAxisCount === 0 && focalPointDeltaAxisCount === 0;\n      if (needSteps) {\n        if (rotation180Only) {\n          var availableAxes = originalFocalPoint.map(function (fp, i) {\n            return Math.abs(originalPosition[i] - fp) < EPSILON ? i : null;\n          }).filter(function (i) {\n            return i !== null;\n          });\n          var axisCorrectionIndex = availableAxes.find(function (v) {\n            return Math.abs(deltaViewUp[v]) < EPSILON;\n          });\n          for (var i = 0; i < animateSteps; i++) {\n            var newViewUp = [viewUp[0] + (i + 1) * deltaViewUp[0], viewUp[1] + (i + 1) * deltaViewUp[1], viewUp[2] + (i + 1) * deltaViewUp[2]];\n            newViewUp[axisCorrectionIndex] = Math.sin(Math.PI * i / (animateSteps - 1));\n            animationStack.push({\n              focalPoint: focalPoint,\n              position: position,\n              viewUp: newViewUp\n            });\n          }\n        } else {\n          for (var _i = 0; _i < animateSteps; _i++) {\n            animationStack.push({\n              focalPoint: [focalPoint[0] + (_i + 1) * deltaFocalPoint[0], focalPoint[1] + (_i + 1) * deltaFocalPoint[1], focalPoint[2] + (_i + 1) * deltaFocalPoint[2]],\n              position: [position[0] + (_i + 1) * deltaPosition[0], position[1] + (_i + 1) * deltaPosition[1], position[2] + (_i + 1) * deltaPosition[2]],\n              viewUp: [viewUp[0] + (_i + 1) * deltaViewUp[0], viewUp[1] + (_i + 1) * deltaViewUp[1], viewUp[2] + (_i + 1) * deltaViewUp[2]]\n            });\n          }\n        }\n      }\n    }\n    if (animationStack.length === 1) {\n      // update camera directly\n      model.camera.set(animationStack.pop());\n      model.renderer.resetCameraClippingRange();\n      if (model.interactor.getLightFollowCamera()) {\n        model.renderer.updateLightsGeometryToFollowCamera();\n      }\n      return Promise.resolve();\n    }\n    return new Promise(function (resolve, reject) {\n      var now = performance.now().toString();\n      var animationRequester = \"ViewProxy.moveCamera.\".concat(now);\n      publicAPI.setAnimation(true, animationRequester);\n      var intervalId = null;\n      var consumeAnimationStack = function consumeAnimationStack() {\n        if (animationStack.length) {\n          var _model$camera8, _model$camera9, _model$camera10;\n          var _animationStack$pop = animationStack.pop(),\n            cameraFocalPoint = _animationStack$pop.focalPoint,\n            cameraPosition = _animationStack$pop.position,\n            cameraViewUp = _animationStack$pop.viewUp;\n          (_model$camera8 = model.camera).setFocalPoint.apply(_model$camera8, _toConsumableArray(cameraFocalPoint));\n          (_model$camera9 = model.camera).setPosition.apply(_model$camera9, _toConsumableArray(cameraPosition));\n          (_model$camera10 = model.camera).setViewUp.apply(_model$camera10, _toConsumableArray(cameraViewUp));\n          model.renderer.resetCameraClippingRange();\n          if (model.interactor.getLightFollowCamera()) {\n            model.renderer.updateLightsGeometryToFollowCamera();\n          }\n        } else {\n          clearInterval(intervalId);\n          publicAPI.setAnimation(false, animationRequester);\n          resolve();\n        }\n      };\n      intervalId = setInterval(consumeAnimationStack, 1);\n    });\n  }; // --------------------------------------------------------------------------\n\n  publicAPI.resetOrientation = function () {\n    var animateSteps = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    return publicAPI.updateOrientation(model.axis, model.orientation, model.viewUp, animateSteps);\n  }; // --------------------------------------------------------------------------\n\n  publicAPI.rotate = function (angle) {\n    var _model$camera11;\n    var _model$camera$get = model.camera.get('viewUp', 'focalPoint', 'position'),\n      viewUp = _model$camera$get.viewUp,\n      focalPoint = _model$camera$get.focalPoint,\n      position = _model$camera$get.position;\n    var axis = [focalPoint[0] - position[0], focalPoint[1] - position[1], focalPoint[2] - position[2]];\n    vtkMatrixBuilder.buildFromDegree().rotate(Number.isNaN(angle) ? 90 : angle, axis).apply(viewUp);\n    (_model$camera11 = model.camera).setViewUp.apply(_model$camera11, _toConsumableArray(viewUp));\n    model.camera.modified();\n    model.orientationWidget.updateMarkerOrientation();\n    model.renderWindow.render();\n  }; // --------------------------------------------------------------------------\n\n  publicAPI.focusTo = chain(model.camera.setFocalPoint, model.interactorStyle2D.setCenterOfRotation, model.interactorStyle3D.setCenterOfRotation); // --------------------------------------------------------------------------\n\n  publicAPI.delete = chain(function () {\n    publicAPI.setContainer(null);\n    model.orientationWidget.setEnabled(false);\n    model.orientationWidget.delete();\n    model.orientationAxesArrow.delete();\n    model.orientationAxesCube.delete();\n    model.interactorStyle2D.delete();\n    model.interactorStyle3D.delete();\n    model.cornerAnnotation.delete(); // in reverse order\n\n    model.interactor.delete();\n    model.renderer.delete();\n    model._openGLRenderWindow.delete();\n    model.renderWindow.delete();\n  }, publicAPI.delete); // --------------------------------------------------------------------------\n  // Initialization from state or input\n  // --------------------------------------------------------------------------\n\n  publicAPI.resetOrientation();\n  updateAnnotationColor();\n} // ----------------------------------------------------------------------------\n// Object factory\n// ----------------------------------------------------------------------------\n\nvar DEFAULT_VALUES = {\n  representations: [],\n  sectionName: 'view',\n  annotationOpacity: 1,\n  resetCameraOnFirstRender: true,\n  presetToOrientationAxes: 'lps',\n  orientationAxesType: 'arrow',\n  disableAnimation: false,\n  axis: 1,\n  orientation: 0,\n  viewUp: [0, 0, 1]\n}; // ----------------------------------------------------------------------------\n\nfunction extend(publicAPI, model) {\n  var initialValues = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  Object.assign(model, DEFAULT_VALUES, initialValues);\n  obj(publicAPI, model);\n  setGet(publicAPI, model, ['name', 'disableAnimation']);\n  get(publicAPI, model, ['annotationOpacity', 'camera', 'container', 'cornerAnnotation', 'interactor', 'interactorStyle2D', 'interactorStyle3D', '_openGLRenderWindow',\n  // todo breaking? convert to apiSpecificWindow\n  'orientationAxesType', 'presetToOrientationAxes', 'renderer', 'renderWindow', 'representations', 'useParallelRendering']);\n  moveToProtected(publicAPI, model, ['openGLRenderWindow']);\n  event(publicAPI, model, 'Resize'); // Object specific methods\n\n  vtkViewProxy(publicAPI, model); // Proxy handling\n\n  proxy(publicAPI, model);\n  proxyPropertyMapping(publicAPI, model, {\n    orientationAxesVisibility: {\n      modelKey: 'orientationWidget',\n      property: 'enabled'\n    },\n    orientationAxesCorner: {\n      modelKey: 'orientationWidget',\n      property: 'viewportCorner'\n    },\n    orientationAxesSize: {\n      modelKey: 'orientationWidget',\n      property: 'viewportSize'\n    },\n    cameraViewUp: {\n      modelKey: 'camera',\n      property: 'viewUp',\n      modified: false\n    },\n    cameraPosition: {\n      modelKey: 'camera',\n      property: 'position',\n      modified: false\n    },\n    cameraFocalPoint: {\n      modelKey: 'camera',\n      property: 'focalPoint',\n      modified: false\n    }\n  });\n} // ----------------------------------------------------------------------------\n\nvar newInstance = newInstance$1(extend, 'vtkViewProxy'); // ----------------------------------------------------------------------------\n\nvar vtkViewProxy$1 = {\n  newInstance: newInstance,\n  extend: extend\n};\nexport { vtkViewProxy$1 as default, newInstance };","map":{"version":3,"names":["_defineProperty","_objectWithoutProperties","_toConsumableArray","_slicedToArray","newInstance","newInstance$1","obj","setGet","get","moveToProtected","event","proxy","proxyPropertyMapping","chain","vtkAnnotatedCubeActor","vtkAxesActor","vtkCornerAnnotation","vtkInteractorStyleManipulator","vtkMatrixBuilder","vtkOrientationMarkerWidget","vtkRenderer","vtkRenderWindow","vtkRenderWindowInteractor","InteractionPresets","AnnotatedCubePresets","_excluded","EPSILON","vtkViewProxy","publicAPI","model","classHierarchy","push","updateAnnotationColor","_model$renderer$getBa","renderer","getBackground","_model$renderer$getBa2","r","g","b","cornerAnnotation","getAnnotationContainer","style","color","renderWindow","background","addRenderer","_openGLRenderWindow","newAPISpecificView","addView","interactor","setView","interactorStyle3D","interactorStyle2D","_resetCamera","bounds","arguments","length","undefined","resetCamera","applyPreset","setInteractorStyle","useParallelRendering","camera","getActiveCamera","setParallelProjection","orientationAxesArrow","orientationAxesCube","orientationAxesMap","arrow","cube","orientationWidget","actor","getInteractor","setEnabled","setViewportCorner","Corners","BOTTOM_LEFT","setViewportSize","setPresetToInteractor3D","nameOrDefinitions","Array","isArray","applyDefinitions","setPresetToInteractor2D","setOrientationAxesType","type","orientationAxesType","setActor","renderLater","registerOrientationAxis","name","unregisterOrientationAxis","listOrientationAxis","Object","keys","setPresetToOrientationAxes","changeDetected","presetToOrientationAxes","modified","setContainer","container","orientationWidgetEnabled","getEnabled","unbindEvents","initialize","bindEvents","resize","dims","getBoundingClientRect","width","height","devicePixelRatio","window","Math","max","floor","setSize","invokeResize","render","blocking","representations","resetCameraOnFirstRender","updateMarkerOrientation","resetCameraClippingRange","setTimeout","addRepresentation","representation","indexOf","addViewProp","removeRepresentation","filter","removeViewProp","setCameraParameters","_ref","position","focalPoint","parallelScale","viewAngle","_model$camera","setPosition","apply","_model$camera2","setFocalPoint","setParallelScale","setViewAngle","setCenterOfRotation","getFocalPoint","captureImage","_ref2","_ref2$format","format","opts","captureImages","openCaptureImage","target","image","Image","then","imageURL","src","w","open","document","write","outerHTML","title","focus","setCornerAnnotation","corner","templateString","updateTemplates","meta","applyTemplate","setCornerAnnotations","annotations","useTemplateString","forEach","key","updateCornerAnnotation","updateMetadata","setAnnotationOpacity","opacity","annotationOpacity","Number","setBackground","setAnimation","enable","requester","disableAnimation","requestAnimation","skipWarning","concat","cancelAnimation","updateOrientation","axisIndex","orientation","viewUp","_model$camera3","_model$camera4","_model$camera5","_model$camera6","_model$camera7","animateSteps","Promise","resolve","originalPosition","getPosition","originalViewUp","getViewUp","originalFocalPoint","axis","setViewUp","destFocalPoint","destPosition","destViewUp","moveCamera","animationStack","deltaFocalPoint","deltaPosition","deltaViewUp","needSteps","focalPointDeltaAxisCount","map","i","abs","reduce","a","positionDeltaAxisCount","viewUpDeltaAxisCount","rotation180Only","availableAxes","fp","axisCorrectionIndex","find","v","newViewUp","sin","PI","_i","set","pop","getLightFollowCamera","updateLightsGeometryToFollowCamera","reject","now","performance","toString","animationRequester","intervalId","consumeAnimationStack","_model$camera8","_model$camera9","_model$camera10","_animationStack$pop","cameraFocalPoint","cameraPosition","cameraViewUp","clearInterval","setInterval","resetOrientation","rotate","angle","_model$camera11","_model$camera$get","buildFromDegree","isNaN","focusTo","delete","DEFAULT_VALUES","sectionName","extend","initialValues","assign","orientationAxesVisibility","modelKey","property","orientationAxesCorner","orientationAxesSize","vtkViewProxy$1","default"],"sources":["/home/rakshith/Documents/RemoteRendering/vtk-js-react-app/node_modules/@kitware/vtk.js/Proxy/Core/ViewProxy.js"],"sourcesContent":["import _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport _objectWithoutProperties from '@babel/runtime/helpers/objectWithoutProperties';\nimport _toConsumableArray from '@babel/runtime/helpers/toConsumableArray';\nimport _slicedToArray from '@babel/runtime/helpers/slicedToArray';\nimport { newInstance as newInstance$1, obj, setGet, get, moveToProtected, event, proxy, proxyPropertyMapping, chain } from '../../macros.js';\nimport vtkAnnotatedCubeActor from '../../Rendering/Core/AnnotatedCubeActor.js';\nimport vtkAxesActor from '../../Rendering/Core/AxesActor.js';\nimport vtkCornerAnnotation from '../../Interaction/UI/CornerAnnotation.js';\nimport vtkInteractorStyleManipulator from '../../Interaction/Style/InteractorStyleManipulator.js';\nimport vtkMatrixBuilder from '../../Common/Core/MatrixBuilder.js';\nimport '../../Rendering/OpenGL/RenderWindow.js';\nimport '../../Rendering/WebGPU/RenderWindow.js';\nimport vtkOrientationMarkerWidget from '../../Interaction/Widgets/OrientationMarkerWidget.js';\nimport vtkRenderer from '../../Rendering/Core/Renderer.js';\nimport vtkRenderWindow from '../../Rendering/Core/RenderWindow.js';\nimport vtkRenderWindowInteractor from '../../Rendering/Core/RenderWindowInteractor.js';\nimport InteractionPresets from '../../Interaction/Style/InteractorStyleManipulator/Presets.js';\nimport AnnotatedCubePresets from '../../Rendering/Core/AnnotatedCubeActor/Presets.js';\n\nvar _excluded = [\"format\"];\nvar EPSILON = 0.000001; // ----------------------------------------------------------------------------\n// vtkViewProxy methods\n// ----------------------------------------------------------------------------\n\nfunction vtkViewProxy(publicAPI, model) {\n  // Set our className\n  model.classHierarchy.push('vtkViewProxy'); // Private --------------------------------------------------------------------\n\n  function updateAnnotationColor() {\n    var _model$renderer$getBa = model.renderer.getBackground(),\n        _model$renderer$getBa2 = _slicedToArray(_model$renderer$getBa, 3),\n        r = _model$renderer$getBa2[0],\n        g = _model$renderer$getBa2[1],\n        b = _model$renderer$getBa2[2];\n\n    model.cornerAnnotation.getAnnotationContainer().style.color = r + g + b > 1.5 ? 'black' : 'white';\n  } // Setup --------------------------------------------------------------------\n\n\n  model.renderWindow = vtkRenderWindow.newInstance();\n  model.renderer = vtkRenderer.newInstance({\n    background: [0, 0, 0]\n  });\n  model.renderWindow.addRenderer(model.renderer);\n  model._openGLRenderWindow = model.renderWindow.newAPISpecificView();\n  model.renderWindow.addView(model._openGLRenderWindow);\n  model.interactor = vtkRenderWindowInteractor.newInstance();\n  model.interactor.setView(model._openGLRenderWindow);\n  model.interactorStyle3D = vtkInteractorStyleManipulator.newInstance();\n  model.interactorStyle2D = vtkInteractorStyleManipulator.newInstance();\n  /**\n   * Internal function used by publicAPI.resetCamera()\n   */\n\n  model._resetCamera = function () {\n    var bounds = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    return model.renderer.resetCamera(bounds);\n  }; // Apply default interaction styles\n\n\n  InteractionPresets.applyPreset('3D', model.interactorStyle3D);\n  InteractionPresets.applyPreset('2D', model.interactorStyle2D);\n  model.cornerAnnotation = vtkCornerAnnotation.newInstance(); // Setup interaction\n\n  model.interactor.setInteractorStyle(model.useParallelRendering ? model.interactorStyle2D : model.interactorStyle3D);\n  model.camera = model.renderer.getActiveCamera();\n  model.camera.setParallelProjection(!!model.useParallelRendering); // Orientation axis setup -------------------------------------------------\n\n  model.orientationAxesArrow = vtkAxesActor.newInstance();\n  model.orientationAxesCube = vtkAnnotatedCubeActor.newInstance();\n  AnnotatedCubePresets.applyPreset('default', model.orientationAxesCube);\n  AnnotatedCubePresets.applyPreset('lps', model.orientationAxesCube);\n  model.orientationAxesMap = {\n    arrow: model.orientationAxesArrow,\n    cube: model.orientationAxesCube\n  };\n  model.orientationWidget = vtkOrientationMarkerWidget.newInstance({\n    actor: model.orientationAxesArrow,\n    interactor: model.renderWindow.getInteractor()\n  });\n  model.orientationWidget.setEnabled(true);\n  model.orientationWidget.setViewportCorner(vtkOrientationMarkerWidget.Corners.BOTTOM_LEFT);\n  model.orientationWidget.setViewportSize(0.1); // API ----------------------------------------------------------------------\n\n  publicAPI.setPresetToInteractor3D = function (nameOrDefinitions) {\n    if (Array.isArray(nameOrDefinitions)) {\n      return InteractionPresets.applyDefinitions(nameOrDefinitions, model.interactorStyle3D);\n    }\n\n    return InteractionPresets.applyPreset(nameOrDefinitions, model.interactorStyle3D);\n  }; // --------------------------------------------------------------------------\n\n\n  publicAPI.setPresetToInteractor2D = function (nameOrDefinitions) {\n    if (Array.isArray(nameOrDefinitions)) {\n      return InteractionPresets.applyDefinitions(nameOrDefinitions, model.interactorStyle2D);\n    }\n\n    return InteractionPresets.applyPreset(nameOrDefinitions, model.interactorStyle2D);\n  }; // --------------------------------------------------------------------------\n\n\n  publicAPI.setOrientationAxesType = function (type) {\n    var actor = model.orientationAxesMap[type];\n\n    if (actor) {\n      model.orientationAxesType = type;\n      model.orientationWidget.setActor(actor);\n      publicAPI.renderLater();\n    }\n  }; // --------------------------------------------------------------------------\n\n\n  publicAPI.registerOrientationAxis = function (name, actor) {\n    model.orientationAxesMap[name] = actor;\n  }; // --------------------------------------------------------------------------\n\n\n  publicAPI.unregisterOrientationAxis = function (name) {\n    delete model.orientationAxesMap[name];\n  }; // --------------------------------------------------------------------------\n\n\n  publicAPI.listOrientationAxis = function () {\n    return Object.keys(model.orientationAxesMap);\n  }; // --------------------------------------------------------------------------\n\n\n  publicAPI.setPresetToOrientationAxes = function (nameOrDefinitions) {\n    var changeDetected = false;\n\n    if (typeof nameOrDefinitions === 'string') {\n      if (model.presetToOrientationAxes !== nameOrDefinitions) {\n        model.presetToOrientationAxes = nameOrDefinitions;\n        changeDetected = AnnotatedCubePresets.applyPreset(nameOrDefinitions, model.orientationAxesCube);\n        publicAPI.modified();\n      }\n\n      return changeDetected;\n    }\n\n    model.presetToOrientationAxes = 'Custom';\n    changeDetected = AnnotatedCubePresets.applyDefinitions(nameOrDefinitions, model.orientationAxesCube);\n    publicAPI.modified();\n    return changeDetected;\n  }; // --------------------------------------------------------------------------\n\n\n  publicAPI.setContainer = function (container) {\n    var orientationWidgetEnabled = model.orientationWidget.getEnabled();\n\n    if (model.container) {\n      model.orientationWidget.setEnabled(false);\n      model.interactor.unbindEvents(model.container);\n\n      model._openGLRenderWindow.setContainer(null);\n\n      model.cornerAnnotation.setContainer(null);\n    }\n\n    model.container = container;\n\n    if (container) {\n      model._openGLRenderWindow.setContainer(container);\n\n      model.cornerAnnotation.setContainer(container);\n      model.interactor.initialize();\n      model.interactor.bindEvents(container);\n      model.orientationWidget.setEnabled(orientationWidgetEnabled);\n    }\n  }; // --------------------------------------------------------------------------\n\n\n  publicAPI.resize = function () {\n    if (model.container) {\n      var dims = model.container.getBoundingClientRect();\n\n      if (dims.width === dims.height && dims.width === 0) {\n        return;\n      }\n\n      var devicePixelRatio = window.devicePixelRatio || 1;\n      var width = Math.max(10, Math.floor(devicePixelRatio * dims.width));\n      var height = Math.max(10, Math.floor(devicePixelRatio * dims.height));\n\n      model._openGLRenderWindow.setSize(width, height);\n\n      publicAPI.invokeResize({\n        width: width,\n        height: height\n      });\n      publicAPI.renderLater();\n    }\n  }; // --------------------------------------------------------------------------\n\n\n  publicAPI.renderLater = function () {\n    publicAPI.render(false);\n  }; // --------------------------------------------------------------------------\n\n\n  publicAPI.render = function () {\n    var blocking = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n\n    if (model.representations.length > 0 && model.resetCameraOnFirstRender) {\n      model.resetCameraOnFirstRender = false;\n      publicAPI.resetCamera();\n    }\n\n    model.orientationWidget.updateMarkerOrientation();\n    model.renderer.resetCameraClippingRange();\n\n    if (blocking) {\n      model.renderWindow.render();\n    } else {\n      setTimeout(model.renderWindow.render, 0);\n    }\n  }; // --------------------------------------------------------------------------\n\n\n  publicAPI.addRepresentation = function (representation) {\n    if (!representation) {\n      return;\n    }\n\n    if (model.representations.indexOf(representation) === -1) {\n      model.representations.push(representation);\n      model.renderer.addViewProp(representation);\n    }\n  }; // --------------------------------------------------------------------------\n\n\n  publicAPI.removeRepresentation = function (representation) {\n    if (!representation) {\n      return;\n    }\n\n    if (model.representations.indexOf(representation) !== -1) {\n      model.representations = model.representations.filter(function (r) {\n        return r !== representation;\n      });\n      model.renderer.removeViewProp(representation);\n    }\n\n    if (model.representations.length === 0) {\n      model.resetCameraOnFirstRender = true;\n    }\n  }; // --------------------------------------------------------------------------\n\n\n  publicAPI.setCameraParameters = function (_ref) {\n    var position = _ref.position,\n        focalPoint = _ref.focalPoint,\n        bounds = _ref.bounds,\n        parallelScale = _ref.parallelScale,\n        viewAngle = _ref.viewAngle;\n\n    if (position != null) {\n      var _model$camera;\n\n      (_model$camera = model.camera).setPosition.apply(_model$camera, _toConsumableArray(position));\n    }\n\n    if (focalPoint != null) {\n      var _model$camera2;\n\n      (_model$camera2 = model.camera).setFocalPoint.apply(_model$camera2, _toConsumableArray(focalPoint));\n    }\n\n    if (bounds != null) {\n      model.renderer.resetCameraClippingRange(bounds);\n    } else {\n      model.renderer.resetCameraClippingRange();\n    }\n\n    if (parallelScale != null) {\n      model.camera.setParallelScale(parallelScale);\n    }\n\n    if (viewAngle != null) {\n      model.camera.setViewAngle(viewAngle);\n    }\n  }; // --------------------------------------------------------------------------\n\n\n  publicAPI.resetCamera = function () {\n    model._resetCamera();\n\n    model.interactorStyle2D.setCenterOfRotation(model.camera.getFocalPoint());\n    model.interactorStyle3D.setCenterOfRotation(model.camera.getFocalPoint());\n    publicAPI.renderLater();\n  }; // --------------------------------------------------------------------------\n\n\n  publicAPI.captureImage = function () {\n    var _ref2 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        _ref2$format = _ref2.format,\n        format = _ref2$format === void 0 ? 'image/png' : _ref2$format,\n        opts = _objectWithoutProperties(_ref2, _excluded);\n\n    return model.renderWindow.captureImages(format, opts)[0];\n  }; // --------------------------------------------------------------------------\n\n\n  publicAPI.openCaptureImage = function () {\n    var target = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '_blank';\n    var image = new Image();\n    return publicAPI.captureImage().then(function (imageURL) {\n      image.src = imageURL;\n      var w = window.open('', target);\n      w.document.write(image.outerHTML);\n      w.document.title = 'vtk.js Image Capture';\n      window.focus();\n    });\n  }; // --------------------------------------------------------------------------\n\n\n  publicAPI.setCornerAnnotation = function (corner, templateString) {\n    model.cornerAnnotation.updateTemplates(_defineProperty({}, corner, function (meta) {\n      return vtkCornerAnnotation.applyTemplate(templateString, meta);\n    }));\n  }; // --------------------------------------------------------------------------\n\n\n  publicAPI.setCornerAnnotations = function (annotations) {\n    var useTemplateString = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n    if (useTemplateString) {\n      Object.keys(annotations).forEach(function (key) {\n        publicAPI.setCornerAnnotation(key, annotations[key]);\n      });\n    } else {\n      model.cornerAnnotation.updateTemplates(annotations);\n    }\n  }; // --------------------------------------------------------------------------\n\n\n  publicAPI.updateCornerAnnotation = function (meta) {\n    return model.cornerAnnotation.updateMetadata(meta);\n  }; // --------------------------------------------------------------------------\n\n\n  publicAPI.setAnnotationOpacity = function (opacity) {\n    if (model.annotationOpacity !== Number(opacity)) {\n      model.annotationOpacity = Number(opacity);\n      model.cornerAnnotation.getAnnotationContainer().style.opacity = opacity;\n      publicAPI.modified();\n    }\n  }; // --------------------------------------------------------------------------\n\n\n  publicAPI.setBackground = chain(model.renderer.setBackground, updateAnnotationColor); // --------------------------------------------------------------------------\n\n  publicAPI.getBackground = model.renderer.getBackground; // --------------------------------------------------------------------------\n\n  publicAPI.setAnimation = function (enable) {\n    var requester = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : publicAPI;\n\n    if (model.disableAnimation && enable) {\n      return;\n    }\n\n    if (enable) {\n      model.renderWindow.getInteractor().requestAnimation(requester);\n    } else {\n      var skipWarning = requester === publicAPI || \"\".concat(requester).indexOf('ViewProxy.moveCamera.') === 0;\n      model.renderWindow.getInteractor().cancelAnimation(requester, skipWarning);\n    }\n  }; // --------------------------------------------------------------------------\n\n\n  publicAPI.updateOrientation = function (axisIndex, orientation, viewUp) {\n    var _model$camera3, _model$camera4, _model$camera5, _model$camera6, _model$camera7;\n\n    var animateSteps = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n\n    if (axisIndex === undefined) {\n      return Promise.resolve();\n    }\n\n    var originalPosition = model.camera.getPosition();\n    var originalViewUp = model.camera.getViewUp();\n    var originalFocalPoint = model.camera.getFocalPoint();\n    model.axis = axisIndex;\n    model.orientation = orientation;\n    model.viewUp = viewUp;\n    var position = model.camera.getFocalPoint();\n    position[model.axis] += model.orientation;\n\n    (_model$camera3 = model.camera).setPosition.apply(_model$camera3, _toConsumableArray(position));\n\n    (_model$camera4 = model.camera).setViewUp.apply(_model$camera4, _toConsumableArray(viewUp));\n\n    model.renderer.resetCamera();\n    var destFocalPoint = model.camera.getFocalPoint();\n    var destPosition = model.camera.getPosition();\n    var destViewUp = model.camera.getViewUp(); // Reset to original to prevent initial render flash\n\n    (_model$camera5 = model.camera).setFocalPoint.apply(_model$camera5, _toConsumableArray(originalFocalPoint));\n\n    (_model$camera6 = model.camera).setPosition.apply(_model$camera6, _toConsumableArray(originalPosition));\n\n    (_model$camera7 = model.camera).setViewUp.apply(_model$camera7, _toConsumableArray(originalViewUp));\n\n    return publicAPI.moveCamera(destFocalPoint, destPosition, destViewUp, animateSteps);\n  }; // --------------------------------------------------------------------------\n\n\n  publicAPI.moveCamera = function (focalPoint, position, viewUp) {\n    var animateSteps = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n    var originalFocalPoint = model.camera.getFocalPoint();\n    var originalPosition = model.camera.getPosition();\n    var originalViewUp = model.camera.getViewUp();\n    var animationStack = [{\n      focalPoint: focalPoint,\n      position: position,\n      viewUp: viewUp\n    }];\n\n    if (animateSteps) {\n      var deltaFocalPoint = [(originalFocalPoint[0] - focalPoint[0]) / animateSteps, (originalFocalPoint[1] - focalPoint[1]) / animateSteps, (originalFocalPoint[2] - focalPoint[2]) / animateSteps];\n      var deltaPosition = [(originalPosition[0] - position[0]) / animateSteps, (originalPosition[1] - position[1]) / animateSteps, (originalPosition[2] - position[2]) / animateSteps];\n      var deltaViewUp = [(originalViewUp[0] - viewUp[0]) / animateSteps, (originalViewUp[1] - viewUp[1]) / animateSteps, (originalViewUp[2] - viewUp[2]) / animateSteps];\n      var needSteps = deltaFocalPoint[0] || deltaFocalPoint[1] || deltaFocalPoint[2] || deltaPosition[0] || deltaPosition[1] || deltaPosition[2] || deltaViewUp[0] || deltaViewUp[1] || deltaViewUp[2];\n      var focalPointDeltaAxisCount = deltaFocalPoint.map(function (i) {\n        return Math.abs(i) < EPSILON ? 0 : 1;\n      }).reduce(function (a, b) {\n        return a + b;\n      }, 0);\n      var positionDeltaAxisCount = deltaPosition.map(function (i) {\n        return Math.abs(i) < EPSILON ? 0 : 1;\n      }).reduce(function (a, b) {\n        return a + b;\n      }, 0);\n      var viewUpDeltaAxisCount = deltaViewUp.map(function (i) {\n        return Math.abs(i) < EPSILON ? 0 : 1;\n      }).reduce(function (a, b) {\n        return a + b;\n      }, 0);\n      var rotation180Only = viewUpDeltaAxisCount === 1 && positionDeltaAxisCount === 0 && focalPointDeltaAxisCount === 0;\n\n      if (needSteps) {\n        if (rotation180Only) {\n          var availableAxes = originalFocalPoint.map(function (fp, i) {\n            return Math.abs(originalPosition[i] - fp) < EPSILON ? i : null;\n          }).filter(function (i) {\n            return i !== null;\n          });\n          var axisCorrectionIndex = availableAxes.find(function (v) {\n            return Math.abs(deltaViewUp[v]) < EPSILON;\n          });\n\n          for (var i = 0; i < animateSteps; i++) {\n            var newViewUp = [viewUp[0] + (i + 1) * deltaViewUp[0], viewUp[1] + (i + 1) * deltaViewUp[1], viewUp[2] + (i + 1) * deltaViewUp[2]];\n            newViewUp[axisCorrectionIndex] = Math.sin(Math.PI * i / (animateSteps - 1));\n            animationStack.push({\n              focalPoint: focalPoint,\n              position: position,\n              viewUp: newViewUp\n            });\n          }\n        } else {\n          for (var _i = 0; _i < animateSteps; _i++) {\n            animationStack.push({\n              focalPoint: [focalPoint[0] + (_i + 1) * deltaFocalPoint[0], focalPoint[1] + (_i + 1) * deltaFocalPoint[1], focalPoint[2] + (_i + 1) * deltaFocalPoint[2]],\n              position: [position[0] + (_i + 1) * deltaPosition[0], position[1] + (_i + 1) * deltaPosition[1], position[2] + (_i + 1) * deltaPosition[2]],\n              viewUp: [viewUp[0] + (_i + 1) * deltaViewUp[0], viewUp[1] + (_i + 1) * deltaViewUp[1], viewUp[2] + (_i + 1) * deltaViewUp[2]]\n            });\n          }\n        }\n      }\n    }\n\n    if (animationStack.length === 1) {\n      // update camera directly\n      model.camera.set(animationStack.pop());\n      model.renderer.resetCameraClippingRange();\n\n      if (model.interactor.getLightFollowCamera()) {\n        model.renderer.updateLightsGeometryToFollowCamera();\n      }\n\n      return Promise.resolve();\n    }\n\n    return new Promise(function (resolve, reject) {\n      var now = performance.now().toString();\n      var animationRequester = \"ViewProxy.moveCamera.\".concat(now);\n      publicAPI.setAnimation(true, animationRequester);\n      var intervalId = null;\n\n      var consumeAnimationStack = function consumeAnimationStack() {\n        if (animationStack.length) {\n          var _model$camera8, _model$camera9, _model$camera10;\n\n          var _animationStack$pop = animationStack.pop(),\n              cameraFocalPoint = _animationStack$pop.focalPoint,\n              cameraPosition = _animationStack$pop.position,\n              cameraViewUp = _animationStack$pop.viewUp;\n\n          (_model$camera8 = model.camera).setFocalPoint.apply(_model$camera8, _toConsumableArray(cameraFocalPoint));\n\n          (_model$camera9 = model.camera).setPosition.apply(_model$camera9, _toConsumableArray(cameraPosition));\n\n          (_model$camera10 = model.camera).setViewUp.apply(_model$camera10, _toConsumableArray(cameraViewUp));\n\n          model.renderer.resetCameraClippingRange();\n\n          if (model.interactor.getLightFollowCamera()) {\n            model.renderer.updateLightsGeometryToFollowCamera();\n          }\n        } else {\n          clearInterval(intervalId);\n          publicAPI.setAnimation(false, animationRequester);\n          resolve();\n        }\n      };\n\n      intervalId = setInterval(consumeAnimationStack, 1);\n    });\n  }; // --------------------------------------------------------------------------\n\n\n  publicAPI.resetOrientation = function () {\n    var animateSteps = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    return publicAPI.updateOrientation(model.axis, model.orientation, model.viewUp, animateSteps);\n  }; // --------------------------------------------------------------------------\n\n\n  publicAPI.rotate = function (angle) {\n    var _model$camera11;\n\n    var _model$camera$get = model.camera.get('viewUp', 'focalPoint', 'position'),\n        viewUp = _model$camera$get.viewUp,\n        focalPoint = _model$camera$get.focalPoint,\n        position = _model$camera$get.position;\n\n    var axis = [focalPoint[0] - position[0], focalPoint[1] - position[1], focalPoint[2] - position[2]];\n    vtkMatrixBuilder.buildFromDegree().rotate(Number.isNaN(angle) ? 90 : angle, axis).apply(viewUp);\n\n    (_model$camera11 = model.camera).setViewUp.apply(_model$camera11, _toConsumableArray(viewUp));\n\n    model.camera.modified();\n    model.orientationWidget.updateMarkerOrientation();\n    model.renderWindow.render();\n  }; // --------------------------------------------------------------------------\n\n\n  publicAPI.focusTo = chain(model.camera.setFocalPoint, model.interactorStyle2D.setCenterOfRotation, model.interactorStyle3D.setCenterOfRotation); // --------------------------------------------------------------------------\n\n  publicAPI.delete = chain(function () {\n    publicAPI.setContainer(null);\n    model.orientationWidget.setEnabled(false);\n    model.orientationWidget.delete();\n    model.orientationAxesArrow.delete();\n    model.orientationAxesCube.delete();\n    model.interactorStyle2D.delete();\n    model.interactorStyle3D.delete();\n    model.cornerAnnotation.delete(); // in reverse order\n\n    model.interactor.delete();\n    model.renderer.delete();\n\n    model._openGLRenderWindow.delete();\n\n    model.renderWindow.delete();\n  }, publicAPI.delete); // --------------------------------------------------------------------------\n  // Initialization from state or input\n  // --------------------------------------------------------------------------\n\n  publicAPI.resetOrientation();\n  updateAnnotationColor();\n} // ----------------------------------------------------------------------------\n// Object factory\n// ----------------------------------------------------------------------------\n\n\nvar DEFAULT_VALUES = {\n  representations: [],\n  sectionName: 'view',\n  annotationOpacity: 1,\n  resetCameraOnFirstRender: true,\n  presetToOrientationAxes: 'lps',\n  orientationAxesType: 'arrow',\n  disableAnimation: false,\n  axis: 1,\n  orientation: 0,\n  viewUp: [0, 0, 1]\n}; // ----------------------------------------------------------------------------\n\nfunction extend(publicAPI, model) {\n  var initialValues = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  Object.assign(model, DEFAULT_VALUES, initialValues);\n  obj(publicAPI, model);\n  setGet(publicAPI, model, ['name', 'disableAnimation']);\n  get(publicAPI, model, ['annotationOpacity', 'camera', 'container', 'cornerAnnotation', 'interactor', 'interactorStyle2D', 'interactorStyle3D', '_openGLRenderWindow', // todo breaking? convert to apiSpecificWindow\n  'orientationAxesType', 'presetToOrientationAxes', 'renderer', 'renderWindow', 'representations', 'useParallelRendering']);\n  moveToProtected(publicAPI, model, ['openGLRenderWindow']);\n  event(publicAPI, model, 'Resize'); // Object specific methods\n\n  vtkViewProxy(publicAPI, model); // Proxy handling\n\n  proxy(publicAPI, model);\n  proxyPropertyMapping(publicAPI, model, {\n    orientationAxesVisibility: {\n      modelKey: 'orientationWidget',\n      property: 'enabled'\n    },\n    orientationAxesCorner: {\n      modelKey: 'orientationWidget',\n      property: 'viewportCorner'\n    },\n    orientationAxesSize: {\n      modelKey: 'orientationWidget',\n      property: 'viewportSize'\n    },\n    cameraViewUp: {\n      modelKey: 'camera',\n      property: 'viewUp',\n      modified: false\n    },\n    cameraPosition: {\n      modelKey: 'camera',\n      property: 'position',\n      modified: false\n    },\n    cameraFocalPoint: {\n      modelKey: 'camera',\n      property: 'focalPoint',\n      modified: false\n    }\n  });\n} // ----------------------------------------------------------------------------\n\n\nvar newInstance = newInstance$1(extend, 'vtkViewProxy'); // ----------------------------------------------------------------------------\n\nvar vtkViewProxy$1 = {\n  newInstance: newInstance,\n  extend: extend\n};\n\nexport { vtkViewProxy$1 as default, newInstance };\n"],"mappings":"AAAA,OAAOA,eAAe,MAAM,uCAAuC;AACnE,OAAOC,wBAAwB,MAAM,gDAAgD;AACrF,OAAOC,kBAAkB,MAAM,0CAA0C;AACzE,OAAOC,cAAc,MAAM,sCAAsC;AACjE,SAASC,WAAW,IAAIC,aAAa,EAAEC,GAAG,EAAEC,MAAM,EAAEC,GAAG,EAAEC,eAAe,EAAEC,KAAK,EAAEC,KAAK,EAAEC,oBAAoB,EAAEC,KAAK,QAAQ,iBAAiB;AAC5I,OAAOC,qBAAqB,MAAM,4CAA4C;AAC9E,OAAOC,YAAY,MAAM,mCAAmC;AAC5D,OAAOC,mBAAmB,MAAM,0CAA0C;AAC1E,OAAOC,6BAA6B,MAAM,uDAAuD;AACjG,OAAOC,gBAAgB,MAAM,oCAAoC;AACjE,OAAO,wCAAwC;AAC/C,OAAO,wCAAwC;AAC/C,OAAOC,0BAA0B,MAAM,sDAAsD;AAC7F,OAAOC,WAAW,MAAM,kCAAkC;AAC1D,OAAOC,eAAe,MAAM,sCAAsC;AAClE,OAAOC,yBAAyB,MAAM,gDAAgD;AACtF,OAAOC,kBAAkB,MAAM,+DAA+D;AAC9F,OAAOC,oBAAoB,MAAM,oDAAoD;AAErF,IAAIC,SAAS,GAAG,CAAC,QAAQ,CAAC;AAC1B,IAAIC,OAAO,GAAG,QAAQ,CAAC,CAAC;AACxB;AACA;;AAEA,SAASC,YAAYA,CAACC,SAAS,EAAEC,KAAK,EAAE;EACtC;EACAA,KAAK,CAACC,cAAc,CAACC,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC;;EAE3C,SAASC,qBAAqBA,CAAA,EAAG;IAC/B,IAAIC,qBAAqB,GAAGJ,KAAK,CAACK,QAAQ,CAACC,aAAa,CAAC,CAAC;MACtDC,sBAAsB,GAAGjC,cAAc,CAAC8B,qBAAqB,EAAE,CAAC,CAAC;MACjEI,CAAC,GAAGD,sBAAsB,CAAC,CAAC,CAAC;MAC7BE,CAAC,GAAGF,sBAAsB,CAAC,CAAC,CAAC;MAC7BG,CAAC,GAAGH,sBAAsB,CAAC,CAAC,CAAC;IAEjCP,KAAK,CAACW,gBAAgB,CAACC,sBAAsB,CAAC,CAAC,CAACC,KAAK,CAACC,KAAK,GAAGN,CAAC,GAAGC,CAAC,GAAGC,CAAC,GAAG,GAAG,GAAG,OAAO,GAAG,OAAO;EACnG,CAAC,CAAC;;EAGFV,KAAK,CAACe,YAAY,GAAGvB,eAAe,CAACjB,WAAW,CAAC,CAAC;EAClDyB,KAAK,CAACK,QAAQ,GAAGd,WAAW,CAAChB,WAAW,CAAC;IACvCyC,UAAU,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC;EACtB,CAAC,CAAC;EACFhB,KAAK,CAACe,YAAY,CAACE,WAAW,CAACjB,KAAK,CAACK,QAAQ,CAAC;EAC9CL,KAAK,CAACkB,mBAAmB,GAAGlB,KAAK,CAACe,YAAY,CAACI,kBAAkB,CAAC,CAAC;EACnEnB,KAAK,CAACe,YAAY,CAACK,OAAO,CAACpB,KAAK,CAACkB,mBAAmB,CAAC;EACrDlB,KAAK,CAACqB,UAAU,GAAG5B,yBAAyB,CAAClB,WAAW,CAAC,CAAC;EAC1DyB,KAAK,CAACqB,UAAU,CAACC,OAAO,CAACtB,KAAK,CAACkB,mBAAmB,CAAC;EACnDlB,KAAK,CAACuB,iBAAiB,GAAGnC,6BAA6B,CAACb,WAAW,CAAC,CAAC;EACrEyB,KAAK,CAACwB,iBAAiB,GAAGpC,6BAA6B,CAACb,WAAW,CAAC,CAAC;EACrE;AACF;AACA;;EAEEyB,KAAK,CAACyB,YAAY,GAAG,YAAY;IAC/B,IAAIC,MAAM,GAAGC,SAAS,CAACC,MAAM,GAAG,CAAC,IAAID,SAAS,CAAC,CAAC,CAAC,KAAKE,SAAS,GAAGF,SAAS,CAAC,CAAC,CAAC,GAAG,IAAI;IACrF,OAAO3B,KAAK,CAACK,QAAQ,CAACyB,WAAW,CAACJ,MAAM,CAAC;EAC3C,CAAC,CAAC,CAAC;;EAGHhC,kBAAkB,CAACqC,WAAW,CAAC,IAAI,EAAE/B,KAAK,CAACuB,iBAAiB,CAAC;EAC7D7B,kBAAkB,CAACqC,WAAW,CAAC,IAAI,EAAE/B,KAAK,CAACwB,iBAAiB,CAAC;EAC7DxB,KAAK,CAACW,gBAAgB,GAAGxB,mBAAmB,CAACZ,WAAW,CAAC,CAAC,CAAC,CAAC;;EAE5DyB,KAAK,CAACqB,UAAU,CAACW,kBAAkB,CAAChC,KAAK,CAACiC,oBAAoB,GAAGjC,KAAK,CAACwB,iBAAiB,GAAGxB,KAAK,CAACuB,iBAAiB,CAAC;EACnHvB,KAAK,CAACkC,MAAM,GAAGlC,KAAK,CAACK,QAAQ,CAAC8B,eAAe,CAAC,CAAC;EAC/CnC,KAAK,CAACkC,MAAM,CAACE,qBAAqB,CAAC,CAAC,CAACpC,KAAK,CAACiC,oBAAoB,CAAC,CAAC,CAAC;;EAElEjC,KAAK,CAACqC,oBAAoB,GAAGnD,YAAY,CAACX,WAAW,CAAC,CAAC;EACvDyB,KAAK,CAACsC,mBAAmB,GAAGrD,qBAAqB,CAACV,WAAW,CAAC,CAAC;EAC/DoB,oBAAoB,CAACoC,WAAW,CAAC,SAAS,EAAE/B,KAAK,CAACsC,mBAAmB,CAAC;EACtE3C,oBAAoB,CAACoC,WAAW,CAAC,KAAK,EAAE/B,KAAK,CAACsC,mBAAmB,CAAC;EAClEtC,KAAK,CAACuC,kBAAkB,GAAG;IACzBC,KAAK,EAAExC,KAAK,CAACqC,oBAAoB;IACjCI,IAAI,EAAEzC,KAAK,CAACsC;EACd,CAAC;EACDtC,KAAK,CAAC0C,iBAAiB,GAAGpD,0BAA0B,CAACf,WAAW,CAAC;IAC/DoE,KAAK,EAAE3C,KAAK,CAACqC,oBAAoB;IACjChB,UAAU,EAAErB,KAAK,CAACe,YAAY,CAAC6B,aAAa,CAAC;EAC/C,CAAC,CAAC;EACF5C,KAAK,CAAC0C,iBAAiB,CAACG,UAAU,CAAC,IAAI,CAAC;EACxC7C,KAAK,CAAC0C,iBAAiB,CAACI,iBAAiB,CAACxD,0BAA0B,CAACyD,OAAO,CAACC,WAAW,CAAC;EACzFhD,KAAK,CAAC0C,iBAAiB,CAACO,eAAe,CAAC,GAAG,CAAC,CAAC,CAAC;;EAE9ClD,SAAS,CAACmD,uBAAuB,GAAG,UAAUC,iBAAiB,EAAE;IAC/D,IAAIC,KAAK,CAACC,OAAO,CAACF,iBAAiB,CAAC,EAAE;MACpC,OAAOzD,kBAAkB,CAAC4D,gBAAgB,CAACH,iBAAiB,EAAEnD,KAAK,CAACuB,iBAAiB,CAAC;IACxF;IAEA,OAAO7B,kBAAkB,CAACqC,WAAW,CAACoB,iBAAiB,EAAEnD,KAAK,CAACuB,iBAAiB,CAAC;EACnF,CAAC,CAAC,CAAC;;EAGHxB,SAAS,CAACwD,uBAAuB,GAAG,UAAUJ,iBAAiB,EAAE;IAC/D,IAAIC,KAAK,CAACC,OAAO,CAACF,iBAAiB,CAAC,EAAE;MACpC,OAAOzD,kBAAkB,CAAC4D,gBAAgB,CAACH,iBAAiB,EAAEnD,KAAK,CAACwB,iBAAiB,CAAC;IACxF;IAEA,OAAO9B,kBAAkB,CAACqC,WAAW,CAACoB,iBAAiB,EAAEnD,KAAK,CAACwB,iBAAiB,CAAC;EACnF,CAAC,CAAC,CAAC;;EAGHzB,SAAS,CAACyD,sBAAsB,GAAG,UAAUC,IAAI,EAAE;IACjD,IAAId,KAAK,GAAG3C,KAAK,CAACuC,kBAAkB,CAACkB,IAAI,CAAC;IAE1C,IAAId,KAAK,EAAE;MACT3C,KAAK,CAAC0D,mBAAmB,GAAGD,IAAI;MAChCzD,KAAK,CAAC0C,iBAAiB,CAACiB,QAAQ,CAAChB,KAAK,CAAC;MACvC5C,SAAS,CAAC6D,WAAW,CAAC,CAAC;IACzB;EACF,CAAC,CAAC,CAAC;;EAGH7D,SAAS,CAAC8D,uBAAuB,GAAG,UAAUC,IAAI,EAAEnB,KAAK,EAAE;IACzD3C,KAAK,CAACuC,kBAAkB,CAACuB,IAAI,CAAC,GAAGnB,KAAK;EACxC,CAAC,CAAC,CAAC;;EAGH5C,SAAS,CAACgE,yBAAyB,GAAG,UAAUD,IAAI,EAAE;IACpD,OAAO9D,KAAK,CAACuC,kBAAkB,CAACuB,IAAI,CAAC;EACvC,CAAC,CAAC,CAAC;;EAGH/D,SAAS,CAACiE,mBAAmB,GAAG,YAAY;IAC1C,OAAOC,MAAM,CAACC,IAAI,CAAClE,KAAK,CAACuC,kBAAkB,CAAC;EAC9C,CAAC,CAAC,CAAC;;EAGHxC,SAAS,CAACoE,0BAA0B,GAAG,UAAUhB,iBAAiB,EAAE;IAClE,IAAIiB,cAAc,GAAG,KAAK;IAE1B,IAAI,OAAOjB,iBAAiB,KAAK,QAAQ,EAAE;MACzC,IAAInD,KAAK,CAACqE,uBAAuB,KAAKlB,iBAAiB,EAAE;QACvDnD,KAAK,CAACqE,uBAAuB,GAAGlB,iBAAiB;QACjDiB,cAAc,GAAGzE,oBAAoB,CAACoC,WAAW,CAACoB,iBAAiB,EAAEnD,KAAK,CAACsC,mBAAmB,CAAC;QAC/FvC,SAAS,CAACuE,QAAQ,CAAC,CAAC;MACtB;MAEA,OAAOF,cAAc;IACvB;IAEApE,KAAK,CAACqE,uBAAuB,GAAG,QAAQ;IACxCD,cAAc,GAAGzE,oBAAoB,CAAC2D,gBAAgB,CAACH,iBAAiB,EAAEnD,KAAK,CAACsC,mBAAmB,CAAC;IACpGvC,SAAS,CAACuE,QAAQ,CAAC,CAAC;IACpB,OAAOF,cAAc;EACvB,CAAC,CAAC,CAAC;;EAGHrE,SAAS,CAACwE,YAAY,GAAG,UAAUC,SAAS,EAAE;IAC5C,IAAIC,wBAAwB,GAAGzE,KAAK,CAAC0C,iBAAiB,CAACgC,UAAU,CAAC,CAAC;IAEnE,IAAI1E,KAAK,CAACwE,SAAS,EAAE;MACnBxE,KAAK,CAAC0C,iBAAiB,CAACG,UAAU,CAAC,KAAK,CAAC;MACzC7C,KAAK,CAACqB,UAAU,CAACsD,YAAY,CAAC3E,KAAK,CAACwE,SAAS,CAAC;MAE9CxE,KAAK,CAACkB,mBAAmB,CAACqD,YAAY,CAAC,IAAI,CAAC;MAE5CvE,KAAK,CAACW,gBAAgB,CAAC4D,YAAY,CAAC,IAAI,CAAC;IAC3C;IAEAvE,KAAK,CAACwE,SAAS,GAAGA,SAAS;IAE3B,IAAIA,SAAS,EAAE;MACbxE,KAAK,CAACkB,mBAAmB,CAACqD,YAAY,CAACC,SAAS,CAAC;MAEjDxE,KAAK,CAACW,gBAAgB,CAAC4D,YAAY,CAACC,SAAS,CAAC;MAC9CxE,KAAK,CAACqB,UAAU,CAACuD,UAAU,CAAC,CAAC;MAC7B5E,KAAK,CAACqB,UAAU,CAACwD,UAAU,CAACL,SAAS,CAAC;MACtCxE,KAAK,CAAC0C,iBAAiB,CAACG,UAAU,CAAC4B,wBAAwB,CAAC;IAC9D;EACF,CAAC,CAAC,CAAC;;EAGH1E,SAAS,CAAC+E,MAAM,GAAG,YAAY;IAC7B,IAAI9E,KAAK,CAACwE,SAAS,EAAE;MACnB,IAAIO,IAAI,GAAG/E,KAAK,CAACwE,SAAS,CAACQ,qBAAqB,CAAC,CAAC;MAElD,IAAID,IAAI,CAACE,KAAK,KAAKF,IAAI,CAACG,MAAM,IAAIH,IAAI,CAACE,KAAK,KAAK,CAAC,EAAE;QAClD;MACF;MAEA,IAAIE,gBAAgB,GAAGC,MAAM,CAACD,gBAAgB,IAAI,CAAC;MACnD,IAAIF,KAAK,GAAGI,IAAI,CAACC,GAAG,CAAC,EAAE,EAAED,IAAI,CAACE,KAAK,CAACJ,gBAAgB,GAAGJ,IAAI,CAACE,KAAK,CAAC,CAAC;MACnE,IAAIC,MAAM,GAAGG,IAAI,CAACC,GAAG,CAAC,EAAE,EAAED,IAAI,CAACE,KAAK,CAACJ,gBAAgB,GAAGJ,IAAI,CAACG,MAAM,CAAC,CAAC;MAErElF,KAAK,CAACkB,mBAAmB,CAACsE,OAAO,CAACP,KAAK,EAAEC,MAAM,CAAC;MAEhDnF,SAAS,CAAC0F,YAAY,CAAC;QACrBR,KAAK,EAAEA,KAAK;QACZC,MAAM,EAAEA;MACV,CAAC,CAAC;MACFnF,SAAS,CAAC6D,WAAW,CAAC,CAAC;IACzB;EACF,CAAC,CAAC,CAAC;;EAGH7D,SAAS,CAAC6D,WAAW,GAAG,YAAY;IAClC7D,SAAS,CAAC2F,MAAM,CAAC,KAAK,CAAC;EACzB,CAAC,CAAC,CAAC;;EAGH3F,SAAS,CAAC2F,MAAM,GAAG,YAAY;IAC7B,IAAIC,QAAQ,GAAGhE,SAAS,CAACC,MAAM,GAAG,CAAC,IAAID,SAAS,CAAC,CAAC,CAAC,KAAKE,SAAS,GAAGF,SAAS,CAAC,CAAC,CAAC,GAAG,IAAI;IAEvF,IAAI3B,KAAK,CAAC4F,eAAe,CAAChE,MAAM,GAAG,CAAC,IAAI5B,KAAK,CAAC6F,wBAAwB,EAAE;MACtE7F,KAAK,CAAC6F,wBAAwB,GAAG,KAAK;MACtC9F,SAAS,CAAC+B,WAAW,CAAC,CAAC;IACzB;IAEA9B,KAAK,CAAC0C,iBAAiB,CAACoD,uBAAuB,CAAC,CAAC;IACjD9F,KAAK,CAACK,QAAQ,CAAC0F,wBAAwB,CAAC,CAAC;IAEzC,IAAIJ,QAAQ,EAAE;MACZ3F,KAAK,CAACe,YAAY,CAAC2E,MAAM,CAAC,CAAC;IAC7B,CAAC,MAAM;MACLM,UAAU,CAAChG,KAAK,CAACe,YAAY,CAAC2E,MAAM,EAAE,CAAC,CAAC;IAC1C;EACF,CAAC,CAAC,CAAC;;EAGH3F,SAAS,CAACkG,iBAAiB,GAAG,UAAUC,cAAc,EAAE;IACtD,IAAI,CAACA,cAAc,EAAE;MACnB;IACF;IAEA,IAAIlG,KAAK,CAAC4F,eAAe,CAACO,OAAO,CAACD,cAAc,CAAC,KAAK,CAAC,CAAC,EAAE;MACxDlG,KAAK,CAAC4F,eAAe,CAAC1F,IAAI,CAACgG,cAAc,CAAC;MAC1ClG,KAAK,CAACK,QAAQ,CAAC+F,WAAW,CAACF,cAAc,CAAC;IAC5C;EACF,CAAC,CAAC,CAAC;;EAGHnG,SAAS,CAACsG,oBAAoB,GAAG,UAAUH,cAAc,EAAE;IACzD,IAAI,CAACA,cAAc,EAAE;MACnB;IACF;IAEA,IAAIlG,KAAK,CAAC4F,eAAe,CAACO,OAAO,CAACD,cAAc,CAAC,KAAK,CAAC,CAAC,EAAE;MACxDlG,KAAK,CAAC4F,eAAe,GAAG5F,KAAK,CAAC4F,eAAe,CAACU,MAAM,CAAC,UAAU9F,CAAC,EAAE;QAChE,OAAOA,CAAC,KAAK0F,cAAc;MAC7B,CAAC,CAAC;MACFlG,KAAK,CAACK,QAAQ,CAACkG,cAAc,CAACL,cAAc,CAAC;IAC/C;IAEA,IAAIlG,KAAK,CAAC4F,eAAe,CAAChE,MAAM,KAAK,CAAC,EAAE;MACtC5B,KAAK,CAAC6F,wBAAwB,GAAG,IAAI;IACvC;EACF,CAAC,CAAC,CAAC;;EAGH9F,SAAS,CAACyG,mBAAmB,GAAG,UAAUC,IAAI,EAAE;IAC9C,IAAIC,QAAQ,GAAGD,IAAI,CAACC,QAAQ;MACxBC,UAAU,GAAGF,IAAI,CAACE,UAAU;MAC5BjF,MAAM,GAAG+E,IAAI,CAAC/E,MAAM;MACpBkF,aAAa,GAAGH,IAAI,CAACG,aAAa;MAClCC,SAAS,GAAGJ,IAAI,CAACI,SAAS;IAE9B,IAAIH,QAAQ,IAAI,IAAI,EAAE;MACpB,IAAII,aAAa;MAEjB,CAACA,aAAa,GAAG9G,KAAK,CAACkC,MAAM,EAAE6E,WAAW,CAACC,KAAK,CAACF,aAAa,EAAEzI,kBAAkB,CAACqI,QAAQ,CAAC,CAAC;IAC/F;IAEA,IAAIC,UAAU,IAAI,IAAI,EAAE;MACtB,IAAIM,cAAc;MAElB,CAACA,cAAc,GAAGjH,KAAK,CAACkC,MAAM,EAAEgF,aAAa,CAACF,KAAK,CAACC,cAAc,EAAE5I,kBAAkB,CAACsI,UAAU,CAAC,CAAC;IACrG;IAEA,IAAIjF,MAAM,IAAI,IAAI,EAAE;MAClB1B,KAAK,CAACK,QAAQ,CAAC0F,wBAAwB,CAACrE,MAAM,CAAC;IACjD,CAAC,MAAM;MACL1B,KAAK,CAACK,QAAQ,CAAC0F,wBAAwB,CAAC,CAAC;IAC3C;IAEA,IAAIa,aAAa,IAAI,IAAI,EAAE;MACzB5G,KAAK,CAACkC,MAAM,CAACiF,gBAAgB,CAACP,aAAa,CAAC;IAC9C;IAEA,IAAIC,SAAS,IAAI,IAAI,EAAE;MACrB7G,KAAK,CAACkC,MAAM,CAACkF,YAAY,CAACP,SAAS,CAAC;IACtC;EACF,CAAC,CAAC,CAAC;;EAGH9G,SAAS,CAAC+B,WAAW,GAAG,YAAY;IAClC9B,KAAK,CAACyB,YAAY,CAAC,CAAC;IAEpBzB,KAAK,CAACwB,iBAAiB,CAAC6F,mBAAmB,CAACrH,KAAK,CAACkC,MAAM,CAACoF,aAAa,CAAC,CAAC,CAAC;IACzEtH,KAAK,CAACuB,iBAAiB,CAAC8F,mBAAmB,CAACrH,KAAK,CAACkC,MAAM,CAACoF,aAAa,CAAC,CAAC,CAAC;IACzEvH,SAAS,CAAC6D,WAAW,CAAC,CAAC;EACzB,CAAC,CAAC,CAAC;;EAGH7D,SAAS,CAACwH,YAAY,GAAG,YAAY;IACnC,IAAIC,KAAK,GAAG7F,SAAS,CAACC,MAAM,GAAG,CAAC,IAAID,SAAS,CAAC,CAAC,CAAC,KAAKE,SAAS,GAAGF,SAAS,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;MAC9E8F,YAAY,GAAGD,KAAK,CAACE,MAAM;MAC3BA,MAAM,GAAGD,YAAY,KAAK,KAAK,CAAC,GAAG,WAAW,GAAGA,YAAY;MAC7DE,IAAI,GAAGvJ,wBAAwB,CAACoJ,KAAK,EAAE5H,SAAS,CAAC;IAErD,OAAOI,KAAK,CAACe,YAAY,CAAC6G,aAAa,CAACF,MAAM,EAAEC,IAAI,CAAC,CAAC,CAAC,CAAC;EAC1D,CAAC,CAAC,CAAC;;EAGH5H,SAAS,CAAC8H,gBAAgB,GAAG,YAAY;IACvC,IAAIC,MAAM,GAAGnG,SAAS,CAACC,MAAM,GAAG,CAAC,IAAID,SAAS,CAAC,CAAC,CAAC,KAAKE,SAAS,GAAGF,SAAS,CAAC,CAAC,CAAC,GAAG,QAAQ;IACzF,IAAIoG,KAAK,GAAG,IAAIC,KAAK,CAAC,CAAC;IACvB,OAAOjI,SAAS,CAACwH,YAAY,CAAC,CAAC,CAACU,IAAI,CAAC,UAAUC,QAAQ,EAAE;MACvDH,KAAK,CAACI,GAAG,GAAGD,QAAQ;MACpB,IAAIE,CAAC,GAAGhD,MAAM,CAACiD,IAAI,CAAC,EAAE,EAAEP,MAAM,CAAC;MAC/BM,CAAC,CAACE,QAAQ,CAACC,KAAK,CAACR,KAAK,CAACS,SAAS,CAAC;MACjCJ,CAAC,CAACE,QAAQ,CAACG,KAAK,GAAG,sBAAsB;MACzCrD,MAAM,CAACsD,KAAK,CAAC,CAAC;IAChB,CAAC,CAAC;EACJ,CAAC,CAAC,CAAC;;EAGH3I,SAAS,CAAC4I,mBAAmB,GAAG,UAAUC,MAAM,EAAEC,cAAc,EAAE;IAChE7I,KAAK,CAACW,gBAAgB,CAACmI,eAAe,CAAC3K,eAAe,CAAC,CAAC,CAAC,EAAEyK,MAAM,EAAE,UAAUG,IAAI,EAAE;MACjF,OAAO5J,mBAAmB,CAAC6J,aAAa,CAACH,cAAc,EAAEE,IAAI,CAAC;IAChE,CAAC,CAAC,CAAC;EACL,CAAC,CAAC,CAAC;;EAGHhJ,SAAS,CAACkJ,oBAAoB,GAAG,UAAUC,WAAW,EAAE;IACtD,IAAIC,iBAAiB,GAAGxH,SAAS,CAACC,MAAM,GAAG,CAAC,IAAID,SAAS,CAAC,CAAC,CAAC,KAAKE,SAAS,GAAGF,SAAS,CAAC,CAAC,CAAC,GAAG,KAAK;IAEjG,IAAIwH,iBAAiB,EAAE;MACrBlF,MAAM,CAACC,IAAI,CAACgF,WAAW,CAAC,CAACE,OAAO,CAAC,UAAUC,GAAG,EAAE;QAC9CtJ,SAAS,CAAC4I,mBAAmB,CAACU,GAAG,EAAEH,WAAW,CAACG,GAAG,CAAC,CAAC;MACtD,CAAC,CAAC;IACJ,CAAC,MAAM;MACLrJ,KAAK,CAACW,gBAAgB,CAACmI,eAAe,CAACI,WAAW,CAAC;IACrD;EACF,CAAC,CAAC,CAAC;;EAGHnJ,SAAS,CAACuJ,sBAAsB,GAAG,UAAUP,IAAI,EAAE;IACjD,OAAO/I,KAAK,CAACW,gBAAgB,CAAC4I,cAAc,CAACR,IAAI,CAAC;EACpD,CAAC,CAAC,CAAC;;EAGHhJ,SAAS,CAACyJ,oBAAoB,GAAG,UAAUC,OAAO,EAAE;IAClD,IAAIzJ,KAAK,CAAC0J,iBAAiB,KAAKC,MAAM,CAACF,OAAO,CAAC,EAAE;MAC/CzJ,KAAK,CAAC0J,iBAAiB,GAAGC,MAAM,CAACF,OAAO,CAAC;MACzCzJ,KAAK,CAACW,gBAAgB,CAACC,sBAAsB,CAAC,CAAC,CAACC,KAAK,CAAC4I,OAAO,GAAGA,OAAO;MACvE1J,SAAS,CAACuE,QAAQ,CAAC,CAAC;IACtB;EACF,CAAC,CAAC,CAAC;;EAGHvE,SAAS,CAAC6J,aAAa,GAAG5K,KAAK,CAACgB,KAAK,CAACK,QAAQ,CAACuJ,aAAa,EAAEzJ,qBAAqB,CAAC,CAAC,CAAC;;EAEtFJ,SAAS,CAACO,aAAa,GAAGN,KAAK,CAACK,QAAQ,CAACC,aAAa,CAAC,CAAC;;EAExDP,SAAS,CAAC8J,YAAY,GAAG,UAAUC,MAAM,EAAE;IACzC,IAAIC,SAAS,GAAGpI,SAAS,CAACC,MAAM,GAAG,CAAC,IAAID,SAAS,CAAC,CAAC,CAAC,KAAKE,SAAS,GAAGF,SAAS,CAAC,CAAC,CAAC,GAAG5B,SAAS;IAE7F,IAAIC,KAAK,CAACgK,gBAAgB,IAAIF,MAAM,EAAE;MACpC;IACF;IAEA,IAAIA,MAAM,EAAE;MACV9J,KAAK,CAACe,YAAY,CAAC6B,aAAa,CAAC,CAAC,CAACqH,gBAAgB,CAACF,SAAS,CAAC;IAChE,CAAC,MAAM;MACL,IAAIG,WAAW,GAAGH,SAAS,KAAKhK,SAAS,IAAI,EAAE,CAACoK,MAAM,CAACJ,SAAS,CAAC,CAAC5D,OAAO,CAAC,uBAAuB,CAAC,KAAK,CAAC;MACxGnG,KAAK,CAACe,YAAY,CAAC6B,aAAa,CAAC,CAAC,CAACwH,eAAe,CAACL,SAAS,EAAEG,WAAW,CAAC;IAC5E;EACF,CAAC,CAAC,CAAC;;EAGHnK,SAAS,CAACsK,iBAAiB,GAAG,UAAUC,SAAS,EAAEC,WAAW,EAAEC,MAAM,EAAE;IACtE,IAAIC,cAAc,EAAEC,cAAc,EAAEC,cAAc,EAAEC,cAAc,EAAEC,cAAc;IAElF,IAAIC,YAAY,GAAGnJ,SAAS,CAACC,MAAM,GAAG,CAAC,IAAID,SAAS,CAAC,CAAC,CAAC,KAAKE,SAAS,GAAGF,SAAS,CAAC,CAAC,CAAC,GAAG,CAAC;IAExF,IAAI2I,SAAS,KAAKzI,SAAS,EAAE;MAC3B,OAAOkJ,OAAO,CAACC,OAAO,CAAC,CAAC;IAC1B;IAEA,IAAIC,gBAAgB,GAAGjL,KAAK,CAACkC,MAAM,CAACgJ,WAAW,CAAC,CAAC;IACjD,IAAIC,cAAc,GAAGnL,KAAK,CAACkC,MAAM,CAACkJ,SAAS,CAAC,CAAC;IAC7C,IAAIC,kBAAkB,GAAGrL,KAAK,CAACkC,MAAM,CAACoF,aAAa,CAAC,CAAC;IACrDtH,KAAK,CAACsL,IAAI,GAAGhB,SAAS;IACtBtK,KAAK,CAACuK,WAAW,GAAGA,WAAW;IAC/BvK,KAAK,CAACwK,MAAM,GAAGA,MAAM;IACrB,IAAI9D,QAAQ,GAAG1G,KAAK,CAACkC,MAAM,CAACoF,aAAa,CAAC,CAAC;IAC3CZ,QAAQ,CAAC1G,KAAK,CAACsL,IAAI,CAAC,IAAItL,KAAK,CAACuK,WAAW;IAEzC,CAACE,cAAc,GAAGzK,KAAK,CAACkC,MAAM,EAAE6E,WAAW,CAACC,KAAK,CAACyD,cAAc,EAAEpM,kBAAkB,CAACqI,QAAQ,CAAC,CAAC;IAE/F,CAACgE,cAAc,GAAG1K,KAAK,CAACkC,MAAM,EAAEqJ,SAAS,CAACvE,KAAK,CAAC0D,cAAc,EAAErM,kBAAkB,CAACmM,MAAM,CAAC,CAAC;IAE3FxK,KAAK,CAACK,QAAQ,CAACyB,WAAW,CAAC,CAAC;IAC5B,IAAI0J,cAAc,GAAGxL,KAAK,CAACkC,MAAM,CAACoF,aAAa,CAAC,CAAC;IACjD,IAAImE,YAAY,GAAGzL,KAAK,CAACkC,MAAM,CAACgJ,WAAW,CAAC,CAAC;IAC7C,IAAIQ,UAAU,GAAG1L,KAAK,CAACkC,MAAM,CAACkJ,SAAS,CAAC,CAAC,CAAC,CAAC;;IAE3C,CAACT,cAAc,GAAG3K,KAAK,CAACkC,MAAM,EAAEgF,aAAa,CAACF,KAAK,CAAC2D,cAAc,EAAEtM,kBAAkB,CAACgN,kBAAkB,CAAC,CAAC;IAE3G,CAACT,cAAc,GAAG5K,KAAK,CAACkC,MAAM,EAAE6E,WAAW,CAACC,KAAK,CAAC4D,cAAc,EAAEvM,kBAAkB,CAAC4M,gBAAgB,CAAC,CAAC;IAEvG,CAACJ,cAAc,GAAG7K,KAAK,CAACkC,MAAM,EAAEqJ,SAAS,CAACvE,KAAK,CAAC6D,cAAc,EAAExM,kBAAkB,CAAC8M,cAAc,CAAC,CAAC;IAEnG,OAAOpL,SAAS,CAAC4L,UAAU,CAACH,cAAc,EAAEC,YAAY,EAAEC,UAAU,EAAEZ,YAAY,CAAC;EACrF,CAAC,CAAC,CAAC;;EAGH/K,SAAS,CAAC4L,UAAU,GAAG,UAAUhF,UAAU,EAAED,QAAQ,EAAE8D,MAAM,EAAE;IAC7D,IAAIM,YAAY,GAAGnJ,SAAS,CAACC,MAAM,GAAG,CAAC,IAAID,SAAS,CAAC,CAAC,CAAC,KAAKE,SAAS,GAAGF,SAAS,CAAC,CAAC,CAAC,GAAG,CAAC;IACxF,IAAI0J,kBAAkB,GAAGrL,KAAK,CAACkC,MAAM,CAACoF,aAAa,CAAC,CAAC;IACrD,IAAI2D,gBAAgB,GAAGjL,KAAK,CAACkC,MAAM,CAACgJ,WAAW,CAAC,CAAC;IACjD,IAAIC,cAAc,GAAGnL,KAAK,CAACkC,MAAM,CAACkJ,SAAS,CAAC,CAAC;IAC7C,IAAIQ,cAAc,GAAG,CAAC;MACpBjF,UAAU,EAAEA,UAAU;MACtBD,QAAQ,EAAEA,QAAQ;MAClB8D,MAAM,EAAEA;IACV,CAAC,CAAC;IAEF,IAAIM,YAAY,EAAE;MAChB,IAAIe,eAAe,GAAG,CAAC,CAACR,kBAAkB,CAAC,CAAC,CAAC,GAAG1E,UAAU,CAAC,CAAC,CAAC,IAAImE,YAAY,EAAE,CAACO,kBAAkB,CAAC,CAAC,CAAC,GAAG1E,UAAU,CAAC,CAAC,CAAC,IAAImE,YAAY,EAAE,CAACO,kBAAkB,CAAC,CAAC,CAAC,GAAG1E,UAAU,CAAC,CAAC,CAAC,IAAImE,YAAY,CAAC;MAC9L,IAAIgB,aAAa,GAAG,CAAC,CAACb,gBAAgB,CAAC,CAAC,CAAC,GAAGvE,QAAQ,CAAC,CAAC,CAAC,IAAIoE,YAAY,EAAE,CAACG,gBAAgB,CAAC,CAAC,CAAC,GAAGvE,QAAQ,CAAC,CAAC,CAAC,IAAIoE,YAAY,EAAE,CAACG,gBAAgB,CAAC,CAAC,CAAC,GAAGvE,QAAQ,CAAC,CAAC,CAAC,IAAIoE,YAAY,CAAC;MAChL,IAAIiB,WAAW,GAAG,CAAC,CAACZ,cAAc,CAAC,CAAC,CAAC,GAAGX,MAAM,CAAC,CAAC,CAAC,IAAIM,YAAY,EAAE,CAACK,cAAc,CAAC,CAAC,CAAC,GAAGX,MAAM,CAAC,CAAC,CAAC,IAAIM,YAAY,EAAE,CAACK,cAAc,CAAC,CAAC,CAAC,GAAGX,MAAM,CAAC,CAAC,CAAC,IAAIM,YAAY,CAAC;MAClK,IAAIkB,SAAS,GAAGH,eAAe,CAAC,CAAC,CAAC,IAAIA,eAAe,CAAC,CAAC,CAAC,IAAIA,eAAe,CAAC,CAAC,CAAC,IAAIC,aAAa,CAAC,CAAC,CAAC,IAAIA,aAAa,CAAC,CAAC,CAAC,IAAIA,aAAa,CAAC,CAAC,CAAC,IAAIC,WAAW,CAAC,CAAC,CAAC,IAAIA,WAAW,CAAC,CAAC,CAAC,IAAIA,WAAW,CAAC,CAAC,CAAC;MAChM,IAAIE,wBAAwB,GAAGJ,eAAe,CAACK,GAAG,CAAC,UAAUC,CAAC,EAAE;QAC9D,OAAO9G,IAAI,CAAC+G,GAAG,CAACD,CAAC,CAAC,GAAGtM,OAAO,GAAG,CAAC,GAAG,CAAC;MACtC,CAAC,CAAC,CAACwM,MAAM,CAAC,UAAUC,CAAC,EAAE5L,CAAC,EAAE;QACxB,OAAO4L,CAAC,GAAG5L,CAAC;MACd,CAAC,EAAE,CAAC,CAAC;MACL,IAAI6L,sBAAsB,GAAGT,aAAa,CAACI,GAAG,CAAC,UAAUC,CAAC,EAAE;QAC1D,OAAO9G,IAAI,CAAC+G,GAAG,CAACD,CAAC,CAAC,GAAGtM,OAAO,GAAG,CAAC,GAAG,CAAC;MACtC,CAAC,CAAC,CAACwM,MAAM,CAAC,UAAUC,CAAC,EAAE5L,CAAC,EAAE;QACxB,OAAO4L,CAAC,GAAG5L,CAAC;MACd,CAAC,EAAE,CAAC,CAAC;MACL,IAAI8L,oBAAoB,GAAGT,WAAW,CAACG,GAAG,CAAC,UAAUC,CAAC,EAAE;QACtD,OAAO9G,IAAI,CAAC+G,GAAG,CAACD,CAAC,CAAC,GAAGtM,OAAO,GAAG,CAAC,GAAG,CAAC;MACtC,CAAC,CAAC,CAACwM,MAAM,CAAC,UAAUC,CAAC,EAAE5L,CAAC,EAAE;QACxB,OAAO4L,CAAC,GAAG5L,CAAC;MACd,CAAC,EAAE,CAAC,CAAC;MACL,IAAI+L,eAAe,GAAGD,oBAAoB,KAAK,CAAC,IAAID,sBAAsB,KAAK,CAAC,IAAIN,wBAAwB,KAAK,CAAC;MAElH,IAAID,SAAS,EAAE;QACb,IAAIS,eAAe,EAAE;UACnB,IAAIC,aAAa,GAAGrB,kBAAkB,CAACa,GAAG,CAAC,UAAUS,EAAE,EAAER,CAAC,EAAE;YAC1D,OAAO9G,IAAI,CAAC+G,GAAG,CAACnB,gBAAgB,CAACkB,CAAC,CAAC,GAAGQ,EAAE,CAAC,GAAG9M,OAAO,GAAGsM,CAAC,GAAG,IAAI;UAChE,CAAC,CAAC,CAAC7F,MAAM,CAAC,UAAU6F,CAAC,EAAE;YACrB,OAAOA,CAAC,KAAK,IAAI;UACnB,CAAC,CAAC;UACF,IAAIS,mBAAmB,GAAGF,aAAa,CAACG,IAAI,CAAC,UAAUC,CAAC,EAAE;YACxD,OAAOzH,IAAI,CAAC+G,GAAG,CAACL,WAAW,CAACe,CAAC,CAAC,CAAC,GAAGjN,OAAO;UAC3C,CAAC,CAAC;UAEF,KAAK,IAAIsM,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGrB,YAAY,EAAEqB,CAAC,EAAE,EAAE;YACrC,IAAIY,SAAS,GAAG,CAACvC,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC2B,CAAC,GAAG,CAAC,IAAIJ,WAAW,CAAC,CAAC,CAAC,EAAEvB,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC2B,CAAC,GAAG,CAAC,IAAIJ,WAAW,CAAC,CAAC,CAAC,EAAEvB,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC2B,CAAC,GAAG,CAAC,IAAIJ,WAAW,CAAC,CAAC,CAAC,CAAC;YAClIgB,SAAS,CAACH,mBAAmB,CAAC,GAAGvH,IAAI,CAAC2H,GAAG,CAAC3H,IAAI,CAAC4H,EAAE,GAAGd,CAAC,IAAIrB,YAAY,GAAG,CAAC,CAAC,CAAC;YAC3Ec,cAAc,CAAC1L,IAAI,CAAC;cAClByG,UAAU,EAAEA,UAAU;cACtBD,QAAQ,EAAEA,QAAQ;cAClB8D,MAAM,EAAEuC;YACV,CAAC,CAAC;UACJ;QACF,CAAC,MAAM;UACL,KAAK,IAAIG,EAAE,GAAG,CAAC,EAAEA,EAAE,GAAGpC,YAAY,EAAEoC,EAAE,EAAE,EAAE;YACxCtB,cAAc,CAAC1L,IAAI,CAAC;cAClByG,UAAU,EAAE,CAACA,UAAU,CAAC,CAAC,CAAC,GAAG,CAACuG,EAAE,GAAG,CAAC,IAAIrB,eAAe,CAAC,CAAC,CAAC,EAAElF,UAAU,CAAC,CAAC,CAAC,GAAG,CAACuG,EAAE,GAAG,CAAC,IAAIrB,eAAe,CAAC,CAAC,CAAC,EAAElF,UAAU,CAAC,CAAC,CAAC,GAAG,CAACuG,EAAE,GAAG,CAAC,IAAIrB,eAAe,CAAC,CAAC,CAAC,CAAC;cACzJnF,QAAQ,EAAE,CAACA,QAAQ,CAAC,CAAC,CAAC,GAAG,CAACwG,EAAE,GAAG,CAAC,IAAIpB,aAAa,CAAC,CAAC,CAAC,EAAEpF,QAAQ,CAAC,CAAC,CAAC,GAAG,CAACwG,EAAE,GAAG,CAAC,IAAIpB,aAAa,CAAC,CAAC,CAAC,EAAEpF,QAAQ,CAAC,CAAC,CAAC,GAAG,CAACwG,EAAE,GAAG,CAAC,IAAIpB,aAAa,CAAC,CAAC,CAAC,CAAC;cAC3ItB,MAAM,EAAE,CAACA,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC0C,EAAE,GAAG,CAAC,IAAInB,WAAW,CAAC,CAAC,CAAC,EAAEvB,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC0C,EAAE,GAAG,CAAC,IAAInB,WAAW,CAAC,CAAC,CAAC,EAAEvB,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC0C,EAAE,GAAG,CAAC,IAAInB,WAAW,CAAC,CAAC,CAAC;YAC9H,CAAC,CAAC;UACJ;QACF;MACF;IACF;IAEA,IAAIH,cAAc,CAAChK,MAAM,KAAK,CAAC,EAAE;MAC/B;MACA5B,KAAK,CAACkC,MAAM,CAACiL,GAAG,CAACvB,cAAc,CAACwB,GAAG,CAAC,CAAC,CAAC;MACtCpN,KAAK,CAACK,QAAQ,CAAC0F,wBAAwB,CAAC,CAAC;MAEzC,IAAI/F,KAAK,CAACqB,UAAU,CAACgM,oBAAoB,CAAC,CAAC,EAAE;QAC3CrN,KAAK,CAACK,QAAQ,CAACiN,kCAAkC,CAAC,CAAC;MACrD;MAEA,OAAOvC,OAAO,CAACC,OAAO,CAAC,CAAC;IAC1B;IAEA,OAAO,IAAID,OAAO,CAAC,UAAUC,OAAO,EAAEuC,MAAM,EAAE;MAC5C,IAAIC,GAAG,GAAGC,WAAW,CAACD,GAAG,CAAC,CAAC,CAACE,QAAQ,CAAC,CAAC;MACtC,IAAIC,kBAAkB,GAAG,uBAAuB,CAACxD,MAAM,CAACqD,GAAG,CAAC;MAC5DzN,SAAS,CAAC8J,YAAY,CAAC,IAAI,EAAE8D,kBAAkB,CAAC;MAChD,IAAIC,UAAU,GAAG,IAAI;MAErB,IAAIC,qBAAqB,GAAG,SAASA,qBAAqBA,CAAA,EAAG;QAC3D,IAAIjC,cAAc,CAAChK,MAAM,EAAE;UACzB,IAAIkM,cAAc,EAAEC,cAAc,EAAEC,eAAe;UAEnD,IAAIC,mBAAmB,GAAGrC,cAAc,CAACwB,GAAG,CAAC,CAAC;YAC1Cc,gBAAgB,GAAGD,mBAAmB,CAACtH,UAAU;YACjDwH,cAAc,GAAGF,mBAAmB,CAACvH,QAAQ;YAC7C0H,YAAY,GAAGH,mBAAmB,CAACzD,MAAM;UAE7C,CAACsD,cAAc,GAAG9N,KAAK,CAACkC,MAAM,EAAEgF,aAAa,CAACF,KAAK,CAAC8G,cAAc,EAAEzP,kBAAkB,CAAC6P,gBAAgB,CAAC,CAAC;UAEzG,CAACH,cAAc,GAAG/N,KAAK,CAACkC,MAAM,EAAE6E,WAAW,CAACC,KAAK,CAAC+G,cAAc,EAAE1P,kBAAkB,CAAC8P,cAAc,CAAC,CAAC;UAErG,CAACH,eAAe,GAAGhO,KAAK,CAACkC,MAAM,EAAEqJ,SAAS,CAACvE,KAAK,CAACgH,eAAe,EAAE3P,kBAAkB,CAAC+P,YAAY,CAAC,CAAC;UAEnGpO,KAAK,CAACK,QAAQ,CAAC0F,wBAAwB,CAAC,CAAC;UAEzC,IAAI/F,KAAK,CAACqB,UAAU,CAACgM,oBAAoB,CAAC,CAAC,EAAE;YAC3CrN,KAAK,CAACK,QAAQ,CAACiN,kCAAkC,CAAC,CAAC;UACrD;QACF,CAAC,MAAM;UACLe,aAAa,CAACT,UAAU,CAAC;UACzB7N,SAAS,CAAC8J,YAAY,CAAC,KAAK,EAAE8D,kBAAkB,CAAC;UACjD3C,OAAO,CAAC,CAAC;QACX;MACF,CAAC;MAED4C,UAAU,GAAGU,WAAW,CAACT,qBAAqB,EAAE,CAAC,CAAC;IACpD,CAAC,CAAC;EACJ,CAAC,CAAC,CAAC;;EAGH9N,SAAS,CAACwO,gBAAgB,GAAG,YAAY;IACvC,IAAIzD,YAAY,GAAGnJ,SAAS,CAACC,MAAM,GAAG,CAAC,IAAID,SAAS,CAAC,CAAC,CAAC,KAAKE,SAAS,GAAGF,SAAS,CAAC,CAAC,CAAC,GAAG,CAAC;IACxF,OAAO5B,SAAS,CAACsK,iBAAiB,CAACrK,KAAK,CAACsL,IAAI,EAAEtL,KAAK,CAACuK,WAAW,EAAEvK,KAAK,CAACwK,MAAM,EAAEM,YAAY,CAAC;EAC/F,CAAC,CAAC,CAAC;;EAGH/K,SAAS,CAACyO,MAAM,GAAG,UAAUC,KAAK,EAAE;IAClC,IAAIC,eAAe;IAEnB,IAAIC,iBAAiB,GAAG3O,KAAK,CAACkC,MAAM,CAACvD,GAAG,CAAC,QAAQ,EAAE,YAAY,EAAE,UAAU,CAAC;MACxE6L,MAAM,GAAGmE,iBAAiB,CAACnE,MAAM;MACjC7D,UAAU,GAAGgI,iBAAiB,CAAChI,UAAU;MACzCD,QAAQ,GAAGiI,iBAAiB,CAACjI,QAAQ;IAEzC,IAAI4E,IAAI,GAAG,CAAC3E,UAAU,CAAC,CAAC,CAAC,GAAGD,QAAQ,CAAC,CAAC,CAAC,EAAEC,UAAU,CAAC,CAAC,CAAC,GAAGD,QAAQ,CAAC,CAAC,CAAC,EAAEC,UAAU,CAAC,CAAC,CAAC,GAAGD,QAAQ,CAAC,CAAC,CAAC,CAAC;IAClGrH,gBAAgB,CAACuP,eAAe,CAAC,CAAC,CAACJ,MAAM,CAAC7E,MAAM,CAACkF,KAAK,CAACJ,KAAK,CAAC,GAAG,EAAE,GAAGA,KAAK,EAAEnD,IAAI,CAAC,CAACtE,KAAK,CAACwD,MAAM,CAAC;IAE/F,CAACkE,eAAe,GAAG1O,KAAK,CAACkC,MAAM,EAAEqJ,SAAS,CAACvE,KAAK,CAAC0H,eAAe,EAAErQ,kBAAkB,CAACmM,MAAM,CAAC,CAAC;IAE7FxK,KAAK,CAACkC,MAAM,CAACoC,QAAQ,CAAC,CAAC;IACvBtE,KAAK,CAAC0C,iBAAiB,CAACoD,uBAAuB,CAAC,CAAC;IACjD9F,KAAK,CAACe,YAAY,CAAC2E,MAAM,CAAC,CAAC;EAC7B,CAAC,CAAC,CAAC;;EAGH3F,SAAS,CAAC+O,OAAO,GAAG9P,KAAK,CAACgB,KAAK,CAACkC,MAAM,CAACgF,aAAa,EAAElH,KAAK,CAACwB,iBAAiB,CAAC6F,mBAAmB,EAAErH,KAAK,CAACuB,iBAAiB,CAAC8F,mBAAmB,CAAC,CAAC,CAAC;;EAEjJtH,SAAS,CAACgP,MAAM,GAAG/P,KAAK,CAAC,YAAY;IACnCe,SAAS,CAACwE,YAAY,CAAC,IAAI,CAAC;IAC5BvE,KAAK,CAAC0C,iBAAiB,CAACG,UAAU,CAAC,KAAK,CAAC;IACzC7C,KAAK,CAAC0C,iBAAiB,CAACqM,MAAM,CAAC,CAAC;IAChC/O,KAAK,CAACqC,oBAAoB,CAAC0M,MAAM,CAAC,CAAC;IACnC/O,KAAK,CAACsC,mBAAmB,CAACyM,MAAM,CAAC,CAAC;IAClC/O,KAAK,CAACwB,iBAAiB,CAACuN,MAAM,CAAC,CAAC;IAChC/O,KAAK,CAACuB,iBAAiB,CAACwN,MAAM,CAAC,CAAC;IAChC/O,KAAK,CAACW,gBAAgB,CAACoO,MAAM,CAAC,CAAC,CAAC,CAAC;;IAEjC/O,KAAK,CAACqB,UAAU,CAAC0N,MAAM,CAAC,CAAC;IACzB/O,KAAK,CAACK,QAAQ,CAAC0O,MAAM,CAAC,CAAC;IAEvB/O,KAAK,CAACkB,mBAAmB,CAAC6N,MAAM,CAAC,CAAC;IAElC/O,KAAK,CAACe,YAAY,CAACgO,MAAM,CAAC,CAAC;EAC7B,CAAC,EAAEhP,SAAS,CAACgP,MAAM,CAAC,CAAC,CAAC;EACtB;EACA;;EAEAhP,SAAS,CAACwO,gBAAgB,CAAC,CAAC;EAC5BpO,qBAAqB,CAAC,CAAC;AACzB,CAAC,CAAC;AACF;AACA;;AAGA,IAAI6O,cAAc,GAAG;EACnBpJ,eAAe,EAAE,EAAE;EACnBqJ,WAAW,EAAE,MAAM;EACnBvF,iBAAiB,EAAE,CAAC;EACpB7D,wBAAwB,EAAE,IAAI;EAC9BxB,uBAAuB,EAAE,KAAK;EAC9BX,mBAAmB,EAAE,OAAO;EAC5BsG,gBAAgB,EAAE,KAAK;EACvBsB,IAAI,EAAE,CAAC;EACPf,WAAW,EAAE,CAAC;EACdC,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC;AAClB,CAAC,CAAC,CAAC;;AAEH,SAAS0E,MAAMA,CAACnP,SAAS,EAAEC,KAAK,EAAE;EAChC,IAAImP,aAAa,GAAGxN,SAAS,CAACC,MAAM,GAAG,CAAC,IAAID,SAAS,CAAC,CAAC,CAAC,KAAKE,SAAS,GAAGF,SAAS,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;EAC1FsC,MAAM,CAACmL,MAAM,CAACpP,KAAK,EAAEgP,cAAc,EAAEG,aAAa,CAAC;EACnD1Q,GAAG,CAACsB,SAAS,EAAEC,KAAK,CAAC;EACrBtB,MAAM,CAACqB,SAAS,EAAEC,KAAK,EAAE,CAAC,MAAM,EAAE,kBAAkB,CAAC,CAAC;EACtDrB,GAAG,CAACoB,SAAS,EAAEC,KAAK,EAAE,CAAC,mBAAmB,EAAE,QAAQ,EAAE,WAAW,EAAE,kBAAkB,EAAE,YAAY,EAAE,mBAAmB,EAAE,mBAAmB,EAAE,qBAAqB;EAAE;EACtK,qBAAqB,EAAE,yBAAyB,EAAE,UAAU,EAAE,cAAc,EAAE,iBAAiB,EAAE,sBAAsB,CAAC,CAAC;EACzHpB,eAAe,CAACmB,SAAS,EAAEC,KAAK,EAAE,CAAC,oBAAoB,CAAC,CAAC;EACzDnB,KAAK,CAACkB,SAAS,EAAEC,KAAK,EAAE,QAAQ,CAAC,CAAC,CAAC;;EAEnCF,YAAY,CAACC,SAAS,EAAEC,KAAK,CAAC,CAAC,CAAC;;EAEhClB,KAAK,CAACiB,SAAS,EAAEC,KAAK,CAAC;EACvBjB,oBAAoB,CAACgB,SAAS,EAAEC,KAAK,EAAE;IACrCqP,yBAAyB,EAAE;MACzBC,QAAQ,EAAE,mBAAmB;MAC7BC,QAAQ,EAAE;IACZ,CAAC;IACDC,qBAAqB,EAAE;MACrBF,QAAQ,EAAE,mBAAmB;MAC7BC,QAAQ,EAAE;IACZ,CAAC;IACDE,mBAAmB,EAAE;MACnBH,QAAQ,EAAE,mBAAmB;MAC7BC,QAAQ,EAAE;IACZ,CAAC;IACDnB,YAAY,EAAE;MACZkB,QAAQ,EAAE,QAAQ;MAClBC,QAAQ,EAAE,QAAQ;MAClBjL,QAAQ,EAAE;IACZ,CAAC;IACD6J,cAAc,EAAE;MACdmB,QAAQ,EAAE,QAAQ;MAClBC,QAAQ,EAAE,UAAU;MACpBjL,QAAQ,EAAE;IACZ,CAAC;IACD4J,gBAAgB,EAAE;MAChBoB,QAAQ,EAAE,QAAQ;MAClBC,QAAQ,EAAE,YAAY;MACtBjL,QAAQ,EAAE;IACZ;EACF,CAAC,CAAC;AACJ,CAAC,CAAC;;AAGF,IAAI/F,WAAW,GAAGC,aAAa,CAAC0Q,MAAM,EAAE,cAAc,CAAC,CAAC,CAAC;;AAEzD,IAAIQ,cAAc,GAAG;EACnBnR,WAAW,EAAEA,WAAW;EACxB2Q,MAAM,EAAEA;AACV,CAAC;AAED,SAASQ,cAAc,IAAIC,OAAO,EAAEpR,WAAW"},"metadata":{},"sourceType":"module","externalDependencies":[]}