{"ast":null,"code":"import _toConsumableArray from '@babel/runtime/helpers/toConsumableArray';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport macro from '../../macros.js';\nimport { A as degreesFromRadians } from '../../Common/Core/Math/index.js';\nimport Constants from './RenderWindowInteractor/Constants.js';\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n  return keys;\n}\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n  return target;\n}\nvar Device = Constants.Device,\n  Input = Constants.Input;\nvar vtkWarningMacro = macro.vtkWarningMacro,\n  vtkErrorMacro = macro.vtkErrorMacro,\n  normalizeWheel = macro.normalizeWheel,\n  vtkOnceErrorMacro = macro.vtkOnceErrorMacro; // ----------------------------------------------------------------------------\n// Global methods\n// ----------------------------------------------------------------------------\n\nvar EMPTY_MOUSE_EVENT = new MouseEvent('');\nvar deviceInputMap = {\n  'xr-standard': [Input.Trigger, Input.Grip, Input.TrackPad, Input.Thumbstick, Input.A, Input.B]\n};\nvar handledEvents = ['StartAnimation', 'Animation', 'EndAnimation', 'PointerEnter', 'PointerLeave', 'MouseEnter', 'MouseLeave', 'StartMouseMove', 'MouseMove', 'EndMouseMove', 'LeftButtonPress', 'LeftButtonRelease', 'MiddleButtonPress', 'MiddleButtonRelease', 'RightButtonPress', 'RightButtonRelease', 'KeyPress', 'KeyDown', 'KeyUp', 'StartMouseWheel', 'MouseWheel', 'EndMouseWheel', 'StartPinch', 'Pinch', 'EndPinch', 'StartPan', 'Pan', 'EndPan', 'StartRotate', 'Rotate', 'EndRotate', 'Button3D', 'Move3D', 'StartPointerLock', 'EndPointerLock', 'StartInteraction', 'Interaction', 'EndInteraction', 'AnimationFrameRateUpdate'];\nfunction preventDefault(event) {\n  if (event.cancelable) {\n    event.preventDefault();\n  }\n}\nfunction pointerCacheToPositions(cache) {\n  var positions = Object.create(null);\n  cache.forEach(function (_ref) {\n    var pointerId = _ref.pointerId,\n      position = _ref.position;\n    positions[pointerId] = position;\n  });\n  return positions;\n} // ----------------------------------------------------------------------------\n// vtkRenderWindowInteractor methods\n// ----------------------------------------------------------------------------\n\nfunction vtkRenderWindowInteractor(publicAPI, model) {\n  // Set our className\n  model.classHierarchy.push('vtkRenderWindowInteractor'); // Initialize list of requesters\n\n  var animationRequesters = new Set(); // map from pointerId to { pointerId: number, position: [x, y] }\n\n  var pointerCache = new Map(); // Factor to apply on wheel spin.\n\n  var wheelCoefficient = 1; // Public API methods\n  //----------------------------------------------------------------------\n\n  publicAPI.start = function () {\n    // Let the compositing handle the event loop if it wants to.\n    // if (publicAPI.HasObserver(vtkCommand::StartEvent) && !publicAPI.HandleEventLoop) {\n    //   publicAPI.invokeEvent({ type: 'StartEvent' });\n    //   return;\n    // }\n    // As a convenience, initialize if we aren't initialized yet.\n    if (!model.initialized) {\n      publicAPI.initialize();\n      if (!model.initialized) {\n        return;\n      }\n    } // Pass execution to the subclass which will run the event loop,\n    // this will not return until TerminateApp is called.\n\n    publicAPI.startEventLoop();\n  }; //----------------------------------------------------------------------\n\n  publicAPI.setRenderWindow = function (aren) {\n    vtkErrorMacro('you want to call setView(view) instead of setRenderWindow on a vtk.js interactor');\n  }; //----------------------------------------------------------------------\n\n  publicAPI.setInteractorStyle = function (style) {\n    if (model.interactorStyle !== style) {\n      if (model.interactorStyle != null) {\n        model.interactorStyle.setInteractor(null);\n      }\n      model.interactorStyle = style;\n      if (model.interactorStyle != null) {\n        if (model.interactorStyle.getInteractor() !== publicAPI) {\n          model.interactorStyle.setInteractor(publicAPI);\n        }\n      }\n    }\n  }; //---------------------------------------------------------------------\n\n  publicAPI.initialize = function () {\n    model.initialized = true;\n    publicAPI.enable();\n    publicAPI.render();\n  };\n  publicAPI.enable = function () {\n    return publicAPI.setEnabled(true);\n  };\n  publicAPI.disable = function () {\n    return publicAPI.setEnabled(false);\n  };\n  publicAPI.startEventLoop = function () {\n    return vtkWarningMacro('empty event loop');\n  };\n  function updateCurrentRenderer(x, y) {\n    if (!model._forcedRenderer) {\n      model.currentRenderer = publicAPI.findPokedRenderer(x, y);\n    }\n  }\n  publicAPI.getCurrentRenderer = function () {\n    if (model.currentRenderer) {\n      return model.currentRenderer;\n    }\n    updateCurrentRenderer(0, 0);\n    return model.currentRenderer;\n  };\n  function getScreenEventPositionFor(source) {\n    var canvas = model._view.getCanvas();\n    var bounds = canvas.getBoundingClientRect();\n    var scaleX = canvas.width / bounds.width;\n    var scaleY = canvas.height / bounds.height;\n    var position = {\n      x: scaleX * (source.clientX - bounds.left),\n      y: scaleY * (bounds.height - source.clientY + bounds.top),\n      z: 0\n    }; // if multitouch, do not update the current renderer\n\n    if (pointerCache.size <= 1 || !model.currentRenderer) {\n      updateCurrentRenderer(position.x, position.y);\n    }\n    return position;\n  }\n  function getModifierKeysFor(event) {\n    return {\n      controlKey: event.ctrlKey,\n      altKey: event.altKey,\n      shiftKey: event.shiftKey\n    };\n  }\n  function getKeysFor(event) {\n    var modifierKeys = getModifierKeysFor(event);\n    var keys = _objectSpread({\n      key: event.key,\n      keyCode: event.charCode\n    }, modifierKeys);\n    return keys;\n  }\n  function getDeviceTypeFor(event) {\n    return event.pointerType || '';\n  }\n  publicAPI.bindEvents = function (container) {\n    model.container = container;\n    container.addEventListener('contextmenu', preventDefault);\n    container.addEventListener('wheel', publicAPI.handleWheel);\n    container.addEventListener('DOMMouseScroll', publicAPI.handleWheel);\n    container.addEventListener('pointerenter', publicAPI.handlePointerEnter);\n    container.addEventListener('pointerleave', publicAPI.handlePointerLeave);\n    container.addEventListener('pointermove', publicAPI.handlePointerMove, {\n      passive: false\n    });\n    container.addEventListener('pointerdown', publicAPI.handlePointerDown, {\n      passive: false\n    });\n    container.addEventListener('pointerup', publicAPI.handlePointerUp);\n    container.addEventListener('pointercancel', publicAPI.handlePointerCancel);\n    document.addEventListener('keypress', publicAPI.handleKeyPress);\n    document.addEventListener('keydown', publicAPI.handleKeyDown);\n    document.addEventListener('keyup', publicAPI.handleKeyUp);\n    document.addEventListener('pointerlockchange', publicAPI.handlePointerLockChange); // using touchAction is more performant than preventDefault\n    // in a touchstart handler.\n\n    container.style.touchAction = 'none';\n    container.style.userSelect = 'none'; // disables tap highlight for when cursor is pointer\n\n    container.style.webkitTapHighlightColor = 'rgba(0,0,0,0)';\n  };\n  publicAPI.unbindEvents = function () {\n    var container = model.container;\n    container.removeEventListener('contextmenu', preventDefault);\n    container.removeEventListener('wheel', publicAPI.handleWheel);\n    container.removeEventListener('DOMMouseScroll', publicAPI.handleWheel);\n    container.removeEventListener('pointerenter', publicAPI.handlePointerEnter);\n    container.removeEventListener('pointerleave', publicAPI.handlePointerLeave);\n    container.removeEventListener('pointermove', publicAPI.handlePointerMove, {\n      passive: false\n    });\n    container.removeEventListener('pointerdown', publicAPI.handlePointerDown, {\n      passive: false\n    });\n    container.removeEventListener('pointerup', publicAPI.handlePointerUp);\n    container.removeEventListener('pointercancel', publicAPI.handlePointerCancel);\n    document.removeEventListener('keypress', publicAPI.handleKeyPress);\n    document.removeEventListener('keydown', publicAPI.handleKeyDown);\n    document.removeEventListener('keyup', publicAPI.handleKeyUp);\n    document.removeEventListener('pointerlockchange', publicAPI.handlePointerLockChange);\n    model.container = null;\n    pointerCache.clear();\n  };\n  publicAPI.handleKeyPress = function (event) {\n    var data = getKeysFor(event);\n    publicAPI.keyPressEvent(data);\n  };\n  publicAPI.handleKeyDown = function (event) {\n    var data = getKeysFor(event);\n    publicAPI.keyDownEvent(data);\n  };\n  publicAPI.handleKeyUp = function (event) {\n    var data = getKeysFor(event);\n    publicAPI.keyUpEvent(data);\n  };\n  publicAPI.handlePointerEnter = function (event) {\n    var callData = _objectSpread(_objectSpread({}, getModifierKeysFor(event)), {}, {\n      position: getScreenEventPositionFor(event),\n      deviceType: getDeviceTypeFor(event)\n    });\n    publicAPI.pointerEnterEvent(callData);\n    if (callData.deviceType === 'mouse') {\n      publicAPI.mouseEnterEvent(callData);\n    }\n  };\n  publicAPI.handlePointerLeave = function (event) {\n    var callData = _objectSpread(_objectSpread({}, getModifierKeysFor(event)), {}, {\n      position: getScreenEventPositionFor(event),\n      deviceType: getDeviceTypeFor(event)\n    });\n    publicAPI.pointerLeaveEvent(callData);\n    if (callData.deviceType === 'mouse') {\n      publicAPI.mouseLeaveEvent(callData);\n    }\n  };\n  publicAPI.handlePointerDown = function (event) {\n    if (event.button > 2 || publicAPI.isPointerLocked()) {\n      // ignore events from extra mouse buttons such as `back` and `forward`\n      return;\n    }\n    if (model.preventDefaultOnPointerDown) {\n      preventDefault(event);\n    }\n    if (event.target.hasPointerCapture(event.pointerId)) {\n      event.target.releasePointerCapture(event.pointerId);\n    }\n    model.container.setPointerCapture(event.pointerId);\n    if (pointerCache.has(event.pointerId)) {\n      vtkWarningMacro('[RenderWindowInteractor] duplicate pointerId detected');\n    }\n    pointerCache.set(event.pointerId, {\n      pointerId: event.pointerId,\n      position: getScreenEventPositionFor(event)\n    });\n    switch (event.pointerType) {\n      case 'pen':\n      case 'touch':\n        publicAPI.handleTouchStart(event);\n        break;\n      case 'mouse':\n      default:\n        publicAPI.handleMouseDown(event);\n        break;\n    }\n  };\n  publicAPI.handlePointerUp = function (event) {\n    if (pointerCache.has(event.pointerId)) {\n      if (model.preventDefaultOnPointerUp) {\n        preventDefault(event);\n      }\n      pointerCache.delete(event.pointerId);\n      model.container.releasePointerCapture(event.pointerId);\n      switch (event.pointerType) {\n        case 'pen':\n        case 'touch':\n          publicAPI.handleTouchEnd(event);\n          break;\n        case 'mouse':\n        default:\n          publicAPI.handleMouseUp(event);\n          break;\n      }\n    }\n  };\n  publicAPI.handlePointerCancel = function (event) {\n    if (pointerCache.has(event.pointerId)) {\n      pointerCache.delete(event.pointerId);\n      switch (event.pointerType) {\n        case 'pen':\n        case 'touch':\n          publicAPI.handleTouchEnd(event);\n          break;\n        case 'mouse':\n        default:\n          publicAPI.handleMouseUp(event);\n          break;\n      }\n    }\n  };\n  publicAPI.handlePointerMove = function (event) {\n    if (pointerCache.has(event.pointerId)) {\n      var pointer = pointerCache.get(event.pointerId);\n      pointer.position = getScreenEventPositionFor(event);\n    }\n    switch (event.pointerType) {\n      case 'pen':\n      case 'touch':\n        publicAPI.handleTouchMove(event);\n        break;\n      case 'mouse':\n      default:\n        publicAPI.handleMouseMove(event);\n        break;\n    }\n  };\n  publicAPI.handleMouseDown = function (event) {\n    var callData = _objectSpread(_objectSpread({}, getModifierKeysFor(event)), {}, {\n      position: getScreenEventPositionFor(event),\n      deviceType: getDeviceTypeFor(event)\n    });\n    switch (event.button) {\n      case 0:\n        publicAPI.leftButtonPressEvent(callData);\n        break;\n      case 1:\n        publicAPI.middleButtonPressEvent(callData);\n        break;\n      case 2:\n        publicAPI.rightButtonPressEvent(callData);\n        break;\n      default:\n        vtkErrorMacro(\"Unknown mouse button pressed: \".concat(event.button));\n        break;\n    }\n  }; //----------------------------------------------------------------------\n\n  publicAPI.requestPointerLock = function () {\n    if (model.container) {\n      model.container.requestPointerLock();\n    }\n  }; //----------------------------------------------------------------------\n\n  publicAPI.exitPointerLock = function () {\n    var _document$exitPointer, _document;\n    return (_document$exitPointer = (_document = document).exitPointerLock) === null || _document$exitPointer === void 0 ? void 0 : _document$exitPointer.call(_document);\n  }; //----------------------------------------------------------------------\n\n  publicAPI.isPointerLocked = function () {\n    return !!model.container && document.pointerLockElement === model.container;\n  }; //----------------------------------------------------------------------\n\n  publicAPI.handlePointerLockChange = function () {\n    if (publicAPI.isPointerLocked()) {\n      publicAPI.startPointerLockEvent();\n    } else {\n      publicAPI.endPointerLockEvent();\n    }\n  }; //----------------------------------------------------------------------\n\n  function forceRender() {\n    if (model._view && model.enabled && model.enableRender) {\n      model.inRender = true;\n      model._view.traverseAllPasses();\n      model.inRender = false;\n    } // outside the above test so that third-party code can redirect\n    // the render to the appropriate class\n\n    publicAPI.invokeRenderEvent();\n  }\n  publicAPI.requestAnimation = function (requestor) {\n    if (requestor === undefined) {\n      vtkErrorMacro(\"undefined requester, can not start animating\");\n      return;\n    }\n    if (animationRequesters.has(requestor)) {\n      vtkWarningMacro(\"requester is already registered for animating\");\n      return;\n    }\n    animationRequesters.add(requestor);\n    if (!model.animationRequest && animationRequesters.size === 1 && !model.xrAnimation) {\n      model._animationStartTime = Date.now();\n      model._animationFrameCount = 0;\n      model.animationRequest = requestAnimationFrame(publicAPI.handleAnimation);\n      publicAPI.startAnimationEvent();\n    }\n  }; // continue animating for at least the specified duration of\n  // milliseconds.\n\n  publicAPI.extendAnimation = function (duration) {\n    var newEnd = Date.now() + duration;\n    model._animationExtendedEnd = Math.max(model._animationExtendedEnd, newEnd);\n    if (!model.animationRequest && animationRequesters.size === 0 && !model.xrAnimation) {\n      model._animationStartTime = Date.now();\n      model._animationFrameCount = 0;\n      model.animationRequest = requestAnimationFrame(publicAPI.handleAnimation);\n      publicAPI.startAnimationEvent();\n    }\n  };\n  publicAPI.isAnimating = function () {\n    return model.xrAnimation || model.animationRequest !== null;\n  };\n  publicAPI.cancelAnimation = function (requestor) {\n    var skipWarning = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    if (!animationRequesters.has(requestor)) {\n      if (!skipWarning) {\n        var requestStr = requestor && requestor.getClassName ? requestor.getClassName() : requestor;\n        vtkWarningMacro(\"\".concat(requestStr, \" did not request an animation\"));\n      }\n      return;\n    }\n    animationRequesters.delete(requestor);\n    if (model.animationRequest && animationRequesters.size === 0 && Date.now() > model._animationExtendedEnd) {\n      cancelAnimationFrame(model.animationRequest);\n      model.animationRequest = null;\n      publicAPI.endAnimationEvent();\n      publicAPI.render();\n    }\n  };\n  publicAPI.switchToXRAnimation = function () {\n    // cancel existing animation if any\n    if (model.animationRequest) {\n      cancelAnimationFrame(model.animationRequest);\n      model.animationRequest = null;\n    }\n    model.xrAnimation = true;\n  };\n  publicAPI.returnFromXRAnimation = function () {\n    model.xrAnimation = false;\n    if (animationRequesters.size !== 0) {\n      model.recentAnimationFrameRate = 10.0;\n      model.animationRequest = requestAnimationFrame(publicAPI.handleAnimation);\n    }\n  };\n  publicAPI.updateXRGamepads = function (xrSession, xrFrame, xrRefSpace) {\n    // watch for when buttons change state and fire events\n    xrSession.inputSources.forEach(function (inputSource) {\n      var gripPose = inputSource.gripSpace == null ? null : xrFrame.getPose(inputSource.gripSpace, xrRefSpace);\n      var gp = inputSource.gamepad;\n      var hand = inputSource.handedness;\n      if (gp) {\n        if (!(gp.index in model.lastGamepadValues)) {\n          model.lastGamepadValues[gp.index] = {\n            left: {\n              buttons: {}\n            },\n            right: {\n              buttons: {}\n            },\n            none: {\n              buttons: {}\n            }\n          };\n        }\n        for (var b = 0; b < gp.buttons.length; ++b) {\n          if (!(b in model.lastGamepadValues[gp.index][hand].buttons)) {\n            model.lastGamepadValues[gp.index][hand].buttons[b] = false;\n          }\n          if (model.lastGamepadValues[gp.index][hand].buttons[b] !== gp.buttons[b].pressed && gripPose != null) {\n            publicAPI.button3DEvent({\n              gamepad: gp,\n              position: gripPose.transform.position,\n              orientation: gripPose.transform.orientation,\n              pressed: gp.buttons[b].pressed,\n              device: inputSource.handedness === 'left' ? Device.LeftController : Device.RightController,\n              input: deviceInputMap[gp.mapping] && deviceInputMap[gp.mapping][b] ? deviceInputMap[gp.mapping][b] : Input.Trigger\n            });\n            model.lastGamepadValues[gp.index][hand].buttons[b] = gp.buttons[b].pressed;\n          }\n          if (model.lastGamepadValues[gp.index][hand].buttons[b] && gripPose != null) {\n            publicAPI.move3DEvent({\n              gamepad: gp,\n              position: gripPose.transform.position,\n              orientation: gripPose.transform.orientation,\n              device: inputSource.handedness === 'left' ? Device.LeftController : Device.RightController\n            });\n          }\n        }\n      }\n    });\n  };\n  publicAPI.handleMouseMove = function (event) {\n    var callData = _objectSpread(_objectSpread({}, getModifierKeysFor(event)), {}, {\n      position: getScreenEventPositionFor(event),\n      deviceType: getDeviceTypeFor(event)\n    });\n    if (model.moveTimeoutID === 0) {\n      publicAPI.startMouseMoveEvent(callData);\n    } else {\n      publicAPI.mouseMoveEvent(callData);\n      clearTimeout(model.moveTimeoutID);\n    } // start a timer to keep us animating while we get mouse move events\n\n    model.moveTimeoutID = setTimeout(function () {\n      publicAPI.endMouseMoveEvent();\n      model.moveTimeoutID = 0;\n    }, 200);\n  };\n  publicAPI.handleAnimation = function () {\n    var currTime = Date.now();\n    model._animationFrameCount++;\n    if (currTime - model._animationStartTime > 1000.0 && model._animationFrameCount > 1) {\n      model.recentAnimationFrameRate = 1000.0 * (model._animationFrameCount - 1) / (currTime - model._animationStartTime);\n      model.lastFrameTime = 1.0 / model.recentAnimationFrameRate;\n      publicAPI.animationFrameRateUpdateEvent();\n      model._animationStartTime = currTime;\n      model._animationFrameCount = 1;\n    }\n    publicAPI.animationEvent();\n    forceRender();\n    if (animationRequesters.size > 0 || Date.now() < model._animationExtendedEnd) {\n      model.animationRequest = requestAnimationFrame(publicAPI.handleAnimation);\n    } else {\n      cancelAnimationFrame(model.animationRequest);\n      model.animationRequest = null;\n      publicAPI.endAnimationEvent();\n      publicAPI.render();\n    }\n  };\n  publicAPI.handleWheel = function (event) {\n    preventDefault(event);\n    /**\n     * wheel event values can vary significantly across browsers, platforms\n     * and devices [1]. `normalizeWheel` uses facebook's solution from their\n     * fixed-data-table repository [2].\n     *\n     * [1] https://developer.mozilla.org/en-US/docs/Web/Events/mousewheel\n     * [2] https://github.com/facebookarchive/fixed-data-table/blob/master/src/vendor_upstream/dom/normalizeWheel.js\n     *\n     * This code will return an object with properties:\n     *\n     *   spinX   -- normalized spin speed (use for zoom) - x plane\n     *   spinY   -- \" - y plane\n     *   pixelX  -- normalized distance (to pixels) - x plane\n     *   pixelY  -- \" - y plane\n     *\n     */\n\n    var callData = _objectSpread(_objectSpread(_objectSpread({}, normalizeWheel(event)), getModifierKeysFor(event)), {}, {\n      position: getScreenEventPositionFor(event),\n      deviceType: getDeviceTypeFor(event)\n    }); // Wheel events are thought to scroll pages (i.e. multiple lines at once).\n    // See normalizeWheel() documentation for more context.\n    // While trackpad wheel events are many small (<1) wheel spins,\n    // mouse wheel events have absolute spin values higher than 1.\n    // Here the first spin value is \"recorded\", and used to normalize\n    // all the following mouse wheel events.\n\n    if (model.wheelTimeoutID === 0) {\n      // we attempt to distinguish between trackpads and mice\n      // .3 will be larger than the first trackpad event,\n      // but small enough to detect some common edge case mice\n      if (Math.abs(callData.spinY) >= 0.3) {\n        // Event is coming from mouse wheel\n        wheelCoefficient = Math.abs(callData.spinY);\n      } else {\n        // Event is coming from trackpad\n        wheelCoefficient = 1;\n      }\n    }\n    callData.spinY /= wheelCoefficient;\n    if (model.wheelTimeoutID === 0) {\n      publicAPI.startMouseWheelEvent(callData);\n      publicAPI.mouseWheelEvent(callData);\n    } else {\n      publicAPI.mouseWheelEvent(callData);\n      clearTimeout(model.wheelTimeoutID);\n    }\n    if (model.mouseScrollDebounceByPass) {\n      publicAPI.extendAnimation(600);\n      publicAPI.endMouseWheelEvent();\n      model.wheelTimeoutID = 0;\n    } else {\n      // start a timer to keep us animating while we get wheel events\n      model.wheelTimeoutID = setTimeout(function () {\n        publicAPI.extendAnimation(600);\n        publicAPI.endMouseWheelEvent();\n        model.wheelTimeoutID = 0;\n      }, 200);\n    }\n  };\n  publicAPI.handleMouseUp = function (event) {\n    var callData = _objectSpread(_objectSpread({}, getModifierKeysFor(event)), {}, {\n      position: getScreenEventPositionFor(event),\n      deviceType: getDeviceTypeFor(event)\n    });\n    switch (event.button) {\n      case 0:\n        publicAPI.leftButtonReleaseEvent(callData);\n        break;\n      case 1:\n        publicAPI.middleButtonReleaseEvent(callData);\n        break;\n      case 2:\n        publicAPI.rightButtonReleaseEvent(callData);\n        break;\n      default:\n        vtkErrorMacro(\"Unknown mouse button released: \".concat(event.button));\n        break;\n    }\n  };\n  publicAPI.handleTouchStart = function (event) {\n    var pointers = _toConsumableArray(pointerCache.values()); // If multitouch\n\n    if (model.recognizeGestures && pointers.length > 1) {\n      var positions = pointerCacheToPositions(pointerCache); // did we just transition to multitouch?\n\n      if (pointers.length === 2) {\n        var callData = _objectSpread(_objectSpread({}, getModifierKeysFor(EMPTY_MOUSE_EVENT)), {}, {\n          position: pointers[0].position,\n          deviceType: getDeviceTypeFor(event)\n        });\n        publicAPI.leftButtonReleaseEvent(callData);\n      } // handle the gesture\n\n      publicAPI.recognizeGesture('TouchStart', positions);\n    } else if (pointers.length === 1) {\n      var _callData = _objectSpread(_objectSpread({}, getModifierKeysFor(EMPTY_MOUSE_EVENT)), {}, {\n        position: getScreenEventPositionFor(event),\n        deviceType: getDeviceTypeFor(event)\n      });\n      publicAPI.leftButtonPressEvent(_callData);\n    }\n  };\n  publicAPI.handleTouchMove = function (event) {\n    var pointers = _toConsumableArray(pointerCache.values());\n    if (model.recognizeGestures && pointers.length > 1) {\n      var positions = pointerCacheToPositions(pointerCache);\n      publicAPI.recognizeGesture('TouchMove', positions);\n    } else if (pointers.length === 1) {\n      var callData = _objectSpread(_objectSpread({}, getModifierKeysFor(EMPTY_MOUSE_EVENT)), {}, {\n        position: pointers[0].position,\n        deviceType: getDeviceTypeFor(event)\n      });\n      publicAPI.mouseMoveEvent(callData);\n    }\n  };\n  publicAPI.handleTouchEnd = function (event) {\n    var pointers = _toConsumableArray(pointerCache.values());\n    if (model.recognizeGestures) {\n      // No more fingers down\n      if (pointers.length === 0) {\n        var callData = _objectSpread(_objectSpread({}, getModifierKeysFor(EMPTY_MOUSE_EVENT)), {}, {\n          position: getScreenEventPositionFor(event),\n          deviceType: getDeviceTypeFor(event)\n        });\n        publicAPI.leftButtonReleaseEvent(callData);\n      } else if (pointers.length === 1) {\n        // If one finger left, end touch and start button press\n        var positions = pointerCacheToPositions(pointerCache);\n        publicAPI.recognizeGesture('TouchEnd', positions);\n        var _callData2 = _objectSpread(_objectSpread({}, getModifierKeysFor(EMPTY_MOUSE_EVENT)), {}, {\n          position: pointers[0].position,\n          deviceType: getDeviceTypeFor(event)\n        });\n        publicAPI.leftButtonPressEvent(_callData2);\n      } else {\n        // If more than one finger left, keep touch move\n        var _positions = pointerCacheToPositions(pointerCache);\n        publicAPI.recognizeGesture('TouchMove', _positions);\n      }\n    } else if (pointers.length === 1) {\n      var _callData3 = _objectSpread(_objectSpread({}, getModifierKeysFor(EMPTY_MOUSE_EVENT)), {}, {\n        position: pointers[0].position,\n        deviceType: getDeviceTypeFor(event)\n      });\n      publicAPI.leftButtonReleaseEvent(_callData3);\n    }\n  };\n  publicAPI.setView = function (val) {\n    if (model._view === val) {\n      return;\n    }\n    model._view = val;\n    model._view.getRenderable().setInteractor(publicAPI);\n    publicAPI.modified();\n  };\n  publicAPI.getFirstRenderer = function () {\n    var _model$_view, _model$_view$getRende, _model$_view$getRende2;\n    return (_model$_view = model._view) === null || _model$_view === void 0 ? void 0 : (_model$_view$getRende = _model$_view.getRenderable()) === null || _model$_view$getRende === void 0 ? void 0 : (_model$_view$getRende2 = _model$_view$getRende.getRenderersByReference()) === null || _model$_view$getRende2 === void 0 ? void 0 : _model$_view$getRende2[0];\n  };\n  publicAPI.findPokedRenderer = function () {\n    var _model$_view2, _model$_view2$getRend;\n    var x = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    if (!model._view) {\n      return null;\n    } // The original order of renderers needs to remain as\n    // the first one is the one we want to manipulate the camera on.\n\n    var rc = (_model$_view2 = model._view) === null || _model$_view2 === void 0 ? void 0 : (_model$_view2$getRend = _model$_view2.getRenderable()) === null || _model$_view2$getRend === void 0 ? void 0 : _model$_view2$getRend.getRenderers();\n    if (!rc || rc.length === 0) {\n      return null;\n    }\n    rc.sort(function (a, b) {\n      return a.getLayer() - b.getLayer();\n    });\n    var interactiveren = null;\n    var viewportren = null;\n    var currentRenderer = null;\n    var count = rc.length;\n    while (count--) {\n      var aren = rc[count];\n      if (model._view.isInViewport(x, y, aren) && aren.getInteractive()) {\n        currentRenderer = aren;\n        break;\n      }\n      if (interactiveren === null && aren.getInteractive()) {\n        // Save this renderer in case we can't find one in the viewport that\n        // is interactive.\n        interactiveren = aren;\n      }\n      if (viewportren === null && model._view.isInViewport(x, y, aren)) {\n        // Save this renderer in case we can't find one in the viewport that\n        // is interactive.\n        viewportren = aren;\n      }\n    } // We must have a value.  If we found an interactive renderer before, that's\n    // better than a non-interactive renderer.\n\n    if (currentRenderer === null) {\n      currentRenderer = interactiveren;\n    } // We must have a value.  If we found a renderer that is in the viewport,\n    // that is better than any old viewport (but not as good as an interactive\n    // one).\n\n    if (currentRenderer === null) {\n      currentRenderer = viewportren;\n    } // We must have a value - take anything.\n\n    if (currentRenderer == null) {\n      currentRenderer = rc[0];\n    }\n    return currentRenderer;\n  }; // only render if we are not animating. If we are animating\n  // then renders will happen naturally anyhow and we definitely\n  // do not want extra renders as the make the apparent interaction\n  // rate slower.\n\n  publicAPI.render = function () {\n    if (!publicAPI.isAnimating() && !model.inRender) {\n      forceRender();\n    }\n  }; // create the generic Event methods\n\n  handledEvents.forEach(function (eventName) {\n    var lowerFirst = eventName.charAt(0).toLowerCase() + eventName.slice(1);\n    publicAPI[\"\".concat(lowerFirst, \"Event\")] = function (arg) {\n      // Check that interactor enabled\n      if (!model.enabled) {\n        return;\n      } // Check that a poked renderer exists\n\n      var renderer = publicAPI.getCurrentRenderer();\n      if (!renderer) {\n        vtkOnceErrorMacro(\"\\n          Can not forward events without a current renderer on the interactor.\\n        \");\n        return;\n      } // Pass the eventName and the poked renderer\n\n      var callData = _objectSpread({\n        type: eventName,\n        pokedRenderer: model.currentRenderer,\n        firstRenderer: publicAPI.getFirstRenderer()\n      }, arg); // Call invoke\n\n      publicAPI[\"invoke\".concat(eventName)](callData);\n    };\n  }); // we know we are in multitouch now, so start recognizing\n\n  publicAPI.recognizeGesture = function (event, positions) {\n    // more than two pointers we ignore\n    if (Object.keys(positions).length > 2) {\n      return;\n    }\n    if (!model.startingEventPositions) {\n      model.startingEventPositions = {};\n    } // store the initial positions\n\n    if (event === 'TouchStart') {\n      Object.keys(positions).forEach(function (key) {\n        model.startingEventPositions[key] = positions[key];\n      }); // we do not know what the gesture is yet\n\n      model.currentGesture = 'Start';\n      return;\n    } // end the gesture if needed\n\n    if (event === 'TouchEnd') {\n      if (model.currentGesture === 'Pinch') {\n        publicAPI.render();\n        publicAPI.endPinchEvent();\n      }\n      if (model.currentGesture === 'Rotate') {\n        publicAPI.render();\n        publicAPI.endRotateEvent();\n      }\n      if (model.currentGesture === 'Pan') {\n        publicAPI.render();\n        publicAPI.endPanEvent();\n      }\n      model.currentGesture = 'Start';\n      model.startingEventPositions = {};\n      return;\n    } // what are the two pointers we are working with\n\n    var count = 0;\n    var posVals = [];\n    var startVals = [];\n    Object.keys(positions).forEach(function (key) {\n      posVals[count] = positions[key];\n      startVals[count] = model.startingEventPositions[key];\n      count++;\n    }); // The meat of the algorithm\n    // on move events we analyze them to determine what type\n    // of movement it is and then deal with it.\n    // calculate the distances\n\n    var originalDistance = Math.sqrt((startVals[0].x - startVals[1].x) * (startVals[0].x - startVals[1].x) + (startVals[0].y - startVals[1].y) * (startVals[0].y - startVals[1].y));\n    var newDistance = Math.sqrt((posVals[0].x - posVals[1].x) * (posVals[0].x - posVals[1].x) + (posVals[0].y - posVals[1].y) * (posVals[0].y - posVals[1].y)); // calculate rotations\n\n    var originalAngle = degreesFromRadians(Math.atan2(startVals[1].y - startVals[0].y, startVals[1].x - startVals[0].x));\n    var newAngle = degreesFromRadians(Math.atan2(posVals[1].y - posVals[0].y, posVals[1].x - posVals[0].x)); // angles are cyclic so watch for that, 1 and 359 are only 2 apart :)\n\n    var angleDeviation = newAngle - originalAngle;\n    newAngle = newAngle + 180.0 >= 360.0 ? newAngle - 180.0 : newAngle + 180.0;\n    originalAngle = originalAngle + 180.0 >= 360.0 ? originalAngle - 180.0 : originalAngle + 180.0;\n    if (Math.abs(newAngle - originalAngle) < Math.abs(angleDeviation)) {\n      angleDeviation = newAngle - originalAngle;\n    } // calculate the translations\n\n    var trans = [];\n    trans[0] = (posVals[0].x - startVals[0].x + posVals[1].x - startVals[1].x) / 2.0;\n    trans[1] = (posVals[0].y - startVals[0].y + posVals[1].y - startVals[1].y) / 2.0;\n    if (event === 'TouchMove') {\n      // OK we want to\n      // - immediately respond to the user\n      // - allow the user to zoom without panning (saves focal point)\n      // - allow the user to rotate without panning (saves focal point)\n      // do we know what gesture we are doing yet? If not\n      // see if we can figure it out\n      if (model.currentGesture === 'Start') {\n        // pinch is a move to/from the center point\n        // rotate is a move along the circumference\n        // pan is a move of the center point\n        // compute the distance along each of these axes in pixels\n        // the first to break thresh wins\n        var thresh = 0.01 * Math.sqrt(model.container.clientWidth * model.container.clientWidth + model.container.clientHeight * model.container.clientHeight);\n        if (thresh < 15.0) {\n          thresh = 15.0;\n        }\n        var pinchDistance = Math.abs(newDistance - originalDistance);\n        var rotateDistance = newDistance * 3.1415926 * Math.abs(angleDeviation) / 360.0;\n        var panDistance = Math.sqrt(trans[0] * trans[0] + trans[1] * trans[1]);\n        if (pinchDistance > thresh && pinchDistance > rotateDistance && pinchDistance > panDistance) {\n          model.currentGesture = 'Pinch';\n          var callData = {\n            scale: 1.0,\n            touches: positions\n          };\n          publicAPI.startPinchEvent(callData);\n        } else if (rotateDistance > thresh && rotateDistance > panDistance) {\n          model.currentGesture = 'Rotate';\n          var _callData4 = {\n            rotation: 0.0,\n            touches: positions\n          };\n          publicAPI.startRotateEvent(_callData4);\n        } else if (panDistance > thresh) {\n          model.currentGesture = 'Pan';\n          var _callData5 = {\n            translation: [0, 0],\n            touches: positions\n          };\n          publicAPI.startPanEvent(_callData5);\n        }\n      } else {\n        // if we have found a specific type of movement then\n        // handle it\n        if (model.currentGesture === 'Rotate') {\n          var _callData6 = {\n            rotation: angleDeviation,\n            touches: positions\n          };\n          publicAPI.rotateEvent(_callData6);\n        }\n        if (model.currentGesture === 'Pinch') {\n          var _callData7 = {\n            scale: newDistance / originalDistance,\n            touches: positions\n          };\n          publicAPI.pinchEvent(_callData7);\n        }\n        if (model.currentGesture === 'Pan') {\n          var _callData8 = {\n            translation: trans,\n            touches: positions\n          };\n          publicAPI.panEvent(_callData8);\n        }\n      }\n    }\n  };\n  publicAPI.handleVisibilityChange = function () {\n    model._animationStartTime = Date.now();\n    model._animationFrameCount = 0;\n  };\n  publicAPI.setCurrentRenderer = function (r) {\n    model._forcedRenderer = !!r;\n    model.currentRenderer = r;\n  }; // Stop animating if the renderWindowInteractor is deleted.\n\n  var superDelete = publicAPI.delete;\n  publicAPI.delete = function () {\n    while (animationRequesters.size) {\n      publicAPI.cancelAnimation(animationRequesters.values().next().value);\n    }\n    if (typeof document.hidden !== 'undefined') {\n      document.removeEventListener('visibilitychange', publicAPI.handleVisibilityChange);\n    }\n    if (model.container) {\n      publicAPI.unbindEvents();\n    }\n    superDelete();\n  }; // Use the Page Visibility API to detect when we switch away from or back to\n  // this tab, and reset the animationFrameStart. When tabs are not active, browsers\n  // will stop calling requestAnimationFrame callbacks.\n\n  if (typeof document.hidden !== 'undefined') {\n    document.addEventListener('visibilitychange', publicAPI.handleVisibilityChange, false);\n  }\n} // ----------------------------------------------------------------------------\n// Object factory\n// ----------------------------------------------------------------------------\n\nvar DEFAULT_VALUES = {\n  renderWindow: null,\n  interactorStyle: null,\n  picker: null,\n  pickingManager: null,\n  initialized: false,\n  enabled: false,\n  enableRender: true,\n  currentRenderer: null,\n  lightFollowCamera: true,\n  desiredUpdateRate: 30.0,\n  stillUpdateRate: 2.0,\n  container: null,\n  // _view: null,\n  recognizeGestures: true,\n  currentGesture: 'Start',\n  animationRequest: null,\n  lastFrameTime: 0.1,\n  recentAnimationFrameRate: 10.0,\n  wheelTimeoutID: 0,\n  moveTimeoutID: 0,\n  lastGamepadValues: {},\n  preventDefaultOnPointerDown: false,\n  preventDefaultOnPointerUp: false,\n  mouseScrollDebounceByPass: false\n}; // ----------------------------------------------------------------------------\n\nfunction extend(publicAPI, model) {\n  var initialValues = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  Object.assign(model, DEFAULT_VALUES, initialValues); // Object methods\n\n  macro.obj(publicAPI, model); // run animation at least until this time\n\n  model._animationExtendedEnd = 0;\n  macro.event(publicAPI, model, 'RenderEvent');\n  handledEvents.forEach(function (eventName) {\n    return macro.event(publicAPI, model, eventName);\n  }); // Create get-only macros\n\n  macro.get(publicAPI, model, ['initialized', 'container', 'interactorStyle', 'lastFrameTime', 'recentAnimationFrameRate', '_view']); // Create get-set macros\n\n  macro.setGet(publicAPI, model, ['lightFollowCamera', 'enabled', 'enableRender', 'recognizeGestures', 'desiredUpdateRate', 'stillUpdateRate', 'picker', 'preventDefaultOnPointerDown', 'preventDefaultOnPointerUp', 'mouseScrollDebounceByPass']);\n  macro.moveToProtected(publicAPI, model, ['view']); // For more macro methods, see \"Sources/macros.js\"\n  // Object specific methods\n\n  vtkRenderWindowInteractor(publicAPI, model);\n} // ----------------------------------------------------------------------------\n\nvar newInstance = macro.newInstance(extend, 'vtkRenderWindowInteractor'); // ----------------------------------------------------------------------------\n\nvar vtkRenderWindowInteractor$1 = _objectSpread({\n  newInstance: newInstance,\n  extend: extend,\n  handledEvents: handledEvents\n}, Constants);\nexport { vtkRenderWindowInteractor$1 as default, extend, newInstance };","map":{"version":3,"names":["_toConsumableArray","_defineProperty","macro","A","degreesFromRadians","Constants","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","getOwnPropertyDescriptors","defineProperties","defineProperty","Device","Input","vtkWarningMacro","vtkErrorMacro","normalizeWheel","vtkOnceErrorMacro","EMPTY_MOUSE_EVENT","MouseEvent","deviceInputMap","Trigger","Grip","TrackPad","Thumbstick","B","handledEvents","preventDefault","event","cancelable","pointerCacheToPositions","cache","positions","create","_ref","pointerId","position","vtkRenderWindowInteractor","publicAPI","model","classHierarchy","animationRequesters","Set","pointerCache","Map","wheelCoefficient","start","initialized","initialize","startEventLoop","setRenderWindow","aren","setInteractorStyle","style","interactorStyle","setInteractor","getInteractor","enable","render","setEnabled","disable","updateCurrentRenderer","x","y","_forcedRenderer","currentRenderer","findPokedRenderer","getCurrentRenderer","getScreenEventPositionFor","canvas","_view","getCanvas","bounds","getBoundingClientRect","scaleX","width","scaleY","height","clientX","left","clientY","top","z","size","getModifierKeysFor","controlKey","ctrlKey","altKey","shiftKey","getKeysFor","modifierKeys","keyCode","charCode","getDeviceTypeFor","pointerType","bindEvents","container","addEventListener","handleWheel","handlePointerEnter","handlePointerLeave","handlePointerMove","passive","handlePointerDown","handlePointerUp","handlePointerCancel","document","handleKeyPress","handleKeyDown","handleKeyUp","handlePointerLockChange","touchAction","userSelect","webkitTapHighlightColor","unbindEvents","removeEventListener","clear","data","keyPressEvent","keyDownEvent","keyUpEvent","callData","deviceType","pointerEnterEvent","mouseEnterEvent","pointerLeaveEvent","mouseLeaveEvent","button","isPointerLocked","preventDefaultOnPointerDown","hasPointerCapture","releasePointerCapture","setPointerCapture","has","set","handleTouchStart","handleMouseDown","preventDefaultOnPointerUp","delete","handleTouchEnd","handleMouseUp","pointer","get","handleTouchMove","handleMouseMove","leftButtonPressEvent","middleButtonPressEvent","rightButtonPressEvent","concat","requestPointerLock","exitPointerLock","_document$exitPointer","_document","call","pointerLockElement","startPointerLockEvent","endPointerLockEvent","forceRender","enabled","enableRender","inRender","traverseAllPasses","invokeRenderEvent","requestAnimation","requestor","undefined","add","animationRequest","xrAnimation","_animationStartTime","Date","now","_animationFrameCount","requestAnimationFrame","handleAnimation","startAnimationEvent","extendAnimation","duration","newEnd","_animationExtendedEnd","Math","max","isAnimating","cancelAnimation","skipWarning","requestStr","getClassName","cancelAnimationFrame","endAnimationEvent","switchToXRAnimation","returnFromXRAnimation","recentAnimationFrameRate","updateXRGamepads","xrSession","xrFrame","xrRefSpace","inputSources","inputSource","gripPose","gripSpace","getPose","gp","gamepad","hand","handedness","index","lastGamepadValues","buttons","right","none","b","pressed","button3DEvent","transform","orientation","device","LeftController","RightController","input","mapping","move3DEvent","moveTimeoutID","startMouseMoveEvent","mouseMoveEvent","clearTimeout","setTimeout","endMouseMoveEvent","currTime","lastFrameTime","animationFrameRateUpdateEvent","animationEvent","wheelTimeoutID","abs","spinY","startMouseWheelEvent","mouseWheelEvent","mouseScrollDebounceByPass","endMouseWheelEvent","leftButtonReleaseEvent","middleButtonReleaseEvent","rightButtonReleaseEvent","pointers","values","recognizeGestures","recognizeGesture","_callData","_callData2","_positions","_callData3","setView","val","getRenderable","modified","getFirstRenderer","_model$_view","_model$_view$getRende","_model$_view$getRende2","getRenderersByReference","_model$_view2","_model$_view2$getRend","rc","getRenderers","sort","a","getLayer","interactiveren","viewportren","count","isInViewport","getInteractive","eventName","lowerFirst","charAt","toLowerCase","slice","arg","renderer","type","pokedRenderer","firstRenderer","startingEventPositions","currentGesture","endPinchEvent","endRotateEvent","endPanEvent","posVals","startVals","originalDistance","sqrt","newDistance","originalAngle","atan2","newAngle","angleDeviation","trans","thresh","clientWidth","clientHeight","pinchDistance","rotateDistance","panDistance","scale","touches","startPinchEvent","_callData4","rotation","startRotateEvent","_callData5","translation","startPanEvent","_callData6","rotateEvent","_callData7","pinchEvent","_callData8","panEvent","handleVisibilityChange","setCurrentRenderer","r","superDelete","next","value","hidden","DEFAULT_VALUES","renderWindow","picker","pickingManager","lightFollowCamera","desiredUpdateRate","stillUpdateRate","extend","initialValues","assign","obj","setGet","moveToProtected","newInstance","vtkRenderWindowInteractor$1","default"],"sources":["/home/rakshith/Documents/RemoteRendering/vtk-js-react-app/node_modules/@kitware/vtk.js/Rendering/Core/RenderWindowInteractor.js"],"sourcesContent":["import _toConsumableArray from '@babel/runtime/helpers/toConsumableArray';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport macro from '../../macros.js';\nimport { A as degreesFromRadians } from '../../Common/Core/Math/index.js';\nimport Constants from './RenderWindowInteractor/Constants.js';\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nvar Device = Constants.Device,\n    Input = Constants.Input;\nvar vtkWarningMacro = macro.vtkWarningMacro,\n    vtkErrorMacro = macro.vtkErrorMacro,\n    normalizeWheel = macro.normalizeWheel,\n    vtkOnceErrorMacro = macro.vtkOnceErrorMacro; // ----------------------------------------------------------------------------\n// Global methods\n// ----------------------------------------------------------------------------\n\nvar EMPTY_MOUSE_EVENT = new MouseEvent('');\nvar deviceInputMap = {\n  'xr-standard': [Input.Trigger, Input.Grip, Input.TrackPad, Input.Thumbstick, Input.A, Input.B]\n};\nvar handledEvents = ['StartAnimation', 'Animation', 'EndAnimation', 'PointerEnter', 'PointerLeave', 'MouseEnter', 'MouseLeave', 'StartMouseMove', 'MouseMove', 'EndMouseMove', 'LeftButtonPress', 'LeftButtonRelease', 'MiddleButtonPress', 'MiddleButtonRelease', 'RightButtonPress', 'RightButtonRelease', 'KeyPress', 'KeyDown', 'KeyUp', 'StartMouseWheel', 'MouseWheel', 'EndMouseWheel', 'StartPinch', 'Pinch', 'EndPinch', 'StartPan', 'Pan', 'EndPan', 'StartRotate', 'Rotate', 'EndRotate', 'Button3D', 'Move3D', 'StartPointerLock', 'EndPointerLock', 'StartInteraction', 'Interaction', 'EndInteraction', 'AnimationFrameRateUpdate'];\n\nfunction preventDefault(event) {\n  if (event.cancelable) {\n    event.preventDefault();\n  }\n}\n\nfunction pointerCacheToPositions(cache) {\n  var positions = Object.create(null);\n  cache.forEach(function (_ref) {\n    var pointerId = _ref.pointerId,\n        position = _ref.position;\n    positions[pointerId] = position;\n  });\n  return positions;\n} // ----------------------------------------------------------------------------\n// vtkRenderWindowInteractor methods\n// ----------------------------------------------------------------------------\n\n\nfunction vtkRenderWindowInteractor(publicAPI, model) {\n  // Set our className\n  model.classHierarchy.push('vtkRenderWindowInteractor'); // Initialize list of requesters\n\n  var animationRequesters = new Set(); // map from pointerId to { pointerId: number, position: [x, y] }\n\n  var pointerCache = new Map(); // Factor to apply on wheel spin.\n\n  var wheelCoefficient = 1; // Public API methods\n  //----------------------------------------------------------------------\n\n  publicAPI.start = function () {\n    // Let the compositing handle the event loop if it wants to.\n    // if (publicAPI.HasObserver(vtkCommand::StartEvent) && !publicAPI.HandleEventLoop) {\n    //   publicAPI.invokeEvent({ type: 'StartEvent' });\n    //   return;\n    // }\n    // As a convenience, initialize if we aren't initialized yet.\n    if (!model.initialized) {\n      publicAPI.initialize();\n\n      if (!model.initialized) {\n        return;\n      }\n    } // Pass execution to the subclass which will run the event loop,\n    // this will not return until TerminateApp is called.\n\n\n    publicAPI.startEventLoop();\n  }; //----------------------------------------------------------------------\n\n\n  publicAPI.setRenderWindow = function (aren) {\n    vtkErrorMacro('you want to call setView(view) instead of setRenderWindow on a vtk.js interactor');\n  }; //----------------------------------------------------------------------\n\n\n  publicAPI.setInteractorStyle = function (style) {\n    if (model.interactorStyle !== style) {\n      if (model.interactorStyle != null) {\n        model.interactorStyle.setInteractor(null);\n      }\n\n      model.interactorStyle = style;\n\n      if (model.interactorStyle != null) {\n        if (model.interactorStyle.getInteractor() !== publicAPI) {\n          model.interactorStyle.setInteractor(publicAPI);\n        }\n      }\n    }\n  }; //---------------------------------------------------------------------\n\n\n  publicAPI.initialize = function () {\n    model.initialized = true;\n    publicAPI.enable();\n    publicAPI.render();\n  };\n\n  publicAPI.enable = function () {\n    return publicAPI.setEnabled(true);\n  };\n\n  publicAPI.disable = function () {\n    return publicAPI.setEnabled(false);\n  };\n\n  publicAPI.startEventLoop = function () {\n    return vtkWarningMacro('empty event loop');\n  };\n\n  function updateCurrentRenderer(x, y) {\n    if (!model._forcedRenderer) {\n      model.currentRenderer = publicAPI.findPokedRenderer(x, y);\n    }\n  }\n\n  publicAPI.getCurrentRenderer = function () {\n    if (model.currentRenderer) {\n      return model.currentRenderer;\n    }\n\n    updateCurrentRenderer(0, 0);\n    return model.currentRenderer;\n  };\n\n  function getScreenEventPositionFor(source) {\n    var canvas = model._view.getCanvas();\n\n    var bounds = canvas.getBoundingClientRect();\n    var scaleX = canvas.width / bounds.width;\n    var scaleY = canvas.height / bounds.height;\n    var position = {\n      x: scaleX * (source.clientX - bounds.left),\n      y: scaleY * (bounds.height - source.clientY + bounds.top),\n      z: 0\n    }; // if multitouch, do not update the current renderer\n\n    if (pointerCache.size <= 1 || !model.currentRenderer) {\n      updateCurrentRenderer(position.x, position.y);\n    }\n\n    return position;\n  }\n\n  function getModifierKeysFor(event) {\n    return {\n      controlKey: event.ctrlKey,\n      altKey: event.altKey,\n      shiftKey: event.shiftKey\n    };\n  }\n\n  function getKeysFor(event) {\n    var modifierKeys = getModifierKeysFor(event);\n\n    var keys = _objectSpread({\n      key: event.key,\n      keyCode: event.charCode\n    }, modifierKeys);\n\n    return keys;\n  }\n\n  function getDeviceTypeFor(event) {\n    return event.pointerType || '';\n  }\n\n  publicAPI.bindEvents = function (container) {\n    model.container = container;\n    container.addEventListener('contextmenu', preventDefault);\n    container.addEventListener('wheel', publicAPI.handleWheel);\n    container.addEventListener('DOMMouseScroll', publicAPI.handleWheel);\n    container.addEventListener('pointerenter', publicAPI.handlePointerEnter);\n    container.addEventListener('pointerleave', publicAPI.handlePointerLeave);\n    container.addEventListener('pointermove', publicAPI.handlePointerMove, {\n      passive: false\n    });\n    container.addEventListener('pointerdown', publicAPI.handlePointerDown, {\n      passive: false\n    });\n    container.addEventListener('pointerup', publicAPI.handlePointerUp);\n    container.addEventListener('pointercancel', publicAPI.handlePointerCancel);\n    document.addEventListener('keypress', publicAPI.handleKeyPress);\n    document.addEventListener('keydown', publicAPI.handleKeyDown);\n    document.addEventListener('keyup', publicAPI.handleKeyUp);\n    document.addEventListener('pointerlockchange', publicAPI.handlePointerLockChange); // using touchAction is more performant than preventDefault\n    // in a touchstart handler.\n\n    container.style.touchAction = 'none';\n    container.style.userSelect = 'none'; // disables tap highlight for when cursor is pointer\n\n    container.style.webkitTapHighlightColor = 'rgba(0,0,0,0)';\n  };\n\n  publicAPI.unbindEvents = function () {\n    var container = model.container;\n    container.removeEventListener('contextmenu', preventDefault);\n    container.removeEventListener('wheel', publicAPI.handleWheel);\n    container.removeEventListener('DOMMouseScroll', publicAPI.handleWheel);\n    container.removeEventListener('pointerenter', publicAPI.handlePointerEnter);\n    container.removeEventListener('pointerleave', publicAPI.handlePointerLeave);\n    container.removeEventListener('pointermove', publicAPI.handlePointerMove, {\n      passive: false\n    });\n    container.removeEventListener('pointerdown', publicAPI.handlePointerDown, {\n      passive: false\n    });\n    container.removeEventListener('pointerup', publicAPI.handlePointerUp);\n    container.removeEventListener('pointercancel', publicAPI.handlePointerCancel);\n    document.removeEventListener('keypress', publicAPI.handleKeyPress);\n    document.removeEventListener('keydown', publicAPI.handleKeyDown);\n    document.removeEventListener('keyup', publicAPI.handleKeyUp);\n    document.removeEventListener('pointerlockchange', publicAPI.handlePointerLockChange);\n    model.container = null;\n    pointerCache.clear();\n  };\n\n  publicAPI.handleKeyPress = function (event) {\n    var data = getKeysFor(event);\n    publicAPI.keyPressEvent(data);\n  };\n\n  publicAPI.handleKeyDown = function (event) {\n    var data = getKeysFor(event);\n    publicAPI.keyDownEvent(data);\n  };\n\n  publicAPI.handleKeyUp = function (event) {\n    var data = getKeysFor(event);\n    publicAPI.keyUpEvent(data);\n  };\n\n  publicAPI.handlePointerEnter = function (event) {\n    var callData = _objectSpread(_objectSpread({}, getModifierKeysFor(event)), {}, {\n      position: getScreenEventPositionFor(event),\n      deviceType: getDeviceTypeFor(event)\n    });\n\n    publicAPI.pointerEnterEvent(callData);\n\n    if (callData.deviceType === 'mouse') {\n      publicAPI.mouseEnterEvent(callData);\n    }\n  };\n\n  publicAPI.handlePointerLeave = function (event) {\n    var callData = _objectSpread(_objectSpread({}, getModifierKeysFor(event)), {}, {\n      position: getScreenEventPositionFor(event),\n      deviceType: getDeviceTypeFor(event)\n    });\n\n    publicAPI.pointerLeaveEvent(callData);\n\n    if (callData.deviceType === 'mouse') {\n      publicAPI.mouseLeaveEvent(callData);\n    }\n  };\n\n  publicAPI.handlePointerDown = function (event) {\n    if (event.button > 2 || publicAPI.isPointerLocked()) {\n      // ignore events from extra mouse buttons such as `back` and `forward`\n      return;\n    }\n\n    if (model.preventDefaultOnPointerDown) {\n      preventDefault(event);\n    }\n\n    if (event.target.hasPointerCapture(event.pointerId)) {\n      event.target.releasePointerCapture(event.pointerId);\n    }\n\n    model.container.setPointerCapture(event.pointerId);\n\n    if (pointerCache.has(event.pointerId)) {\n      vtkWarningMacro('[RenderWindowInteractor] duplicate pointerId detected');\n    }\n\n    pointerCache.set(event.pointerId, {\n      pointerId: event.pointerId,\n      position: getScreenEventPositionFor(event)\n    });\n\n    switch (event.pointerType) {\n      case 'pen':\n      case 'touch':\n        publicAPI.handleTouchStart(event);\n        break;\n\n      case 'mouse':\n      default:\n        publicAPI.handleMouseDown(event);\n        break;\n    }\n  };\n\n  publicAPI.handlePointerUp = function (event) {\n    if (pointerCache.has(event.pointerId)) {\n      if (model.preventDefaultOnPointerUp) {\n        preventDefault(event);\n      }\n\n      pointerCache.delete(event.pointerId);\n      model.container.releasePointerCapture(event.pointerId);\n\n      switch (event.pointerType) {\n        case 'pen':\n        case 'touch':\n          publicAPI.handleTouchEnd(event);\n          break;\n\n        case 'mouse':\n        default:\n          publicAPI.handleMouseUp(event);\n          break;\n      }\n    }\n  };\n\n  publicAPI.handlePointerCancel = function (event) {\n    if (pointerCache.has(event.pointerId)) {\n      pointerCache.delete(event.pointerId);\n\n      switch (event.pointerType) {\n        case 'pen':\n        case 'touch':\n          publicAPI.handleTouchEnd(event);\n          break;\n\n        case 'mouse':\n        default:\n          publicAPI.handleMouseUp(event);\n          break;\n      }\n    }\n  };\n\n  publicAPI.handlePointerMove = function (event) {\n    if (pointerCache.has(event.pointerId)) {\n      var pointer = pointerCache.get(event.pointerId);\n      pointer.position = getScreenEventPositionFor(event);\n    }\n\n    switch (event.pointerType) {\n      case 'pen':\n      case 'touch':\n        publicAPI.handleTouchMove(event);\n        break;\n\n      case 'mouse':\n      default:\n        publicAPI.handleMouseMove(event);\n        break;\n    }\n  };\n\n  publicAPI.handleMouseDown = function (event) {\n    var callData = _objectSpread(_objectSpread({}, getModifierKeysFor(event)), {}, {\n      position: getScreenEventPositionFor(event),\n      deviceType: getDeviceTypeFor(event)\n    });\n\n    switch (event.button) {\n      case 0:\n        publicAPI.leftButtonPressEvent(callData);\n        break;\n\n      case 1:\n        publicAPI.middleButtonPressEvent(callData);\n        break;\n\n      case 2:\n        publicAPI.rightButtonPressEvent(callData);\n        break;\n\n      default:\n        vtkErrorMacro(\"Unknown mouse button pressed: \".concat(event.button));\n        break;\n    }\n  }; //----------------------------------------------------------------------\n\n\n  publicAPI.requestPointerLock = function () {\n    if (model.container) {\n      model.container.requestPointerLock();\n    }\n  }; //----------------------------------------------------------------------\n\n\n  publicAPI.exitPointerLock = function () {\n    var _document$exitPointer, _document;\n\n    return (_document$exitPointer = (_document = document).exitPointerLock) === null || _document$exitPointer === void 0 ? void 0 : _document$exitPointer.call(_document);\n  }; //----------------------------------------------------------------------\n\n\n  publicAPI.isPointerLocked = function () {\n    return !!model.container && document.pointerLockElement === model.container;\n  }; //----------------------------------------------------------------------\n\n\n  publicAPI.handlePointerLockChange = function () {\n    if (publicAPI.isPointerLocked()) {\n      publicAPI.startPointerLockEvent();\n    } else {\n      publicAPI.endPointerLockEvent();\n    }\n  }; //----------------------------------------------------------------------\n\n\n  function forceRender() {\n    if (model._view && model.enabled && model.enableRender) {\n      model.inRender = true;\n\n      model._view.traverseAllPasses();\n\n      model.inRender = false;\n    } // outside the above test so that third-party code can redirect\n    // the render to the appropriate class\n\n\n    publicAPI.invokeRenderEvent();\n  }\n\n  publicAPI.requestAnimation = function (requestor) {\n    if (requestor === undefined) {\n      vtkErrorMacro(\"undefined requester, can not start animating\");\n      return;\n    }\n\n    if (animationRequesters.has(requestor)) {\n      vtkWarningMacro(\"requester is already registered for animating\");\n      return;\n    }\n\n    animationRequesters.add(requestor);\n\n    if (!model.animationRequest && animationRequesters.size === 1 && !model.xrAnimation) {\n      model._animationStartTime = Date.now();\n      model._animationFrameCount = 0;\n      model.animationRequest = requestAnimationFrame(publicAPI.handleAnimation);\n      publicAPI.startAnimationEvent();\n    }\n  }; // continue animating for at least the specified duration of\n  // milliseconds.\n\n\n  publicAPI.extendAnimation = function (duration) {\n    var newEnd = Date.now() + duration;\n    model._animationExtendedEnd = Math.max(model._animationExtendedEnd, newEnd);\n\n    if (!model.animationRequest && animationRequesters.size === 0 && !model.xrAnimation) {\n      model._animationStartTime = Date.now();\n      model._animationFrameCount = 0;\n      model.animationRequest = requestAnimationFrame(publicAPI.handleAnimation);\n      publicAPI.startAnimationEvent();\n    }\n  };\n\n  publicAPI.isAnimating = function () {\n    return model.xrAnimation || model.animationRequest !== null;\n  };\n\n  publicAPI.cancelAnimation = function (requestor) {\n    var skipWarning = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n    if (!animationRequesters.has(requestor)) {\n      if (!skipWarning) {\n        var requestStr = requestor && requestor.getClassName ? requestor.getClassName() : requestor;\n        vtkWarningMacro(\"\".concat(requestStr, \" did not request an animation\"));\n      }\n\n      return;\n    }\n\n    animationRequesters.delete(requestor);\n\n    if (model.animationRequest && animationRequesters.size === 0 && Date.now() > model._animationExtendedEnd) {\n      cancelAnimationFrame(model.animationRequest);\n      model.animationRequest = null;\n      publicAPI.endAnimationEvent();\n      publicAPI.render();\n    }\n  };\n\n  publicAPI.switchToXRAnimation = function () {\n    // cancel existing animation if any\n    if (model.animationRequest) {\n      cancelAnimationFrame(model.animationRequest);\n      model.animationRequest = null;\n    }\n\n    model.xrAnimation = true;\n  };\n\n  publicAPI.returnFromXRAnimation = function () {\n    model.xrAnimation = false;\n\n    if (animationRequesters.size !== 0) {\n      model.recentAnimationFrameRate = 10.0;\n      model.animationRequest = requestAnimationFrame(publicAPI.handleAnimation);\n    }\n  };\n\n  publicAPI.updateXRGamepads = function (xrSession, xrFrame, xrRefSpace) {\n    // watch for when buttons change state and fire events\n    xrSession.inputSources.forEach(function (inputSource) {\n      var gripPose = inputSource.gripSpace == null ? null : xrFrame.getPose(inputSource.gripSpace, xrRefSpace);\n      var gp = inputSource.gamepad;\n      var hand = inputSource.handedness;\n\n      if (gp) {\n        if (!(gp.index in model.lastGamepadValues)) {\n          model.lastGamepadValues[gp.index] = {\n            left: {\n              buttons: {}\n            },\n            right: {\n              buttons: {}\n            },\n            none: {\n              buttons: {}\n            }\n          };\n        }\n\n        for (var b = 0; b < gp.buttons.length; ++b) {\n          if (!(b in model.lastGamepadValues[gp.index][hand].buttons)) {\n            model.lastGamepadValues[gp.index][hand].buttons[b] = false;\n          }\n\n          if (model.lastGamepadValues[gp.index][hand].buttons[b] !== gp.buttons[b].pressed && gripPose != null) {\n            publicAPI.button3DEvent({\n              gamepad: gp,\n              position: gripPose.transform.position,\n              orientation: gripPose.transform.orientation,\n              pressed: gp.buttons[b].pressed,\n              device: inputSource.handedness === 'left' ? Device.LeftController : Device.RightController,\n              input: deviceInputMap[gp.mapping] && deviceInputMap[gp.mapping][b] ? deviceInputMap[gp.mapping][b] : Input.Trigger\n            });\n            model.lastGamepadValues[gp.index][hand].buttons[b] = gp.buttons[b].pressed;\n          }\n\n          if (model.lastGamepadValues[gp.index][hand].buttons[b] && gripPose != null) {\n            publicAPI.move3DEvent({\n              gamepad: gp,\n              position: gripPose.transform.position,\n              orientation: gripPose.transform.orientation,\n              device: inputSource.handedness === 'left' ? Device.LeftController : Device.RightController\n            });\n          }\n        }\n      }\n    });\n  };\n\n  publicAPI.handleMouseMove = function (event) {\n    var callData = _objectSpread(_objectSpread({}, getModifierKeysFor(event)), {}, {\n      position: getScreenEventPositionFor(event),\n      deviceType: getDeviceTypeFor(event)\n    });\n\n    if (model.moveTimeoutID === 0) {\n      publicAPI.startMouseMoveEvent(callData);\n    } else {\n      publicAPI.mouseMoveEvent(callData);\n      clearTimeout(model.moveTimeoutID);\n    } // start a timer to keep us animating while we get mouse move events\n\n\n    model.moveTimeoutID = setTimeout(function () {\n      publicAPI.endMouseMoveEvent();\n      model.moveTimeoutID = 0;\n    }, 200);\n  };\n\n  publicAPI.handleAnimation = function () {\n    var currTime = Date.now();\n    model._animationFrameCount++;\n\n    if (currTime - model._animationStartTime > 1000.0 && model._animationFrameCount > 1) {\n      model.recentAnimationFrameRate = 1000.0 * (model._animationFrameCount - 1) / (currTime - model._animationStartTime);\n      model.lastFrameTime = 1.0 / model.recentAnimationFrameRate;\n      publicAPI.animationFrameRateUpdateEvent();\n      model._animationStartTime = currTime;\n      model._animationFrameCount = 1;\n    }\n\n    publicAPI.animationEvent();\n    forceRender();\n\n    if (animationRequesters.size > 0 || Date.now() < model._animationExtendedEnd) {\n      model.animationRequest = requestAnimationFrame(publicAPI.handleAnimation);\n    } else {\n      cancelAnimationFrame(model.animationRequest);\n      model.animationRequest = null;\n      publicAPI.endAnimationEvent();\n      publicAPI.render();\n    }\n  };\n\n  publicAPI.handleWheel = function (event) {\n    preventDefault(event);\n    /**\n     * wheel event values can vary significantly across browsers, platforms\n     * and devices [1]. `normalizeWheel` uses facebook's solution from their\n     * fixed-data-table repository [2].\n     *\n     * [1] https://developer.mozilla.org/en-US/docs/Web/Events/mousewheel\n     * [2] https://github.com/facebookarchive/fixed-data-table/blob/master/src/vendor_upstream/dom/normalizeWheel.js\n     *\n     * This code will return an object with properties:\n     *\n     *   spinX   -- normalized spin speed (use for zoom) - x plane\n     *   spinY   -- \" - y plane\n     *   pixelX  -- normalized distance (to pixels) - x plane\n     *   pixelY  -- \" - y plane\n     *\n     */\n\n    var callData = _objectSpread(_objectSpread(_objectSpread({}, normalizeWheel(event)), getModifierKeysFor(event)), {}, {\n      position: getScreenEventPositionFor(event),\n      deviceType: getDeviceTypeFor(event)\n    }); // Wheel events are thought to scroll pages (i.e. multiple lines at once).\n    // See normalizeWheel() documentation for more context.\n    // While trackpad wheel events are many small (<1) wheel spins,\n    // mouse wheel events have absolute spin values higher than 1.\n    // Here the first spin value is \"recorded\", and used to normalize\n    // all the following mouse wheel events.\n\n\n    if (model.wheelTimeoutID === 0) {\n      // we attempt to distinguish between trackpads and mice\n      // .3 will be larger than the first trackpad event,\n      // but small enough to detect some common edge case mice\n      if (Math.abs(callData.spinY) >= 0.3) {\n        // Event is coming from mouse wheel\n        wheelCoefficient = Math.abs(callData.spinY);\n      } else {\n        // Event is coming from trackpad\n        wheelCoefficient = 1;\n      }\n    }\n\n    callData.spinY /= wheelCoefficient;\n\n    if (model.wheelTimeoutID === 0) {\n      publicAPI.startMouseWheelEvent(callData);\n      publicAPI.mouseWheelEvent(callData);\n    } else {\n      publicAPI.mouseWheelEvent(callData);\n      clearTimeout(model.wheelTimeoutID);\n    }\n\n    if (model.mouseScrollDebounceByPass) {\n      publicAPI.extendAnimation(600);\n      publicAPI.endMouseWheelEvent();\n      model.wheelTimeoutID = 0;\n    } else {\n      // start a timer to keep us animating while we get wheel events\n      model.wheelTimeoutID = setTimeout(function () {\n        publicAPI.extendAnimation(600);\n        publicAPI.endMouseWheelEvent();\n        model.wheelTimeoutID = 0;\n      }, 200);\n    }\n  };\n\n  publicAPI.handleMouseUp = function (event) {\n    var callData = _objectSpread(_objectSpread({}, getModifierKeysFor(event)), {}, {\n      position: getScreenEventPositionFor(event),\n      deviceType: getDeviceTypeFor(event)\n    });\n\n    switch (event.button) {\n      case 0:\n        publicAPI.leftButtonReleaseEvent(callData);\n        break;\n\n      case 1:\n        publicAPI.middleButtonReleaseEvent(callData);\n        break;\n\n      case 2:\n        publicAPI.rightButtonReleaseEvent(callData);\n        break;\n\n      default:\n        vtkErrorMacro(\"Unknown mouse button released: \".concat(event.button));\n        break;\n    }\n  };\n\n  publicAPI.handleTouchStart = function (event) {\n    var pointers = _toConsumableArray(pointerCache.values()); // If multitouch\n\n\n    if (model.recognizeGestures && pointers.length > 1) {\n      var positions = pointerCacheToPositions(pointerCache); // did we just transition to multitouch?\n\n      if (pointers.length === 2) {\n        var callData = _objectSpread(_objectSpread({}, getModifierKeysFor(EMPTY_MOUSE_EVENT)), {}, {\n          position: pointers[0].position,\n          deviceType: getDeviceTypeFor(event)\n        });\n\n        publicAPI.leftButtonReleaseEvent(callData);\n      } // handle the gesture\n\n\n      publicAPI.recognizeGesture('TouchStart', positions);\n    } else if (pointers.length === 1) {\n      var _callData = _objectSpread(_objectSpread({}, getModifierKeysFor(EMPTY_MOUSE_EVENT)), {}, {\n        position: getScreenEventPositionFor(event),\n        deviceType: getDeviceTypeFor(event)\n      });\n\n      publicAPI.leftButtonPressEvent(_callData);\n    }\n  };\n\n  publicAPI.handleTouchMove = function (event) {\n    var pointers = _toConsumableArray(pointerCache.values());\n\n    if (model.recognizeGestures && pointers.length > 1) {\n      var positions = pointerCacheToPositions(pointerCache);\n      publicAPI.recognizeGesture('TouchMove', positions);\n    } else if (pointers.length === 1) {\n      var callData = _objectSpread(_objectSpread({}, getModifierKeysFor(EMPTY_MOUSE_EVENT)), {}, {\n        position: pointers[0].position,\n        deviceType: getDeviceTypeFor(event)\n      });\n\n      publicAPI.mouseMoveEvent(callData);\n    }\n  };\n\n  publicAPI.handleTouchEnd = function (event) {\n    var pointers = _toConsumableArray(pointerCache.values());\n\n    if (model.recognizeGestures) {\n      // No more fingers down\n      if (pointers.length === 0) {\n        var callData = _objectSpread(_objectSpread({}, getModifierKeysFor(EMPTY_MOUSE_EVENT)), {}, {\n          position: getScreenEventPositionFor(event),\n          deviceType: getDeviceTypeFor(event)\n        });\n\n        publicAPI.leftButtonReleaseEvent(callData);\n      } else if (pointers.length === 1) {\n        // If one finger left, end touch and start button press\n        var positions = pointerCacheToPositions(pointerCache);\n        publicAPI.recognizeGesture('TouchEnd', positions);\n\n        var _callData2 = _objectSpread(_objectSpread({}, getModifierKeysFor(EMPTY_MOUSE_EVENT)), {}, {\n          position: pointers[0].position,\n          deviceType: getDeviceTypeFor(event)\n        });\n\n        publicAPI.leftButtonPressEvent(_callData2);\n      } else {\n        // If more than one finger left, keep touch move\n        var _positions = pointerCacheToPositions(pointerCache);\n\n        publicAPI.recognizeGesture('TouchMove', _positions);\n      }\n    } else if (pointers.length === 1) {\n      var _callData3 = _objectSpread(_objectSpread({}, getModifierKeysFor(EMPTY_MOUSE_EVENT)), {}, {\n        position: pointers[0].position,\n        deviceType: getDeviceTypeFor(event)\n      });\n\n      publicAPI.leftButtonReleaseEvent(_callData3);\n    }\n  };\n\n  publicAPI.setView = function (val) {\n    if (model._view === val) {\n      return;\n    }\n\n    model._view = val;\n\n    model._view.getRenderable().setInteractor(publicAPI);\n\n    publicAPI.modified();\n  };\n\n  publicAPI.getFirstRenderer = function () {\n    var _model$_view, _model$_view$getRende, _model$_view$getRende2;\n\n    return (_model$_view = model._view) === null || _model$_view === void 0 ? void 0 : (_model$_view$getRende = _model$_view.getRenderable()) === null || _model$_view$getRende === void 0 ? void 0 : (_model$_view$getRende2 = _model$_view$getRende.getRenderersByReference()) === null || _model$_view$getRende2 === void 0 ? void 0 : _model$_view$getRende2[0];\n  };\n\n  publicAPI.findPokedRenderer = function () {\n    var _model$_view2, _model$_view2$getRend;\n\n    var x = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n    if (!model._view) {\n      return null;\n    } // The original order of renderers needs to remain as\n    // the first one is the one we want to manipulate the camera on.\n\n\n    var rc = (_model$_view2 = model._view) === null || _model$_view2 === void 0 ? void 0 : (_model$_view2$getRend = _model$_view2.getRenderable()) === null || _model$_view2$getRend === void 0 ? void 0 : _model$_view2$getRend.getRenderers();\n\n    if (!rc || rc.length === 0) {\n      return null;\n    }\n\n    rc.sort(function (a, b) {\n      return a.getLayer() - b.getLayer();\n    });\n    var interactiveren = null;\n    var viewportren = null;\n    var currentRenderer = null;\n    var count = rc.length;\n\n    while (count--) {\n      var aren = rc[count];\n\n      if (model._view.isInViewport(x, y, aren) && aren.getInteractive()) {\n        currentRenderer = aren;\n        break;\n      }\n\n      if (interactiveren === null && aren.getInteractive()) {\n        // Save this renderer in case we can't find one in the viewport that\n        // is interactive.\n        interactiveren = aren;\n      }\n\n      if (viewportren === null && model._view.isInViewport(x, y, aren)) {\n        // Save this renderer in case we can't find one in the viewport that\n        // is interactive.\n        viewportren = aren;\n      }\n    } // We must have a value.  If we found an interactive renderer before, that's\n    // better than a non-interactive renderer.\n\n\n    if (currentRenderer === null) {\n      currentRenderer = interactiveren;\n    } // We must have a value.  If we found a renderer that is in the viewport,\n    // that is better than any old viewport (but not as good as an interactive\n    // one).\n\n\n    if (currentRenderer === null) {\n      currentRenderer = viewportren;\n    } // We must have a value - take anything.\n\n\n    if (currentRenderer == null) {\n      currentRenderer = rc[0];\n    }\n\n    return currentRenderer;\n  }; // only render if we are not animating. If we are animating\n  // then renders will happen naturally anyhow and we definitely\n  // do not want extra renders as the make the apparent interaction\n  // rate slower.\n\n\n  publicAPI.render = function () {\n    if (!publicAPI.isAnimating() && !model.inRender) {\n      forceRender();\n    }\n  }; // create the generic Event methods\n\n\n  handledEvents.forEach(function (eventName) {\n    var lowerFirst = eventName.charAt(0).toLowerCase() + eventName.slice(1);\n\n    publicAPI[\"\".concat(lowerFirst, \"Event\")] = function (arg) {\n      // Check that interactor enabled\n      if (!model.enabled) {\n        return;\n      } // Check that a poked renderer exists\n\n\n      var renderer = publicAPI.getCurrentRenderer();\n\n      if (!renderer) {\n        vtkOnceErrorMacro(\"\\n          Can not forward events without a current renderer on the interactor.\\n        \");\n        return;\n      } // Pass the eventName and the poked renderer\n\n\n      var callData = _objectSpread({\n        type: eventName,\n        pokedRenderer: model.currentRenderer,\n        firstRenderer: publicAPI.getFirstRenderer()\n      }, arg); // Call invoke\n\n\n      publicAPI[\"invoke\".concat(eventName)](callData);\n    };\n  }); // we know we are in multitouch now, so start recognizing\n\n  publicAPI.recognizeGesture = function (event, positions) {\n    // more than two pointers we ignore\n    if (Object.keys(positions).length > 2) {\n      return;\n    }\n\n    if (!model.startingEventPositions) {\n      model.startingEventPositions = {};\n    } // store the initial positions\n\n\n    if (event === 'TouchStart') {\n      Object.keys(positions).forEach(function (key) {\n        model.startingEventPositions[key] = positions[key];\n      }); // we do not know what the gesture is yet\n\n      model.currentGesture = 'Start';\n      return;\n    } // end the gesture if needed\n\n\n    if (event === 'TouchEnd') {\n      if (model.currentGesture === 'Pinch') {\n        publicAPI.render();\n        publicAPI.endPinchEvent();\n      }\n\n      if (model.currentGesture === 'Rotate') {\n        publicAPI.render();\n        publicAPI.endRotateEvent();\n      }\n\n      if (model.currentGesture === 'Pan') {\n        publicAPI.render();\n        publicAPI.endPanEvent();\n      }\n\n      model.currentGesture = 'Start';\n      model.startingEventPositions = {};\n      return;\n    } // what are the two pointers we are working with\n\n\n    var count = 0;\n    var posVals = [];\n    var startVals = [];\n    Object.keys(positions).forEach(function (key) {\n      posVals[count] = positions[key];\n      startVals[count] = model.startingEventPositions[key];\n      count++;\n    }); // The meat of the algorithm\n    // on move events we analyze them to determine what type\n    // of movement it is and then deal with it.\n    // calculate the distances\n\n    var originalDistance = Math.sqrt((startVals[0].x - startVals[1].x) * (startVals[0].x - startVals[1].x) + (startVals[0].y - startVals[1].y) * (startVals[0].y - startVals[1].y));\n    var newDistance = Math.sqrt((posVals[0].x - posVals[1].x) * (posVals[0].x - posVals[1].x) + (posVals[0].y - posVals[1].y) * (posVals[0].y - posVals[1].y)); // calculate rotations\n\n    var originalAngle = degreesFromRadians(Math.atan2(startVals[1].y - startVals[0].y, startVals[1].x - startVals[0].x));\n    var newAngle = degreesFromRadians(Math.atan2(posVals[1].y - posVals[0].y, posVals[1].x - posVals[0].x)); // angles are cyclic so watch for that, 1 and 359 are only 2 apart :)\n\n    var angleDeviation = newAngle - originalAngle;\n    newAngle = newAngle + 180.0 >= 360.0 ? newAngle - 180.0 : newAngle + 180.0;\n    originalAngle = originalAngle + 180.0 >= 360.0 ? originalAngle - 180.0 : originalAngle + 180.0;\n\n    if (Math.abs(newAngle - originalAngle) < Math.abs(angleDeviation)) {\n      angleDeviation = newAngle - originalAngle;\n    } // calculate the translations\n\n\n    var trans = [];\n    trans[0] = (posVals[0].x - startVals[0].x + posVals[1].x - startVals[1].x) / 2.0;\n    trans[1] = (posVals[0].y - startVals[0].y + posVals[1].y - startVals[1].y) / 2.0;\n\n    if (event === 'TouchMove') {\n      // OK we want to\n      // - immediately respond to the user\n      // - allow the user to zoom without panning (saves focal point)\n      // - allow the user to rotate without panning (saves focal point)\n      // do we know what gesture we are doing yet? If not\n      // see if we can figure it out\n      if (model.currentGesture === 'Start') {\n        // pinch is a move to/from the center point\n        // rotate is a move along the circumference\n        // pan is a move of the center point\n        // compute the distance along each of these axes in pixels\n        // the first to break thresh wins\n        var thresh = 0.01 * Math.sqrt(model.container.clientWidth * model.container.clientWidth + model.container.clientHeight * model.container.clientHeight);\n\n        if (thresh < 15.0) {\n          thresh = 15.0;\n        }\n\n        var pinchDistance = Math.abs(newDistance - originalDistance);\n        var rotateDistance = newDistance * 3.1415926 * Math.abs(angleDeviation) / 360.0;\n        var panDistance = Math.sqrt(trans[0] * trans[0] + trans[1] * trans[1]);\n\n        if (pinchDistance > thresh && pinchDistance > rotateDistance && pinchDistance > panDistance) {\n          model.currentGesture = 'Pinch';\n          var callData = {\n            scale: 1.0,\n            touches: positions\n          };\n          publicAPI.startPinchEvent(callData);\n        } else if (rotateDistance > thresh && rotateDistance > panDistance) {\n          model.currentGesture = 'Rotate';\n          var _callData4 = {\n            rotation: 0.0,\n            touches: positions\n          };\n          publicAPI.startRotateEvent(_callData4);\n        } else if (panDistance > thresh) {\n          model.currentGesture = 'Pan';\n          var _callData5 = {\n            translation: [0, 0],\n            touches: positions\n          };\n          publicAPI.startPanEvent(_callData5);\n        }\n      } else {\n        // if we have found a specific type of movement then\n        // handle it\n        if (model.currentGesture === 'Rotate') {\n          var _callData6 = {\n            rotation: angleDeviation,\n            touches: positions\n          };\n          publicAPI.rotateEvent(_callData6);\n        }\n\n        if (model.currentGesture === 'Pinch') {\n          var _callData7 = {\n            scale: newDistance / originalDistance,\n            touches: positions\n          };\n          publicAPI.pinchEvent(_callData7);\n        }\n\n        if (model.currentGesture === 'Pan') {\n          var _callData8 = {\n            translation: trans,\n            touches: positions\n          };\n          publicAPI.panEvent(_callData8);\n        }\n      }\n    }\n  };\n\n  publicAPI.handleVisibilityChange = function () {\n    model._animationStartTime = Date.now();\n    model._animationFrameCount = 0;\n  };\n\n  publicAPI.setCurrentRenderer = function (r) {\n    model._forcedRenderer = !!r;\n    model.currentRenderer = r;\n  }; // Stop animating if the renderWindowInteractor is deleted.\n\n\n  var superDelete = publicAPI.delete;\n\n  publicAPI.delete = function () {\n    while (animationRequesters.size) {\n      publicAPI.cancelAnimation(animationRequesters.values().next().value);\n    }\n\n    if (typeof document.hidden !== 'undefined') {\n      document.removeEventListener('visibilitychange', publicAPI.handleVisibilityChange);\n    }\n\n    if (model.container) {\n      publicAPI.unbindEvents();\n    }\n\n    superDelete();\n  }; // Use the Page Visibility API to detect when we switch away from or back to\n  // this tab, and reset the animationFrameStart. When tabs are not active, browsers\n  // will stop calling requestAnimationFrame callbacks.\n\n\n  if (typeof document.hidden !== 'undefined') {\n    document.addEventListener('visibilitychange', publicAPI.handleVisibilityChange, false);\n  }\n} // ----------------------------------------------------------------------------\n// Object factory\n// ----------------------------------------------------------------------------\n\n\nvar DEFAULT_VALUES = {\n  renderWindow: null,\n  interactorStyle: null,\n  picker: null,\n  pickingManager: null,\n  initialized: false,\n  enabled: false,\n  enableRender: true,\n  currentRenderer: null,\n  lightFollowCamera: true,\n  desiredUpdateRate: 30.0,\n  stillUpdateRate: 2.0,\n  container: null,\n  // _view: null,\n  recognizeGestures: true,\n  currentGesture: 'Start',\n  animationRequest: null,\n  lastFrameTime: 0.1,\n  recentAnimationFrameRate: 10.0,\n  wheelTimeoutID: 0,\n  moveTimeoutID: 0,\n  lastGamepadValues: {},\n  preventDefaultOnPointerDown: false,\n  preventDefaultOnPointerUp: false,\n  mouseScrollDebounceByPass: false\n}; // ----------------------------------------------------------------------------\n\nfunction extend(publicAPI, model) {\n  var initialValues = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  Object.assign(model, DEFAULT_VALUES, initialValues); // Object methods\n\n  macro.obj(publicAPI, model); // run animation at least until this time\n\n  model._animationExtendedEnd = 0;\n  macro.event(publicAPI, model, 'RenderEvent');\n  handledEvents.forEach(function (eventName) {\n    return macro.event(publicAPI, model, eventName);\n  }); // Create get-only macros\n\n  macro.get(publicAPI, model, ['initialized', 'container', 'interactorStyle', 'lastFrameTime', 'recentAnimationFrameRate', '_view']); // Create get-set macros\n\n  macro.setGet(publicAPI, model, ['lightFollowCamera', 'enabled', 'enableRender', 'recognizeGestures', 'desiredUpdateRate', 'stillUpdateRate', 'picker', 'preventDefaultOnPointerDown', 'preventDefaultOnPointerUp', 'mouseScrollDebounceByPass']);\n  macro.moveToProtected(publicAPI, model, ['view']); // For more macro methods, see \"Sources/macros.js\"\n  // Object specific methods\n\n  vtkRenderWindowInteractor(publicAPI, model);\n} // ----------------------------------------------------------------------------\n\nvar newInstance = macro.newInstance(extend, 'vtkRenderWindowInteractor'); // ----------------------------------------------------------------------------\n\nvar vtkRenderWindowInteractor$1 = _objectSpread({\n  newInstance: newInstance,\n  extend: extend,\n  handledEvents: handledEvents\n}, Constants);\n\nexport { vtkRenderWindowInteractor$1 as default, extend, newInstance };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}