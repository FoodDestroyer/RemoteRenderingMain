{"ast":null,"code":"import { mat4 } from 'gl-matrix';\nimport macro from '../../macros.js';\nimport vtkViewNode from '../SceneGraph/ViewNode.js';\nimport { registerOverride } from './ViewNodeFactory.js';\n\n// vtkWebGPUVolume methods\n// ----------------------------------------------------------------------------\n\nfunction vtkWebGPUVolume(publicAPI, model) {\n  // Set our className\n  model.classHierarchy.push('vtkWebGPUVolume'); // Builds myself.\n\n  publicAPI.buildPass = function (prepass) {\n    if (!model.renderable || !model.renderable.getVisibility()) {\n      return;\n    }\n    if (prepass) {\n      model.WebGPURenderer = publicAPI.getFirstAncestorOfType('vtkWebGPURenderer');\n      model.WebGPURenderWindow = model.WebGPURenderer.getFirstAncestorOfType('vtkWebGPURenderWindow'); // for the future if we support hardware selection of volumes\n\n      if (model.propID === undefined) {\n        model.propID = model.WebGPURenderWindow.getUniquePropID();\n      }\n      model.renderable.getMapper().update();\n    }\n  };\n  publicAPI.queryPass = function (prepass, renderPass) {\n    if (prepass) {\n      if (!model.renderable || !model.renderable.getVisibility()) {\n        return;\n      } // Check for the special case when the mapper's bounds are unknown\n\n      var bds = model.renderable.getMapper().getBounds();\n      if (!bds || bds.length !== 6 || bds[0] > bds[1]) {\n        return;\n      }\n      renderPass.addVolume(publicAPI);\n    }\n  }; // used in the method below\n\n  var idx = new Float64Array(3);\n  var vout = new Float64Array(3);\n  publicAPI.getBoundingCubePoints = function (result, offset) {\n    var input = model.renderable.getMapper().getInputData();\n    if (!input) {\n      return;\n    }\n    var extent = input.getExtent();\n    var m = model.renderable.getMatrix();\n    var count = 0;\n    for (var iz = 4; iz < 6; iz++) {\n      idx[2] = extent[iz];\n      for (var iy = 2; iy < 4; iy++) {\n        idx[1] = extent[iy];\n        for (var ix = 0; ix < 2; ix++) {\n          idx[0] = extent[ix];\n          input.indexToWorld(idx, vout);\n          var poffset = offset + count * 3;\n          result[poffset++] = m[0] * vout[0] + m[1] * vout[1] + m[2] * vout[2] + m[3];\n          result[poffset++] = m[4] * vout[0] + m[5] * vout[1] + m[6] * vout[2] + m[7];\n          result[poffset++] = m[8] * vout[0] + m[9] * vout[1] + m[10] * vout[2] + m[11];\n          count++;\n        }\n      }\n    }\n  };\n  publicAPI.getKeyMatrices = function (wgpuRen) {\n    // has the actor or stabilization center changed?\n    if (Math.max(model.renderable.getMTime(), wgpuRen.getStabilizedTime()) > model.keyMatricesTime.getMTime()) {\n      model.renderable.computeMatrix();\n      var mcwc = model.renderable.getMatrix(); // compute the net shift\n\n      var center = wgpuRen.getStabilizedCenterByReference();\n      mat4.transpose(model.keyMatrices.bcwc, mcwc); // to get to stabilized we also need the center\n\n      mat4.translate(model.keyMatrices.bcsc, model.keyMatrices.bcwc, [-center[0], -center[1], -center[2]]);\n      model.keyMatricesTime.modified();\n    }\n    return model.keyMatrices;\n  };\n} // ----------------------------------------------------------------------------\n// Object factory\n// ----------------------------------------------------------------------------\n\nvar DEFAULT_VALUES = {\n  propID: undefined,\n  keyMatricesTime: null\n}; // ----------------------------------------------------------------------------\n\nfunction extend(publicAPI, model) {\n  var initialValues = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  Object.assign(model, DEFAULT_VALUES, initialValues); // Inheritance\n\n  vtkViewNode.extend(publicAPI, model, initialValues);\n  model.keyMatricesTime = {};\n  macro.obj(model.keyMatricesTime, {\n    mtime: 0\n  });\n  model.keyMatrices = {\n    bcwc: new Float64Array(16),\n    bcsc: new Float64Array(16)\n  };\n  macro.get(publicAPI, model, ['propID', 'keyMatricesTime']); // Object methods\n\n  vtkWebGPUVolume(publicAPI, model);\n} // ----------------------------------------------------------------------------\n\nvar newInstance = macro.newInstance(extend, 'vtkWebGPUVolume'); // ----------------------------------------------------------------------------\n\nvar index = {\n  newInstance: newInstance,\n  extend: extend\n}; // Register ourself to WebGPU backend if imported\n\nregisterOverride('vtkVolume', newInstance);\nexport { index as default, extend, newInstance };","map":{"version":3,"names":["mat4","macro","vtkViewNode","registerOverride","vtkWebGPUVolume","publicAPI","model","classHierarchy","push","buildPass","prepass","renderable","getVisibility","WebGPURenderer","getFirstAncestorOfType","WebGPURenderWindow","propID","undefined","getUniquePropID","getMapper","update","queryPass","renderPass","bds","getBounds","length","addVolume","idx","Float64Array","vout","getBoundingCubePoints","result","offset","input","getInputData","extent","getExtent","m","getMatrix","count","iz","iy","ix","indexToWorld","poffset","getKeyMatrices","wgpuRen","Math","max","getMTime","getStabilizedTime","keyMatricesTime","computeMatrix","mcwc","center","getStabilizedCenterByReference","transpose","keyMatrices","bcwc","translate","bcsc","modified","DEFAULT_VALUES","extend","initialValues","arguments","Object","assign","obj","mtime","get","newInstance","index","default"],"sources":["/home/rakshith/Documents/RemoteRendering/vtk-js-react-app/node_modules/@kitware/vtk.js/Rendering/WebGPU/Volume.js"],"sourcesContent":["import { mat4 } from 'gl-matrix';\nimport macro from '../../macros.js';\nimport vtkViewNode from '../SceneGraph/ViewNode.js';\nimport { registerOverride } from './ViewNodeFactory.js';\n\n// vtkWebGPUVolume methods\n// ----------------------------------------------------------------------------\n\nfunction vtkWebGPUVolume(publicAPI, model) {\n  // Set our className\n  model.classHierarchy.push('vtkWebGPUVolume'); // Builds myself.\n\n  publicAPI.buildPass = function (prepass) {\n    if (!model.renderable || !model.renderable.getVisibility()) {\n      return;\n    }\n\n    if (prepass) {\n      model.WebGPURenderer = publicAPI.getFirstAncestorOfType('vtkWebGPURenderer');\n      model.WebGPURenderWindow = model.WebGPURenderer.getFirstAncestorOfType('vtkWebGPURenderWindow'); // for the future if we support hardware selection of volumes\n\n      if (model.propID === undefined) {\n        model.propID = model.WebGPURenderWindow.getUniquePropID();\n      }\n\n      model.renderable.getMapper().update();\n    }\n  };\n\n  publicAPI.queryPass = function (prepass, renderPass) {\n    if (prepass) {\n      if (!model.renderable || !model.renderable.getVisibility()) {\n        return;\n      } // Check for the special case when the mapper's bounds are unknown\n\n\n      var bds = model.renderable.getMapper().getBounds();\n\n      if (!bds || bds.length !== 6 || bds[0] > bds[1]) {\n        return;\n      }\n\n      renderPass.addVolume(publicAPI);\n    }\n  }; // used in the method below\n\n\n  var idx = new Float64Array(3);\n  var vout = new Float64Array(3);\n\n  publicAPI.getBoundingCubePoints = function (result, offset) {\n    var input = model.renderable.getMapper().getInputData();\n\n    if (!input) {\n      return;\n    }\n\n    var extent = input.getExtent();\n    var m = model.renderable.getMatrix();\n    var count = 0;\n\n    for (var iz = 4; iz < 6; iz++) {\n      idx[2] = extent[iz];\n\n      for (var iy = 2; iy < 4; iy++) {\n        idx[1] = extent[iy];\n\n        for (var ix = 0; ix < 2; ix++) {\n          idx[0] = extent[ix];\n          input.indexToWorld(idx, vout);\n          var poffset = offset + count * 3;\n          result[poffset++] = m[0] * vout[0] + m[1] * vout[1] + m[2] * vout[2] + m[3];\n          result[poffset++] = m[4] * vout[0] + m[5] * vout[1] + m[6] * vout[2] + m[7];\n          result[poffset++] = m[8] * vout[0] + m[9] * vout[1] + m[10] * vout[2] + m[11];\n          count++;\n        }\n      }\n    }\n  };\n\n  publicAPI.getKeyMatrices = function (wgpuRen) {\n    // has the actor or stabilization center changed?\n    if (Math.max(model.renderable.getMTime(), wgpuRen.getStabilizedTime()) > model.keyMatricesTime.getMTime()) {\n      model.renderable.computeMatrix();\n      var mcwc = model.renderable.getMatrix(); // compute the net shift\n\n      var center = wgpuRen.getStabilizedCenterByReference();\n      mat4.transpose(model.keyMatrices.bcwc, mcwc); // to get to stabilized we also need the center\n\n      mat4.translate(model.keyMatrices.bcsc, model.keyMatrices.bcwc, [-center[0], -center[1], -center[2]]);\n      model.keyMatricesTime.modified();\n    }\n\n    return model.keyMatrices;\n  };\n} // ----------------------------------------------------------------------------\n// Object factory\n// ----------------------------------------------------------------------------\n\n\nvar DEFAULT_VALUES = {\n  propID: undefined,\n  keyMatricesTime: null\n}; // ----------------------------------------------------------------------------\n\nfunction extend(publicAPI, model) {\n  var initialValues = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  Object.assign(model, DEFAULT_VALUES, initialValues); // Inheritance\n\n  vtkViewNode.extend(publicAPI, model, initialValues);\n  model.keyMatricesTime = {};\n  macro.obj(model.keyMatricesTime, {\n    mtime: 0\n  });\n  model.keyMatrices = {\n    bcwc: new Float64Array(16),\n    bcsc: new Float64Array(16)\n  };\n  macro.get(publicAPI, model, ['propID', 'keyMatricesTime']); // Object methods\n\n  vtkWebGPUVolume(publicAPI, model);\n} // ----------------------------------------------------------------------------\n\nvar newInstance = macro.newInstance(extend, 'vtkWebGPUVolume'); // ----------------------------------------------------------------------------\n\nvar index = {\n  newInstance: newInstance,\n  extend: extend\n}; // Register ourself to WebGPU backend if imported\n\nregisterOverride('vtkVolume', newInstance);\n\nexport { index as default, extend, newInstance };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}